import{_ as H}from"./index-87073c71.js";import{r as h,u as tt,j as t,h as et,z as ot,A as at,H as nt,C as rt,E as st}from"./vendor-50d77580.js";import{L as lt,a as it,E as ct,M as dt,l as W,F as ut}from"./index-67390234.js";const pt="_piechart_yc0ui_11",ft="_chartContainer_yc0ui_23",ht="_legendButtonContainer_yc0ui_49",_t="_legendButton_yc0ui_49",gt="_codeBlockIcon_yc0ui_133",mt="_lightMode_yc0ui_191",yt="_dateFilter_yc0ui_195",xt="_officefilter_yc0ui_351",bt="_topContainer_yc0ui_443",Ct="_darkMode_yc0ui_463",St="_iconsContainer_yc0ui_631",wt="_icon_yc0ui_631",jt="_exportOptions_yc0ui_715",vt="_NoDataOverlay_yc0ui_741",Ft="_exportOption_yc0ui_715",kt="_tableContainer_yc0ui_999",Nt="_table_yc0ui_999",Dt="_summaryHeader_yc0ui_1035",Ot="_periodHeader_yc0ui_1043",Pt="_closeButton_yc0ui_1075",$t="_tableWrapper_yc0ui_1105",Bt="_loadingOverlay_yc0ui_1113",Et="_loadingSpinner_yc0ui_1139",zt="_boldOption_yc0ui_1151",Tt="_optionGroup_yc0ui_1161",e={piechart:pt,chartContainer:ft,"legend-text":"_legend-text_yc0ui_31",legendButtonContainer:ht,legendButton:_t,codeBlockIcon:gt,lightMode:mt,"label-text":"_label-text_yc0ui_191",dateFilter:yt,officefilter:xt,topContainer:bt,darkMode:Ct,"theme-container":"_theme-container_yc0ui_473",iconsContainer:St,icon:wt,exportOptions:jt,NoDataOverlay:vt,exportOption:Ft,tableContainer:kt,table:Nt,summaryHeader:Dt,periodHeader:Ot,closeButton:Pt,tableWrapper:$t,loadingOverlay:Bt,loadingSpinner:Et,boldOption:zt,optionGroup:Tt},It=({themeMode:_,selectedRange:g,selectedOffice:E,isAdmin:R,alldata:j,isLoading:z})=>{const[x,I]=h.useState([]),[v,b]=h.useState(!1),F=h.useRef(null),k=h.useRef(null),N=h.useRef(null),[D,O]=h.useState(!1),[T,L]=h.useState([]),[C,P]=h.useState(!1),[$,M]=h.useState([]),{t:a}=tt(),Q=[{name:"Product Name",label:a("Product")},{name:"Quantity",label:a("Quantity")},{name:"Sales",label:`${a("Sales")}(₹)`}],A={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"229px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:a("Rows")}}};function G(r){return r.flatMap(n=>n.lstproduct).reduce((n,o)=>{const{productName:i,totalSales:s,qty:c,color:u,unitShortName:p}=o;return s!==0&&(n[i]?(n[i].totalSales+=s,n[i].qty+=c):n[i]={totalSales:s,qty:c,color:u,unitShortName:p}),n},{})}h.useEffect(()=>{const r=y(g[0]),l=y(g[1]);if(r&&l&&E&&j.graph2){const d=G(j.graph2),n=Object.entries(d).map(([s,{totalSales:c,color:u}])=>({value:c,name:s,itemStyle:{color:u}}));M(n);const o=Object.entries(d).map(([s,{totalSales:c,color:u,qty:p,unitShortName:m}])=>({productName:s,totalSale:c,color:u,totalQty:p,unit:m}));I(o);const i=Object.entries(d).map(([s,{totalSales:c,qty:u,unitShortName:p}])=>({"Product Name":s,Sales:c,Quantity:`${u} ${p}`}));L(i)}},[g,E,R,j]);const V=()=>{x.length>0&&O(!D),b(!1),P(!1)},Y={tooltip:{trigger:"item",formatter:`<b>{b}</b><br><b>${a("Total Qty")}:</b> {c}`,textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:_==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:D,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:_==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"top",style:{fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Qty",type:"pie",radius:["35%","70%"],center:["50%","50%"],roseType:"radius",selectedMode:"single",avoidLabelOverlap:!0,label:{show:$.length<=10,color:_==="dark"?"#ffffff":"#111111"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:$.length>0?$:[],itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},U=async()=>{const r=y(g[0]),l=y(g[1]),d=await H(()=>import("./exceljs.min-46260496.js").then(i=>i.e),["assets/exceljs.min-46260496.js","assets/vendor-50d77580.js"]),n=new d.Workbook,o=n.addWorksheet("Data");fetch(W).then(i=>i.blob()).then(i=>{const s=new FileReader;s.onload=function(){const c=s.result,u=n.addImage({base64:c,extension:"png"});o.addImage(u,{tl:{col:0,row:0},ext:{width:100,height:70}});const p=o.getCell("A2");p.value=a("Product Wise Summary Data"),p.font={bold:!0,color:{argb:"000000"},size:14},p.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A2:C2");const m=o.getCell("A3");m.value=`${a("Period")}: ${r} ${a("to")} ${l}`,m.font={bold:!0,color:{argb:"000000"},size:12},m.alignment={horizontal:"center"},o.mergeCells("A3:C3"),o.getColumn(1).width=50,o.getColumn(2).width=15;const S=o.addRow([a("Product Name"),a("Quantity"),a("Total Sales")]);S.font={bold:!0,color:{argb:"000000"},size:12},S.eachCell(f=>{f.font={bold:!0,color:{argb:"000000"},size:12},f.border={bottom:{style:"thin",color:{argb:"000000"}}}}),x.forEach(f=>{o.addRow([f.productName,`${f.totalQty} ${f.unit}`,`₹${f.totalSale}`])});const B=`product_wise_summary_data_${Date.now()}.xlsx`;n.xlsx.writeBuffer().then(f=>{ut.saveAs(new Blob([f]),B)})},s.readAsDataURL(i)})},y=r=>{if(!r)return"";const l=r.getFullYear(),d=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${l}-${d}-${n}`},q=async()=>{const r=y(g[0]),l=y(g[1]);H(()=>import("./index-67390234.js").then(d=>d.j),["assets/index-67390234.js","assets/vendor-50d77580.js","assets/index-87073c71.js","assets/index-4da97eed.css"]).then(d=>{let n=d.default;const o=new n,i=[["Product Name","Quantity","Total Sale"]],s={1:{halign:"right"},2:{halign:"right"}},c={fontSize:12,fontStyle:"bold",halign:"center"},u={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},p=W,m=35,S=20;o.addImage(p,"PNG",15,12,m,S);const B=[["Product Wise Summary Data"]];o.autoTable({head:B,body:[],headStyles:{...c,fillColor:u.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const f=[[`Period: ${r} to ${l}`]];o.autoTable({startY:39.5,head:f,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const X=x.map(w=>[w.productName,`${w.totalQty} ${w.unit}`,w.totalSale.toFixed(2)]),K={startY:o.autoTable.previous.finalY+1,head:i,body:X,headStyles:{...c,fillColor:u.secondHeader,textColor:"#FFFFFF"},columnStyles:s};o.autoTable(K);const Z=`product_wise_summary_data_${Date.now()}.pdf`;o.save(Z)})};h.useEffect(()=>{const r=l=>{F.current&&!F.current.contains(l.target)&&k.current&&!k.current.contains(l.target)&&l.target.tagName!=="svg"&&l.target.tagName!=="path"&&b(!1),N.current&&!N.current.contains(l.target)&&O(!1)};return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[]);const J=()=>{O(!1),b(!v)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:`${e.chartContainer} ${_==="dark"?e.darkMode:e.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsxs("button",{className:e.legendButton,onClick:V,ref:N,children:[t.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:e.codeBlockIcon,title:"Legends",style:{filter:D||x.length===0?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),t.jsx("div",{className:`fw-bold fs-5 ${_==="dark"?e.darkMode:e.lightMode}`,children:a("Product Quantity")}),t.jsx("div",{className:"d-flex g-0",ref:F,children:t.jsxs("div",{className:`${e.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${e.icon} ${_==="dark"?e.darkMode:e.lightMode} px-2 py-1`,onClick:J,children:v?t.jsx(et,{style:{fontSize:"1.1rem"}}):t.jsx(ot,{style:{fontSize:"1.1rem"}})}),v&&t.jsxs("div",{className:`${e.exportOptions} ${_==="dark"?e.darkMode:e.lightMode}`,ref:k,children:[C?t.jsxs("div",{className:e.exportOption,onClick:()=>{P(!C),b(!1)},children:[t.jsx(nt,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:a("View Graph")})]}):t.jsxs("div",{className:e.exportOption,onClick:()=>{P(!C),b(!1)},children:[t.jsx(at,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:a("View Table")})]}),t.jsxs("div",{className:e.exportOption,onClick:U,children:[t.jsx(rt,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:a("Export to Excel")})]}),t.jsxs("div",{className:e.exportOption,onClick:q,children:[t.jsx(st,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:a("Export to PDF")})]})]})]})})]})}),z&&t.jsx("div",{className:e.NoDataOverlay,children:t.jsx(lt,{animationData:it,loop:!0})}),T.length==0&&!C&&!z?t.jsx("div",{className:`${e.NoDataOverlay} fs-5`,children:a("No Data Found")}):"",C?t.jsx("div",{className:"container-fluid pt-2",children:t.jsx(dt,{data:T,columns:Q,options:A})}):t.jsx(ct,{option:Y,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:e.piechart},x.length)]})})};export{It as default};
