import{_ as H}from"./index-0bab7b9d.js";import{r as c,l as J,j as e,g as X,w as K,x as Z,E as ee,z as te,A as oe,C as ae}from"./vendor-770ffdd0.js";import{E as ne,M as le,l as T,F as re}from"./index-82263592.js";const se="_piechart_1qhlp_11",ie="_chartContainer_1qhlp_23",ce="_legendButtonContainer_1qhlp_49",de="_legendButton_1qhlp_49",pe="_codeBlockIcon_1qhlp_133",he="_lightMode_1qhlp_191",fe="_dateFilter_1qhlp_195",ue="_officefilter_1qhlp_351",ge="_topContainer_1qhlp_443",_e="_darkMode_1qhlp_463",me="_iconsContainer_1qhlp_631",xe="_icon_1qhlp_631",be="_exportOptions_1qhlp_715",ye="_exportOption_1qhlp_715",Ce="_tableContainer_1qhlp_975",Se="_table_1qhlp_975",we="_summaryHeader_1qhlp_1011",ke="_periodHeader_1qhlp_1019",Fe="_closeButton_1qhlp_1051",je="_tableWrapper_1qhlp_1081",ve="_loadingOverlay_1qhlp_1089",Ne="_loadingSpinner_1qhlp_1115",qe="_boldOption_1qhlp_1127",Pe="_optionGroup_1qhlp_1137",t={piechart:se,chartContainer:ie,"legend-text":"_legend-text_1qhlp_31",legendButtonContainer:ce,legendButton:de,codeBlockIcon:pe,lightMode:he,"label-text":"_label-text_1qhlp_191",dateFilter:fe,officefilter:ue,topContainer:ge,darkMode:_e,"theme-container":"_theme-container_1qhlp_473",iconsContainer:me,icon:xe,exportOptions:be,exportOption:ye,tableContainer:Ce,table:Se,summaryHeader:we,periodHeader:ke,closeButton:Fe,tableWrapper:je,loadingOverlay:ve,loadingSpinner:Ne,boldOption:qe,optionGroup:Pe},Oe=({themeMode:u,selectedRange:x,selectedOffice:O,isAdmin:B})=>{const[b,W]=c.useState([]),[F,C]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),N=c.useRef(null),[q,P]=c.useState(!1),[I,R]=c.useState([]),[S,$]=c.useState(!1),[L,z]=c.useState(!1),M=[{name:"Product Name",label:"Product"},{name:"Quantity",label:"Quantity"},{name:"Sales",label:"Sales(₹)"}],A={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"229px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};c.useEffect(()=>{z(!0);const a=y(x[0]),s=y(x[1]);J.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${a}/${s}/${O}/${B}`).then(d=>{const o=d.data.graph2;let l={},_={},f={},m={};if(o.forEach(p=>{const{lstproduct:h}=p;h.forEach(n=>{let{productName:i,totalSales:r,color:E,qty:w,unitShortName:D}=n;r!==0&&(l[i]?(l[i]+=r,f[i]+=w):(l[i]=r,_[i]=E,f[i]=w,m[i]=D))})}),l){let p=[],h=[];for(let n in l)p.push({productName:n,totalSale:l[n],color:_[n],totalQty:f[n],unit:m[n]}),h.push({"Product Name":n,Sales:l[n],Quantity:`${f[n]} ${m[n]}`});R(h),W(p)}}).catch(d=>{}).finally(()=>{z(!1)})},[x,O,B]);const Q=()=>{b.length>0&&(P(!q),C(!1),$(!1))},G={tooltip:{trigger:"item",formatter:"<b>{b}</b><br><b>Total Sales:</b> ₹{c}",textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:u==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:q,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:u==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"2%",style:{fill:u==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Sales",type:"pie",radius:["40%","65%"],center:["50%","50%"],selectedMode:"single",avoidLabelOverlap:!0,label:{show:b.length<=5,color:u==="dark"?"#ffffff":"#111111"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:b.length>0?b.map((a,s)=>({value:a.totalSale,name:a.productName,itemStyle:{color:a.color}})):[],itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},Y=async()=>{const a=y(x[0]),s=y(x[1]),d=await H(()=>import("./exceljs.min-d8450118.js").then(l=>l.e),["assets/exceljs.min-d8450118.js","assets/vendor-770ffdd0.js"]),g=new d.Workbook,o=g.addWorksheet("Data");fetch(T).then(l=>l.blob()).then(l=>{const _=new FileReader;_.onload=function(){const f=_.result,m=g.addImage({base64:f,extension:"png"});o.addImage(m,{tl:{col:0,row:0},ext:{width:100,height:70}});const p=o.getCell("A2");p.value="Product Wise Summary Data",p.font={bold:!0,color:{argb:"000000"},size:14},p.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A2:C2");const h=o.getCell("A3");h.value=`Period: ${a} to ${s}`,h.font={bold:!0,color:{argb:"000000"},size:12},h.alignment={horizontal:"center"},o.mergeCells("A3:C3"),o.getColumn(1).width=50,o.getColumn(2).width=15;const n=o.addRow(["Product Name","Quantity","Total Sale"]);n.font={bold:!0,color:{argb:"000000"},size:12},n.eachCell(r=>{r.font={bold:!0,color:{argb:"000000"},size:12},r.border={bottom:{style:"thin",color:{argb:"000000"}}}}),b.forEach(r=>{o.addRow([r.productName,`${r.totalQty} ${r.unit}`,`₹${r.totalSale}`])});const i=`product_wise_summary_data_${Date.now()}.xlsx`;g.xlsx.writeBuffer().then(r=>{re.saveAs(new Blob([r]),i)})},_.readAsDataURL(l)})},y=a=>{if(!a)return"";const s=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0"),g=String(a.getDate()).padStart(2,"0");return`${s}-${d}-${g}`},U=async()=>{const a=y(x[0]),s=y(x[1]);H(()=>import("./index-82263592.js").then(d=>d.j),["assets/index-82263592.js","assets/vendor-770ffdd0.js","assets/index-0bab7b9d.js","assets/index-7b634162.css"]).then(d=>{let g=d.default;const o=new g,l=[["Product Name","Quantity","Total Sale"]],_={1:{halign:"right"},2:{halign:"right"}},f={fontSize:12,fontStyle:"bold",halign:"center"},m={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},p=T,h=35,n=20;o.addImage(p,"PNG",15,12,h,n);const i=[["Product Wise Summary Data"]];o.autoTable({head:i,body:[],headStyles:{...f,fillColor:m.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const r=[[`Period: ${a} to ${s}`]];o.autoTable({startY:39.5,head:r,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const E=b.map(k=>[k.productName,`${k.totalQty} ${k.unit}`,k.totalSale.toFixed(2)]),w={startY:o.autoTable.previous.finalY+1,head:l,body:E,headStyles:{...f,fillColor:m.secondHeader,textColor:"#FFFFFF"},columnStyles:_};o.autoTable(w);const D=`product_wise_summary_data_${Date.now()}.pdf`;o.save(D)})};c.useEffect(()=>{const a=s=>{j.current&&!j.current.contains(s.target)&&v.current&&!v.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&C(!1),N.current&&!N.current.contains(s.target)&&P(!1)};return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}},[]);const V=()=>{P(!1),C(!F)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`${t.chartContainer} ${u==="dark"?t.darkMode:t.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsxs("button",{className:t.legendButton,onClick:Q,ref:N,children:[e.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:t.codeBlockIcon,title:"Legends",style:{filter:q?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),e.jsx("div",{className:`fw-bold fs-5 ${u==="dark"?t.darkMode:t.lightMode}`,children:"Product Volume"}),e.jsx("div",{className:"d-flex g-0",ref:j,children:e.jsxs("div",{className:`${t.iconsContainer} d-flex justify-content-center align-items-center`,children:[e.jsx("div",{className:`${t.icon} ${u==="dark"?t.darkMode:t.lightMode} px-2 py-1`,onClick:V,children:F?e.jsx(X,{style:{fontSize:"1.1rem"}}):e.jsx(K,{style:{fontSize:"1.1rem"}})}),F&&e.jsxs("div",{className:`${t.exportOptions} ${u==="dark"?t.darkMode:t.lightMode}`,ref:v,children:[S?e.jsxs("div",{className:t.exportOption,onClick:()=>{$(!S),C(!1)},children:[e.jsx(ee,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),e.jsx("span",{children:"Export to Graph"})]}):e.jsxs("div",{className:t.exportOption,onClick:()=>{$(!S),C(!1)},children:[e.jsx(Z,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:"Export to Table"})]}),e.jsxs("div",{className:t.exportOption,onClick:Y,children:[e.jsx(te,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:"Export to Excel"})]}),e.jsxs("div",{className:t.exportOption,onClick:U,children:[e.jsx(oe,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),L&&e.jsx("div",{className:t.loadingOverlay,children:e.jsx(ae,{disableShrink:!0})}),S?e.jsx("div",{className:"container-fluid pt-2",children:e.jsx(le,{data:I,columns:M,options:A})}):e.jsx(ne,{option:G,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:t.piechart},b.length)]})})};export{Oe as default};
