import{_ as Y}from"./index-dbef6bfd.js";import{r,u as pe,j as t,H as he,I as ue,g as me,z as ge,A as xe,J as ye,C as _e,E as we,G as be,l as H}from"./vendor-5afa12e1.js";import{E as Se,M as ve,F as Ce}from"./index-8b623e31.js";import{l as J}from"./logo-604665f9.js";const Fe="_chartContainer_ew0vy_1",ke="_lightMode_ew0vy_47",Ne="_dateFilter_ew0vy_51",je="_officefilter_ew0vy_207",Oe="_topContainer_ew0vy_299",Be="_darkMode_ew0vy_319",$e="_iconsContainer_ew0vy_487",Ee="_icon_ew0vy_487",Te="_exportOptions_ew0vy_571",De="_exportOption_ew0vy_571",Ie="_NoDataOverlay_ew0vy_659",ze="_tableContainer_ew0vy_849",Le="_table_ew0vy_849",Pe="_summaryHeader_ew0vy_885",We="_periodHeader_ew0vy_893",Ae="_closeButton_ew0vy_925",He="_tableWrapper_ew0vy_955",Re="_loadingOverlay_ew0vy_963",Ge="_loadingSpinner_ew0vy_989",Me="_boldOption_ew0vy_1001",Ue="_optionGroup_ew0vy_1011",Ve="_resetButtonContainer_ew0vy_1039",Ye="_resetButton_ew0vy_1039",n={chartContainer:Fe,lightMode:ke,"label-text":"_label-text_ew0vy_47",dateFilter:Ne,officefilter:je,topContainer:Oe,darkMode:Be,"theme-container":"_theme-container_ew0vy_329",iconsContainer:$e,icon:Ee,exportOptions:Te,exportOption:De,NoDataOverlay:Ie,tableContainer:ze,table:Le,summaryHeader:Pe,periodHeader:We,closeButton:Ae,tableWrapper:He,loadingOverlay:Re,loadingSpinner:Ge,boldOption:Me,optionGroup:Ue,resetButtonContainer:Ve,resetButton:Ye},Ze=({themeMode:i,selectedRange:m,selectedOffice:g,isAdmin:_,SelectedOfficeName:Je})=>{const[h,X]=r.useState([]),[D,N]=r.useState(!1),I=r.useRef(null),z=r.useRef(null),[R,G]=r.useState(!0),[v,M]=r.useState(!1),[U,q]=r.useState([]),[w,j]=r.useState(null),[O,C]=r.useState(!1),[K,L]=r.useState(!1),[b,P]=r.useState([]),[Q,W]=r.useState(!1),[B,Z]=r.useState({selectedOffice:g,isAdmin:_}),{t:o}=pe(),ee=[{name:"officeName",label:o("Office")},{name:"sales",label:`${o("Sales")}(₹)`}],te={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:o("Rows")}}};r.useEffect(()=>{const e=s=>{I.current&&!I.current.contains(s.target)&&z.current&&!z.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&N(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const oe=()=>{G(!0);const e=S(m[0]),s=S(m[1]),d=w!==null?w:g,c=w!==null?O:_;H.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${e}/${s}/${d}/${c}`).then(a=>{const{data:f}=a;if(f.graph1){let p=[],x=[];for(let l=0;l<f.graph1.length;l++)p.push({officeId:f.graph1[l].officeId,officeName:f.graph1[l].officeName,sales:f.graph1[l].totalIncome.toFixed(0),color:f.graph1[l].officeTypeColor}),x.push({officeName:f.graph1[l].officeName,sales:f.graph1[l].totalIncome.toFixed(2)});x.push({officeName:o("Total"),sales:p.reduce((l,y)=>l+parseFloat(y.sales),0).toFixed(2)}),q(x),X(p)}}).catch(a=>{console.log("Error fetching data:",a)}).finally(()=>{G(!1)})};r.useEffect(()=>{m&&g&&oe()},[w,O,m,g,_]);const ae={title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${o("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:h.map(e=>e.officeName),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?o("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:h.map((e,s)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:h.length<=5,position:"right",color:i==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},V=e=>{let s="";const d=new Uint8Array(e),c=d.byteLength;for(let a=0;a<c;a++)s+=String.fromCharCode(d[a]);return window.btoa(s)},ne=async()=>{const e=S(m[0]),s=S(m[1]),d=await Y(()=>import("./exceljs.min-d3a887be.js").then(u=>u.e),["assets/exceljs.min-d3a887be.js","assets/vendor-5afa12e1.js"]),c=new d.Workbook,a=c.addWorksheet("Total Sales by Office"),f=await H.get(J,{responseType:"arraybuffer"}),p=V(f.data),x=c.addImage({base64:p,extension:"png"});a.addImage(x,{tl:{col:0,row:0},ext:{width:40,height:40}});const l=a.getCell("A1");l.value=o("Total Sales by Business Entity"),l.font={bold:!0,color:{argb:"000000"},size:14},l.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A1:C1");const y=a.getCell("A2");y.value=`${o("Period")}: ${e} ${o("to")} ${s}`,y.font={bold:!0,color:{argb:"000000"},size:12},y.alignment={horizontal:"center"},a.mergeCells("A2:C2"),a.getColumn(1).width=50,a.getColumn(2).width=15,a.getColumn(3).width=15;const A=a.addRow([o("Office Name"),o("Sales")]);A.font={bold:!0},h.forEach(u=>{a.addRow([u.officeName,u.sales])});const $=a.addRow([o("Total"),""]);$.font={bold:!0,color:{argb:"000000"},size:12};const E=h.reduce((u,k)=>u+parseFloat(k.sales),0),F=a.getCell(`B${$.number}`);F.value=`₹${E}`,F.numFmt="0.00",F.alignment={horizontal:"right"},c.xlsx.writeBuffer().then(u=>{const k=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Ce.saveAs(k,"total_sales_by_office.xlsx")})},se=async()=>{const e=S(m[0]),s=S(m[1]),d=await H.get(J,{responseType:"arraybuffer"}),c=V(d.data);Y(()=>import("./index-8b623e31.js").then(a=>a.j),["assets/index-8b623e31.js","assets/vendor-5afa12e1.js","assets/index-dbef6bfd.js","assets/index-4da97eed.css"]).then(a=>{let f=a.default;const p=new f,x=c,l=35,y=20;p.addImage(x,"PNG",15,9,l,y);const A=[[o("Total Sales by Business Entity")]];p.autoTable({startY:27,head:A,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const $=[[`${o(Period)}: ${e} ${o(to)} ${s}`]];p.autoTable({startY:36,head:$,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const E=h.map(T=>[T.officeName,parseFloat(T.sales.toFixed(2))]),F=h.reduce((T,fe)=>T+parseFloat(fe.sales),0);E.push([o("Total"),`${F.toFixed(2)}`]);const u=[o("Office Name"),o("Sales")],k={1:{halign:"right"},2:{halign:"right"}},de={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};p.autoTable(u,E,{startY:45,headStyles:de,columnStyles:k}),p.save("total_sales_by_office.pdf")})},le=e=>{if(e&&e.data&&e.dataIndex>=0&&h[e.dataIndex]){const s=h[e.dataIndex].officeId,d=h[e.dataIndex].officeName;P(c=>[...c,{selectedOffice:w,isAdmin:O}]),j(s),d.toLowerCase().includes("pump")?C(0):C(5),Z({selectedOffice:g,isAdmin:_}),L(!0),W(!0)}},re=()=>{N(!D)},S=e=>{if(!e)return"";const s=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${s}-${d}-${c}`},ie=()=>{if(b.length>0){const e=b.pop();j(e.selectedOffice),C(e.isAdmin),P([...b]),b.length===0&&L(!1),b.length===0&&W(!1)}},ce=()=>{j(B.selectedOffice),C(B.isAdmin),P([]),L(!1),W(!1)};return r.useEffect(()=>{j(g),C(_)},[g,_]),t.jsxs("div",{className:`${n.chartContainer} ${i==="dark"?n.darkMode:n.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${i==="dark"?n.darkMode:n.lightMode}`,children:o("Total Sales by Business Entity")}),K&&w!==B.selectedOffice&&O!==B.isAdmin?t.jsx("div",{className:n.resetButtonContainer,children:t.jsx("button",{className:n.resetButton,onClick:ce,children:t.jsx(he,{style:{fontSize:"1rem"}})})}):null,Q&&b.length>0?t.jsx("div",{className:n.resetButtonContainer,children:t.jsx("button",{className:n.resetButton,onClick:ie,children:t.jsx(ue,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{className:"d-flex g-0",ref:I,children:t.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${n.icon} ${i==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:re,children:D?t.jsx(me,{style:{fontSize:"1.1rem"}}):t.jsx(ge,{style:{fontSize:"1.1rem"}})}),D&&t.jsxs("div",{className:`${n.exportOptions} ${i==="dark"?n.darkMode:n.lightMode}`,ref:z,children:[v?t.jsxs("div",{className:n.exportOption,onClick:()=>{M(!v),N(!1)},children:[t.jsx(ye,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:o("View Graph")})]}):t.jsxs("div",{className:n.exportOption,onClick:()=>{M(!v),N(!1)},children:[t.jsx(xe,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:o("View Table")})]}),t.jsxs("div",{className:n.exportOption,onClick:ne,children:[t.jsx(_e,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:o("Export to Excel")})]}),t.jsxs("div",{className:n.exportOption,onClick:se,children:[t.jsx(we,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:o("Export to PDF")})]})]})]})})]})}),R&&t.jsx("div",{className:n.loadingOverlay,children:t.jsx(be,{disableShrink:!0})}),U.length==1&&!v&&!R?t.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:o("No Data Found")}):"",v?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(ve,{data:U,columns:ee,options:te})}):t.jsx(Se,{option:ae,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:le},className:i==="dark"?n.darkMode:n.lightMode})]})};export{Ze as default};
