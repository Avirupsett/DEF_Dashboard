import{_ as U}from"./index-ef582c05.js";import{r as f,u as X,y as Z,j as t,h as J,z as K,A as Q,B as R,C as ee,E as te}from"./vendor-257ea584.js";import{l as ae,E as oe,a as ne}from"./index-520e0e8e.js";const se="_chartContainer_1mphg_1",re="_lightMode_1mphg_47",le="_dateFilter_1mphg_51",ie="_officefilter_1mphg_207",de="_topContainer_1mphg_299",ce="_darkMode_1mphg_319",pe="_iconsContainer_1mphg_487",fe="_icon_1mphg_487",he="_exportOptions_1mphg_571",xe="_exportOption_1mphg_571",me="_tableContainer_1mphg_825",ue="_table_1mphg_825",ge="_summaryHeader_1mphg_861",ye="_periodHeader_1mphg_869",_e="_closeButton_1mphg_901",Se="_tableWrapper_1mphg_931",be="_loadingOverlay_1mphg_939",Fe="_NoDataOverlay_1mphg_963",we="_loadingSpinner_1mphg_991",De="_boldOption_1mphg_1003",je="_optionGroup_1mphg_1013",o={chartContainer:se,lightMode:re,"label-text":"_label-text_1mphg_47",dateFilter:le,officefilter:ie,topContainer:de,darkMode:ce,"theme-container":"_theme-container_1mphg_329",iconsContainer:pe,icon:fe,exportOptions:he,exportOption:xe,tableContainer:me,table:ue,summaryHeader:ge,periodHeader:ye,closeButton:_e,tableWrapper:Se,loadingOverlay:be,NoDataOverlay:Fe,loadingSpinner:we,boldOption:De,optionGroup:je},Ee=({selectedRange:l,themeMode:s,selectedOffice:_,isAdmin:T,alldata:v,isLoading:k})=>{const[i,W]=f.useState([]),[S,u]=f.useState(!1),b=f.useRef(null),F=f.useRef(null),[z,P]=f.useState(!0),[E,L]=f.useState([]),[x,N]=f.useState(!1),{t:a}=X();a("Date"),`${a("Sales")}`,`${a("Expense")}`,a("Rows"),f.useEffect(()=>{const e=g(l[0]),n=g(l[1]);e&&n&&_&&(()=>{const h=v;if(Array.isArray(h.graph1)){const c=h.graph1.map(d=>({requestedDate:d.requestedDate,sales:d.totalIncome,expense:d.totalExpense}));let y=c.filter(d=>d.sales!==0||d.expense!==0);const w=c.reduce((d,m)=>d+m.sales,0).toFixed(2),D=c.reduce((d,m)=>d+m.expense,0).toFixed(2);y.push({requestedDate:a("Total"),sales:w,expense:D}),L(y),W(h.graph1)}})()},[l,_,T,v]);const O=(i.filter(e=>e.totalIncome>0).reduce((e,n)=>e+n.totalIncome,0)/i.filter(e=>e.totalIncome>0).length).toFixed(0);f.useEffect(()=>{if(l[0]&&l[1]){const e=new Date(l[0]),n=new Date(l[1]),r=Z(n,e)+1;P(r<=7)}},[l,_]);const H={color:["#66BA69","#E81A1A","#FFC107"],title:{textStyle:{color:s==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:function(e){for(var n=`<b>${a("Date")}:</b> `+e[0].name+"<br/>",r=0;r<e.length;r++)n+="<b>"+e[r].seriesName+":</b> "+e[r].value+"<br/>";return n},textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{top:window.innerWidth>550?0:270,data:[a("Sales"),a("Expense"),a("Average Sales")],textStyle:{color:s==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?10:12}},grid:{left:window.innerWidth<=768?"7%":"4%",right:"3%",top:"10%",bottom:i.length>0?"15%":"20%",containLabel:i.length>0},xAxis:{type:"category",name:window.innerWidth>550?a("Date"):"",nameLocation:"middle",nameGap:35,nameTextStyle:{color:s==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},boundaryGap:!0,data:i.map(e=>e.requestedDate),axisLine:{lineStyle:{color:s==="dark"?"#ffffff":"#000000"}},axisLabel:{color:s==="dark"?"#ffffff":"#000000"}},yAxis:[{type:"value",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:42,nameTextStyle:{color:s==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:s==="dark"?"#ffffff":"#000000"}},axisLabel:{color:s==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e4?e/1e3+"k":e},splitLine:{show:!0,lineStyle:{color:s==="dark"?"grey":"silver",type:"dashed"}}},{type:"value",show:!1},{type:"value",show:!1}],dataZoom:[{show:!0,type:"inside",filterMode:"none",xAxisIndex:[0],startValue:new Date(l[0]),endValue:new Date(l[1])}],series:z?[{name:a("Sales"),type:"bar",data:i.map(e=>e.totalIncome),yAxisIndex:0},{name:a("Expense"),type:"bar",data:i.map(e=>e.totalExpense),yAxisIndex:0},{name:a("Average Sales"),type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:i.map(()=>O)}]:[{name:a("Sales"),type:"line",smooth:!0,data:i.map(e=>e.totalIncome),yAxisIndex:0},{name:a("Expense"),type:"line",smooth:!0,data:i.map(e=>e.totalExpense),yAxisIndex:0},{name:a("Average Sales"),type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:i.map(()=>O)}]},B=()=>{const e=g(l[0]),n=g(l[1]);U(()=>import("./index-520e0e8e.js").then(r=>r.j),["assets/index-520e0e8e.js","assets/vendor-257ea584.js","assets/index-ef582c05.js","assets/index-4da97eed.css"]).then(r=>{let h=r.default;const c=new h;c.setFontSize(12);const y=ne,w=35,D=20;c.addImage(y,"PNG",15,9,w,D);const d=[["Sales-Expense Summary"]];c.autoTable({startY:27,head:d,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const m=[[`Period: ${e} to ${n}`]];c.autoTable({startY:36,head:m,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const j=i.filter(p=>p.totalIncome!==0||p.totalExpense!==0),I=j.map(p=>[p.requestedDate,p.totalIncome.toFixed(2),p.totalExpense.toFixed(2)]),A=j.reduce((p,C)=>p+C.totalIncome,0),$=j.reduce((p,C)=>p+C.totalExpense,0);(A!==0||$!==0)&&I.push(["Total",`${A.toFixed(2)}`,`${$.toFixed(2)}`]);const V=["Date","Sales","Expense"],M={1:{halign:"right"},2:{halign:"right"}},Y={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};c.autoTable(V,I,{startY:45,headStyles:Y,columnStyles:M}),c.save("sales-expense.pdf")})};f.useEffect(()=>{const e=n=>{b.current&&!b.current.contains(n.target)&&F.current&&!F.current.contains(n.target)&&n.target.tagName!=="svg"&&n.target.tagName!=="path"&&u(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const q=()=>{u(!S)},g=e=>{if(!e)return"";const n=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),h=String(e.getDate()).padStart(2,"0");return`${n}-${r}-${h}`},G=()=>{N(!x),u(!1)};return t.jsxs("div",{className:`${o.chartContainer} ${s==="dark"?o.darkMode:o.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${s==="dark"?o.darkMode:o.lightMode}`,children:a("Sales-Expense")}),t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:b,children:t.jsxs("div",{className:`${o.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${o.icon} ${s==="dark"?o.darkMode:o.lightMode} px-2 py-1`,onClick:q,children:S?t.jsx(J,{style:{fontSize:"1.1rem"}}):t.jsx(K,{style:{fontSize:"1.1rem"}})}),S&&t.jsxs("div",{className:`${o.exportOptions} ${s==="dark"?o.darkMode:o.lightMode}`,ref:F,children:[x?t.jsxs("div",{className:o.exportOption,onClick:()=>{N(!x),u(!1)},children:[t.jsx(R,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:a("View Graph")})]}):t.jsxs("div",{className:o.exportOption,onClick:G,children:[t.jsx(Q,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:a("View Table")})]}),t.jsxs("a",{href:"https://www.africau.edu/images/default/sample.pdf",download:!0,className:o.exportOption,children:[t.jsx(ee,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:a("Export to Excel")})]}),t.jsxs("div",{className:o.exportOption,onClick:B,children:[t.jsx(te,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:a("Export to PDF")})]})]})]})})]})}),k&&t.jsx("div",{className:o.NoDataOverlay,children:t.jsx("img",{src:ae,alt:"Loading...",width:50,height:50})}),E.length==1&&!x&&!k?t.jsx("div",{className:`${o.NoDataOverlay} fs-5`,children:a("No Data Found")}):"",x?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"291px"},children:t.jsxs("table",{className:`table ${s=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:a("Date")}),t.jsxs("th",{scope:"col",children:[a("Sales"),"(₹)"]}),t.jsxs("th",{scope:"col",children:[a("Expense"),"(₹)"]})]})}),t.jsx("tbody",{children:E.map((e,n)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:n+1}),t.jsx("td",{children:e.requestedDate}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)}),t.jsx("td",{children:parseFloat(e.expense).toFixed(2)})]},e.requestedDate))})]})}):t.jsx(oe,{option:H,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:s==="dark"?o.darkMode:o.lightMode})]})};export{Ee as default};
