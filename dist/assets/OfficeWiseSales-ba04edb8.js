import{_ as M}from"./index-9709244e.js";import{r as m,f as fe,j as t}from"./vendor-f48e548e.js";import{e as pe,j as me,k as ue,l as he,m as ge,n as xe,a as B}from"./axios-aa9cae93.js";import{l as ye}from"./loading-6f8dd2cd.js";import{l as Y,f as we,a as _e}from"./NotoSansDevanagari-VariableFont_wdth_wght-7a6127ac.js";import{k as be,Q as _}from"./react-toastify.esm-81104cc6.js";/* empty css                      */import{i as Se}from"./assertThisInitialized-46084dcb.js";import{T as Ce}from"./ThemeProvider-6ac86476.js";import{F as Fe,S as je,M as T}from"./Select-cf7b8623.js";import"./jspdf.es.min-4849f735.js";import"./Dashboard-c09c3291.js";import"./installSVGRenderer-7788c1a1.js";import"./Skeleton-26b4d238.js";import"./createSvgIcon-22bfe507.js";import"./react-is.production.min-3a7c3723.js";import"./useTheme-8d3c7519.js";const ke="_piechart_wa0ri_11",ve="_chartContainer_wa0ri_23",Oe="_legendButtonContainer_wa0ri_49",Ne="_legendButton_wa0ri_49",$e="_codeBlockIcon_wa0ri_133",De="_lightMode_wa0ri_191",Be="_dateFilter_wa0ri_195",Te="_officefilter_wa0ri_351",Le="_topContainer_wa0ri_443",Ee="_darkMode_wa0ri_463",Pe="_iconsContainer_wa0ri_631",ze="_icon_wa0ri_631",We="_exportOptions_wa0ri_715",Ie="_exportOption_wa0ri_715",Ae="_NoDataOverlay_wa0ri_861",He="_tableContainer_wa0ri_993",Re="_table_wa0ri_993",qe="_summaryHeader_wa0ri_1029",Qe="_periodHeader_wa0ri_1037",Ue="_closeButton_wa0ri_1069",Ve="_tableWrapper_wa0ri_1099",Ge="_loadingOverlay_wa0ri_1107",Me="_loadingSpinner_wa0ri_1133",Ye="_boldOption_wa0ri_1145",Je="_optionGroup_wa0ri_1155",s={piechart:ke,chartContainer:ve,"legend-text":"_legend-text_wa0ri_31",legendButtonContainer:Oe,legendButton:Ne,codeBlockIcon:$e,lightMode:De,"label-text":"_label-text_wa0ri_191",dateFilter:Be,officefilter:Te,topContainer:Le,darkMode:Ee,"theme-container":"_theme-container_wa0ri_473",iconsContainer:Pe,icon:ze,exportOptions:We,exportOption:Ie,NoDataOverlay:Ae,tableContainer:He,table:Re,summaryHeader:qe,periodHeader:Qe,closeButton:Ue,tableWrapper:Ve,loadingOverlay:Ge,loadingSpinner:Me,boldOption:Ye,optionGroup:Je},yt=({echarts:J,ReactECharts:X,themeMode:a,selectedRange:b,selectedOffice:Xe,isAdmin:Ke,showGraph:H,alldata:n,officeName:v,isLoading:R})=>{const[l,h]=m.useState(n==null?void 0:n.top5),[L,O]=m.useState(!1),E=m.useRef(null),P=m.useRef(null),q=m.useRef(null),{t:o}=fe(),[Ze,Q]=m.useState(!1),[S,z]=m.useState(!1),[x,K]=m.useState("Top5");m.useEffect(()=>{z(!H)},[H]),m.useEffect(()=>{x==="Top5"?h(n==null?void 0:n.top5):x==="Top10"?h(n==null?void 0:n.top10):x==="Bottom5"?h(n==null?void 0:n.bottom5):x==="Bottom10"&&h(n==null?void 0:n.bottom10)},[b,n]);const Z={title:{textStyle:{color:a==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{data:[o("Quantity"),o("Sales")],bottom:0,textStyle:{color:a==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?10:12}},grid:{left:window.innerWidth<=768?"10%":"8%",right:window.innerWidth<=768?"12%":"9%",top:"15%",bottom:window.innerWidth<=768?"35%":"25%",containLabel:!!(n&&n.length>0)},xAxis:[{type:"category",data:l?l.map(e=>e.officeName):[],axisPointer:{type:"shadow"},axisLine:{lineStyle:{color:a==="dark"?"#ffffff":"#000000"}},axisLabel:{color:a==="dark"?"#ffffff":"#000000",rotate:45,fontSize:11,formatter:e=>e.length>10?e.substring(0,10)+"...":e}}],yAxis:[{type:"value",name:o("Quantity"),min:0,minInterval:1,axisLine:{lineStyle:{color:a==="dark"?"#ffffff":"#000000"}},axisLabel:{color:a==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e}},{type:"value",name:o("Sales"),min:0,axisLine:{lineStyle:{color:a==="dark"?"#ffffff":"#000000"}},axisLabel:{color:a==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e}}],series:[{name:o("Quantity"),type:"bar",barWidth:"35%",data:l?l.map(e=>e.quantity):[],itemStyle:{borderRadius:[10,10,0,0],color:new J.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#a6ffcb"},{offset:1,color:"#1fa2ff"}])}},{name:o("Sales"),type:"line",yAxisIndex:1,data:l?l.map(e=>e.total):[],markPoint:{data:l?l.map((e,r)=>({value:e.total>=1e3?parseInt(e.total/1e3)+"k":e.total,xAxis:r,yAxis:e.total})):[]}}]},U=e=>{let r="";const u=new Uint8Array(e),C=u.byteLength;for(let d=0;d<C;d++)r+=String.fromCharCode(u[d]);return window.btoa(r)},N=e=>{if(!e)return"";const r=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${u}-${r}`},ee=async()=>{const e=_.loading("Please wait..."),r=N(b[0]),u=N(b[1]),C=await M(()=>import("./exceljs.min-15b947a5.js").then(y=>y.e),["assets/exceljs.min-15b947a5.js","assets/vendor-f48e548e.js"]),d=new C.Workbook,c=d.addWorksheet("Data");fetch(Y).then(y=>y.blob()).then(async y=>{const F=new FileReader;F.onload=async function(){const W=F.result,j=d.addImage({base64:W,extension:"png"});c.addImage(j,{tl:{col:0,row:0},ext:{width:100,height:60}});const k=c.getCell("A1");k.value=`${o("Office Wise Sales")} (${v})`,k.font={bold:!0,color:{argb:"000000"},size:14},k.alignment={vertical:"middle",horizontal:"center"},c.mergeCells("A1:D1");const i=c.getCell("A2");i.value=`${o("Period")}: ${r} ${o("to")} ${u}`,i.font={bold:!0,color:{argb:"000000"},size:12},i.alignment={horizontal:"center"},c.mergeCells("A2:D2"),c.getColumn(1).width=15,c.getColumn(2).width=50,c.getColumn(3).width=15,c.getColumn(4).width=15;const $=c.addRow([o("#"),o("Office"),o("Sales"),o("Quantity")]);$.font={bold:!0,color:{argb:"000000"},size:12},$.eachCell(f=>{f.font={bold:!0,color:{argb:"000000"},size:12},f.border={bottom:{style:"thin",color:{argb:"000000"}}}}),l.forEach((f,w)=>{const p=c.addRow([w+1,f.officeName,f.total,f.quantity]);p.getCell(1).alignment={horizontal:"left"},p.getCell(2).alignment={horizontal:"left"},p.getCell(3).alignment={horizontal:"right"},p.getCell(4).alignment={horizontal:"right"}});const D=`${Date.now()}OfficeWiseSales${x}_${v}_${r}_${u}.xlsx`;d.xlsx.writeBuffer().then(async f=>{const w=new FormData;w.append("file",new Blob([f]),D);try{const p=await B.post("https://dev-def-dash-route-api.inspirigenceworks.co.in/api/uploader",w,{headers:{"Content-Type":"multipart/form-data"}});p.status==200?_.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):_.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const I=p.data.url;window.location.href=`https://dev-def-dash-route-api.inspirigenceworks.co.in/static/downloads/${I}`}catch(p){console.error("Error saving Excel file:",p)}})},F.readAsDataURL(y)})},te=async()=>{const e=_.loading("Please wait..."),r=N(b[0]),u=N(b[1]),d=new URLSearchParams(window.location.search).get("lang"),c=await B.get(we,{responseType:"arraybuffer"}),y=U(c.data),F=await B.get(_e,{responseType:"arraybuffer"}),W=U(F.data);M(()=>import("./jspdf.es.min-4849f735.js").then(j=>j.j),["assets/jspdf.es.min-4849f735.js","assets/index-9709244e.js","assets/vendor-f48e548e.js","assets/index-74b21cfb.css","assets/Dashboard-c09c3291.js","assets/axios-aa9cae93.js","assets/installSVGRenderer-7788c1a1.js","assets/assertThisInitialized-46084dcb.js","assets/Skeleton-26b4d238.js","assets/Dashboard-5c3f3713.css"]).then(async j=>{let k=j.default;const i=new k;i.addFileToVFS("NotoSansBengali.ttf",y),i.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),i.setFont("NotoSansBengali"),i.addFileToVFS("NotoSansDevanagari.ttf",W),i.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),i.setFont("NotoSansDevanagari");const $=[[o("#"),o("Office"),o("Sales"),o("Quantity")]],V={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"},3:{halign:"center"}},D={fontSize:12,fontStyle:"bold",halign:"center"},f={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},w=Y,p=35,I=20;i.addImage(w,"PNG",15,12,p,I);const se=[[`${o("Office Wise Sales")} (${v})`]];i.autoTable({head:se,body:[],headStyles:{...D,fillColor:f.summaryHeader,textColor:"#FFFFFF"},margin:{top:30},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const ie=[[`${o("Period")}: ${r} ${o("to")} ${u}`]];i.autoTable({startY:39.5,head:ie,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});let ae=l.map((g,A)=>[A+1,g.officeName,`₹ ${parseFloat(g.total)}`,`${parseFloat(g.quantity)}`]);const le={startY:i.autoTable.previous.finalY+1,head:$,body:ae,headStyles:{...D,fillColor:f.secondHeader,textColor:"#FFFFFF"},columnStyles:V,styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}};i.autoTable(le);const ce=`${Date.now()}OfficeWiseSales${x}_${v}_${r}_${u}.pdf`,de=i.output("blob"),G=new FormData;G.append("file",de,ce);try{const g=await B.post("https://dev-def-dash-route-api.inspirigenceworks.co.in/api/uploader",G,{headers:{"Content-Type":"multipart/form-data"}});g.status==200?_.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):_.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const A=await g.data.url;window.location.href=`https://dev-def-dash-route-api.inspirigenceworks.co.in/static/downloads/${A}`}catch(g){console.error("Error saving PDF file:",g)}})},oe=e=>{e==="Top5"?h(n==null?void 0:n.top5):e==="Top10"?h(n==null?void 0:n.top10):e==="Bottom5"?h(n==null?void 0:n.bottom5):e==="Bottom10"&&h(n==null?void 0:n.bottom10),K(e)};m.useEffect(()=>{const e=r=>{E.current&&!E.current.contains(r.target)&&P.current&&!P.current.contains(r.target)&&r.target.tagName!=="svg"&&r.target.tagName!=="path"&&O(!1),q.current&&!q.current.contains(r.target)&&Q(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const ne=()=>{Q(!1),O(!L)},re=Se({typography:{button:{textTransform:"none"}}});return t.jsx(t.Fragment,{children:t.jsxs("div",{className:`${s.chartContainer} ${a==="dark"?s.darkMode:s.lightMode}`,children:[t.jsx(be,{position:"top-center",theme:a}),t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsx("div",{className:"d-flex align-items-center",children:t.jsx(Ce,{theme:re,children:t.jsx(Fe,{sx:{mx:1,mt:1,minWidth:100},size:"small",children:t.jsxs(je,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",displayEmpty:!0,value:x,style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},onChange:e=>{oe(e.target.value)},children:[t.jsxs(T,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"Top5",children:[o("Top")," 5"]}),t.jsxs(T,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"Top10",children:[o("Top")," 10"]}),t.jsxs(T,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"Bottom5",children:[o("Bottom")," 5"]}),t.jsxs(T,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"Bottom10",children:[o("Bottom")," 10"]})]})})})}),t.jsx("div",{className:`fw-bold me-2 fs-${window.innerWidth<=768?7:5} ${a==="dark"?s.darkMode:s.lightMode}`,children:o("Office Wise Sales")}),t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:E,children:t.jsxs("div",{className:`${s.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${s.icon} ${a==="dark"?s.darkMode:s.lightMode} px-2 py-1`,onClick:ne,children:L?t.jsx(pe,{style:{fontSize:"1.1rem"}}):t.jsx(me,{style:{fontSize:"1.1rem"}})}),L&&t.jsxs("div",{className:`${s.exportOptions} ${a==="dark"?s.darkMode:s.lightMode}`,ref:P,children:[S?t.jsxs("div",{className:s.exportOption,onClick:()=>{z(!S),O(!1)},children:[t.jsx(he,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:o("View Graph")})]}):t.jsxs("div",{className:s.exportOption,onClick:()=>{z(!S),O(!1)},children:[t.jsx(ue,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:o("View Table")})]}),t.jsxs("div",{className:s.exportOption,onClick:ee,children:[t.jsx(ge,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:o("Export to Excel")})]}),t.jsxs("div",{className:s.exportOption,onClick:te,children:[t.jsx(xe,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:o("Export to PDF")})]})]})]})})]})}),R&&t.jsx("div",{className:s.loadingOverlay,children:t.jsx("img",{src:ye,alt:"Loading...",width:50,height:50})}),l&&l.length==0&&!S&&!R?t.jsx("div",{className:`${s.NoDataOverlay} fs-5`,children:o("No Data Found")}):"",S?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"334px"},children:t.jsxs("table",{className:`table  ${a=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:o("Office")}),t.jsxs("th",{scope:"col",children:[o("Sales"),"(₹)"]}),t.jsx("th",{scope:"col",children:o("Quantity")})]})}),t.jsx("tbody",{children:l.map((e,r)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:r+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.total).toFixed(2)}),t.jsx("td",{children:parseFloat(e.quantity).toFixed(2)})]},e.officeName))})]})}):t.jsx(X,{option:Z,style:{height:"350px",width:"100%",maxWidth:"2300px"},className:s.piechart},l)]})})};export{yt as default};
