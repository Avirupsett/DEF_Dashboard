import{_ as Y}from"./index-644f0d0c.js";import{r as d,u as de,j as t,G as fe,H as pe,h as he,z as ue,A as ge,I as xe,C as me,E as ye,a as H}from"./vendor-1b7ca1de.js";import{l as _e,E as we,M as be,a as U,F as Se}from"./index-2f584025.js";const ve="_chartContainer_ew0vy_1",Ce="_lightMode_ew0vy_47",Fe="_dateFilter_ew0vy_51",ke="_officefilter_ew0vy_207",Ne="_topContainer_ew0vy_299",je="_darkMode_ew0vy_319",Be="_iconsContainer_ew0vy_487",Oe="_icon_ew0vy_487",Te="_exportOptions_ew0vy_571",$e="_exportOption_ew0vy_571",Ee="_NoDataOverlay_ew0vy_659",De="_tableContainer_ew0vy_849",ze="_table_ew0vy_849",Pe="_summaryHeader_ew0vy_885",We="_periodHeader_ew0vy_893",Le="_closeButton_ew0vy_925",Ie="_tableWrapper_ew0vy_955",He="_loadingOverlay_ew0vy_963",Re="_loadingSpinner_ew0vy_989",Ae="_boldOption_ew0vy_1001",Ge="_optionGroup_ew0vy_1011",Me="_resetButtonContainer_ew0vy_1039",Ve="_resetButton_ew0vy_1039",a={chartContainer:ve,lightMode:Ce,"label-text":"_label-text_ew0vy_47",dateFilter:Fe,officefilter:ke,topContainer:Ne,darkMode:je,"theme-container":"_theme-container_ew0vy_329",iconsContainer:Be,icon:Oe,exportOptions:Te,exportOption:$e,NoDataOverlay:Ee,tableContainer:De,table:ze,summaryHeader:Pe,periodHeader:We,closeButton:Le,tableWrapper:Ie,loadingOverlay:He,loadingSpinner:Re,boldOption:Ae,optionGroup:Ge,resetButtonContainer:Me,resetButton:Ve},qe=({themeMode:c,selectedRange:h,selectedOffice:u,isAdmin:x,SelectedOfficeName:Ye,setSelectedOffice:$,setIsAdmin:_})=>{const[f,J]=d.useState([]),[E,k]=d.useState(!1),D=d.useRef(null),z=d.useRef(null),[R,A]=d.useState(!0),[w,G]=d.useState(!1),[M,X]=d.useState([]),[m,P]=d.useState([]),[q,W]=d.useState(!1),[K,L]=d.useState(!1),[N,Q]=d.useState({selectedOffice:u,isAdmin:x}),{t:n}=de(),Z=[{name:"officeName",label:n("Office")},{name:"sales",label:`${n("Sales")}(₹)`}],ee={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:n("Rows")}}};d.useEffect(()=>{const e=l=>{D.current&&!D.current.contains(l.target)&&z.current&&!z.current.contains(l.target)&&l.target.tagName!=="svg"&&l.target.tagName!=="path"&&k(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const j=()=>{A(!0);const e=y(h[0]),l=y(h[1]);H.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${e}/${l}/${u}/${x}`).then(i=>{const{data:s}=i;if(s.graph1){let o=[],g=[];for(let r=0;r<s.graph1.length;r++)o.push({officeId:s.graph1[r].officeId,officeName:s.graph1[r].officeName,officeType:s.graph1[r].officeType,sales:s.graph1[r].totalIncome.toFixed(0),color:s.graph1[r].officeTypeColor}),g.push({officeName:s.graph1[r].officeName,sales:s.graph1[r].totalIncome.toFixed(2)});g.push({officeName:"Total",sales:o.reduce((r,b)=>r+parseFloat(b.sales),0).toFixed(2)}),X(g),J(o)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{A(!1)})};d.useEffect(()=>{h&&u&&j()},[h,u,x]);const te={title:{textStyle:{color:c==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${n("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?n("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:c==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:f.map((e,l)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:f.length<=5,position:"right",color:c==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},V=e=>{let l="";const i=new Uint8Array(e),s=i.byteLength;for(let o=0;o<s;o++)l+=String.fromCharCode(i[o]);return window.btoa(l)},oe=async()=>{const e=y(h[0]),l=y(h[1]),i=await Y(()=>import("./exceljs.min-a898dc82.js").then(p=>p.e),["assets/exceljs.min-a898dc82.js","assets/vendor-1b7ca1de.js"]),s=new i.Workbook,o=s.addWorksheet("Total Sales by Office"),g=await H.get(U,{responseType:"arraybuffer"}),r=V(g.data),b=s.addImage({base64:r,extension:"png"});o.addImage(b,{tl:{col:0,row:0},ext:{width:40,height:40}});const S=o.getCell("A1");S.value=n("Total Sales by Business Entity"),S.font={bold:!0,color:{argb:"000000"},size:14},S.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:C1");const v=o.getCell("A2");v.value=`${n("Period")}: ${e} ${n("to")} ${l}`,v.font={bold:!0,color:{argb:"000000"},size:12},v.alignment={horizontal:"center"},o.mergeCells("A2:C2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const I=o.addRow([n("Office Name"),n("Sales")]);I.font={bold:!0},f.forEach(p=>{o.addRow([p.officeName,p.sales])});const B=o.addRow([n("Total"),""]);B.font={bold:!0,color:{argb:"000000"},size:12};const O=f.reduce((p,F)=>p+parseFloat(F.sales),0),C=o.getCell(`B${B.number}`);C.value=`₹${O}`,C.numFmt="0.00",C.alignment={horizontal:"right"},s.xlsx.writeBuffer().then(p=>{const F=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Se.saveAs(F,"total_sales_by_office.xlsx")})},ae=async()=>{const e=y(h[0]),l=y(h[1]),i=await H.get(U,{responseType:"arraybuffer"}),s=V(i.data);Y(()=>import("./index-2f584025.js").then(o=>o.j),["assets/index-2f584025.js","assets/vendor-1b7ca1de.js","assets/index-644f0d0c.js","assets/index-4da97eed.css"]).then(o=>{let g=o.default;const r=new g,b=s,S=35,v=20;r.addImage(b,"PNG",15,9,S,v);const I=[[n("Total Sales by Business Entity")]];r.autoTable({startY:27,head:I,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const B=[[`${n(Period)}: ${e} ${n(to)} ${l}`]];r.autoTable({startY:36,head:B,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const O=f.map(T=>[T.officeName,parseFloat(T.sales.toFixed(2))]),C=f.reduce((T,ce)=>T+parseFloat(ce.sales),0);O.push([n("Total"),`${C.toFixed(2)}`]);const p=[n("Office Name"),n("Sales")],F={1:{halign:"right"},2:{halign:"right"}},ie={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};r.autoTable(p,O,{startY:45,headStyles:ie,columnStyles:F}),r.save("total_sales_by_office.pdf")})},ne=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const l=f[e.dataIndex].officeId,i=f[e.dataIndex].officeType;P(s=>[...s,{selectedOffice:u,isAdmin:x}]),$(l),i==="Retail Pumps"?_(0):i==="Wholesale Pumps"?_(3):i==="Company"&&_(5),Q({selectedOffice:u,isAdmin:x}),j(),L(!0),W(!0)}},se=()=>{if(m.length>0){const e=m.pop();$(e.selectedOffice),_(e.isAdmin),P([...m]),j(),m.length===0&&L(!1),m.length===0&&W(!1)}},re=()=>{$(N.selectedOffice),_(N.isAdmin),P([]),j(),L(!1),W(!1)},le=()=>{k(!E)},y=e=>{if(!e)return"";const l=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${l}-${i}-${s}`};return t.jsxs("div",{className:`${a.chartContainer} ${c==="dark"?a.darkMode:a.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-5 ${c==="dark"?a.darkMode:a.lightMode}`,children:n("Total Sales by Business Entity")}),K&&u!==N.selectedOffice&&x!==N.isAdmin?t.jsx("div",{className:a.resetButtonContainer,children:t.jsx("button",{className:a.resetButton,onClick:re,children:t.jsx(fe,{style:{fontSize:"1rem"}})})}):null,q&&m.length>0?t.jsx("div",{className:a.resetButtonContainer,children:t.jsx("button",{className:a.resetButton,onClick:se,children:t.jsx(pe,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{className:"d-flex g-0",ref:D,children:t.jsxs("div",{className:`${a.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${a.icon} ${c==="dark"?a.darkMode:a.lightMode} px-2 py-1`,onClick:le,children:E?t.jsx(he,{style:{fontSize:"1.1rem"}}):t.jsx(ue,{style:{fontSize:"1.1rem"}})}),E&&t.jsxs("div",{className:`${a.exportOptions} ${c==="dark"?a.darkMode:a.lightMode}`,ref:z,children:[w?t.jsxs("div",{className:a.exportOption,onClick:()=>{G(!w),k(!1)},children:[t.jsx(xe,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:n("View Graph")})]}):t.jsxs("div",{className:a.exportOption,onClick:()=>{G(!w),k(!1)},children:[t.jsx(ge,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:n("View Table")})]}),t.jsxs("div",{className:a.exportOption,onClick:oe,children:[t.jsx(me,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:n("Export to Excel")})]}),t.jsxs("div",{className:a.exportOption,onClick:ae,children:[t.jsx(ye,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),R&&t.jsx("div",{className:a.NoDataOverlay,children:t.jsx("img",{src:_e,alt:"Loading..."})}),M.length==1&&!w&&!R?t.jsx("div",{className:`${a.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",w?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(be,{data:M,columns:Z,options:ee})}):t.jsx(we,{option:te,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:ne},className:c==="dark"?a.darkMode:a.lightMode})]})};export{qe as default};
