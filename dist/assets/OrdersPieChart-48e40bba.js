import{_ as I}from"./index-b65a56b3.js";import{r as d,u as X,l as K,j as t,g as Z,z as tt,A as et,H as ot,C as at,E as nt}from"./vendor-f9418046.js";import{L as st,a as rt,E as lt,M as it,F as ct}from"./index-82834b22.js";import{l as R}from"./logo-604665f9.js";const dt="_piechart_1ah4s_11",ht="_chartContainer_1ah4s_23",ft="_legendButtonContainer_1ah4s_49",pt="_legendButton_1ah4s_49",ut="_codeBlockIcon_1ah4s_133",gt="_lightMode_1ah4s_191",mt="_dateFilter_1ah4s_195",_t="_officefilter_1ah4s_351",xt="_topContainer_1ah4s_443",bt="_darkMode_1ah4s_463",yt="_iconsContainer_1ah4s_631",Ct="_icon_1ah4s_631",St="_exportOptions_1ah4s_715",wt="_exportOption_1ah4s_715",kt="_NoDataOverlay_1ah4s_861",vt="_tableContainer_1ah4s_993",Ft="_table_1ah4s_993",Nt="_summaryHeader_1ah4s_1029",jt="_periodHeader_1ah4s_1037",$t="_closeButton_1ah4s_1069",Dt="_tableWrapper_1ah4s_1099",Ot="_loadingOverlay_1ah4s_1107",Pt="_loadingSpinner_1ah4s_1133",Et="_boldOption_1ah4s_1145",Bt="_optionGroup_1ah4s_1155",e={piechart:dt,chartContainer:ht,"legend-text":"_legend-text_1ah4s_31",legendButtonContainer:ft,legendButton:pt,codeBlockIcon:ut,lightMode:gt,"label-text":"_label-text_1ah4s_191",dateFilter:mt,officefilter:_t,topContainer:xt,darkMode:bt,"theme-container":"_theme-container_1ah4s_473",iconsContainer:yt,icon:Ct,exportOptions:St,exportOption:wt,NoDataOverlay:kt,tableContainer:vt,table:Ft,summaryHeader:Nt,periodHeader:jt,closeButton:$t,tableWrapper:Dt,loadingOverlay:Ot,loadingSpinner:Pt,boldOption:Et,optionGroup:Bt},Wt=({themeMode:g,selectedRange:y,selectedOffice:F,isAdmin:H})=>{const[m,M]=d.useState([]),[N,S]=d.useState(!1),j=d.useRef(null),$=d.useRef(null),D=d.useRef(null),{t:n}=X(),[O,P]=d.useState(!1),[T,A]=d.useState([]),[w,E]=d.useState(!1),[L,W]=d.useState(!1),Q=[{name:"Product Name",label:n("Product")},{name:"Quantity",label:n("Quantity")},{name:"Sales",label:`${n("Sales")}(₹)`}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"229px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:n("Rows")}}};d.useEffect(()=>{W(!0);const o=C(y[0]),r=C(y[1]);o&&r&&F&&K.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${o}/${r}/${F}/${H}`).then(h=>{const a=h.data.graph2;let l={},x={},u={},b={};if(a.forEach(f=>{const{lstproduct:p}=f;p.forEach(s=>{let{productName:c,totalSales:i,color:B,qty:k,unitShortName:z}=s;i!==0&&(l[c]?(l[c]+=i,u[c]+=k):(l[c]=i,x[c]=B,u[c]=k,b[c]=z))})}),l){let f=[],p=[];for(let s in l)f.push({productName:s,totalSale:l[s],color:x[s],totalQty:u[s],unit:b[s]}),p.push({"Product Name":s,Sales:l[s],Quantity:`${u[s]} ${b[s]}`});A(p),M(f)}}).catch(h=>{}).finally(()=>{W(!1)})},[y,F,H]);const V=()=>{m.length>0&&(P(!O),S(!1),E(!1))},Y={tooltip:{trigger:"item",formatter:`<b>{b}</b><br><b>${n("Total Sales")}:</b> ₹{c}`,textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:g==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:O,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:g==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"2%",style:{fill:g==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Sales",type:"pie",radius:["40%","65%"],center:["50%","50%"],selectedMode:"single",avoidLabelOverlap:!0,label:{show:m.length<=10,color:g==="dark"?"#ffffff":"#111111"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:m.length>0?m.map((o,r)=>({value:o.totalSale,name:o.productName,itemStyle:{color:o.color}})):[],itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},U=async()=>{const o=C(y[0]),r=C(y[1]),h=await I(()=>import("./exceljs.min-3ff9b368.js").then(l=>l.e),["assets/exceljs.min-3ff9b368.js","assets/vendor-f9418046.js"]),_=new h.Workbook,a=_.addWorksheet("Data");fetch(R).then(l=>l.blob()).then(l=>{const x=new FileReader;x.onload=function(){const u=x.result,b=_.addImage({base64:u,extension:"png"});a.addImage(b,{tl:{col:0,row:0},ext:{width:100,height:70}});const f=a.getCell("A2");f.value=n("Product Wise Summary Data"),f.font={bold:!0,color:{argb:"000000"},size:14},f.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A2:C2");const p=a.getCell("A3");p.value=`${n("Period")}: ${o} ${n("to")} ${r}`,p.font={bold:!0,color:{argb:"000000"},size:12},p.alignment={horizontal:"center"},a.mergeCells("A3:C3"),a.getColumn(1).width=50,a.getColumn(2).width=15;const s=a.addRow([n("Product Name"),n("Quantity"),n("Total Sales")]);s.font={bold:!0,color:{argb:"000000"},size:12},s.eachCell(i=>{i.font={bold:!0,color:{argb:"000000"},size:12},i.border={bottom:{style:"thin",color:{argb:"000000"}}}}),m.forEach(i=>{a.addRow([i.productName,`${i.totalQty} ${i.unit}`,`₹${i.totalSale}`])});const c=`product_wise_summary_data_${Date.now()}.xlsx`;_.xlsx.writeBuffer().then(i=>{ct.saveAs(new Blob([i]),c)})},x.readAsDataURL(l)})},C=o=>{if(!o)return"";const r=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),_=String(o.getDate()).padStart(2,"0");return`${r}-${h}-${_}`},q=async()=>{const o=C(y[0]),r=C(y[1]);I(()=>import("./index-82834b22.js").then(h=>h.j),["assets/index-82834b22.js","assets/vendor-f9418046.js","assets/index-b65a56b3.js","assets/index-4da97eed.css"]).then(h=>{let _=h.default;const a=new _,l=[["Product Name","Quantity","Total Sale"]],x={1:{halign:"right"},2:{halign:"right"}},u={fontSize:12,fontStyle:"bold",halign:"center"},b={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},f=R,p=35,s=20;a.addImage(f,"PNG",15,12,p,s);const c=[["Product Wise Summary Data"]];a.autoTable({head:c,body:[],headStyles:{...u,fillColor:b.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const i=[[`Period: ${o} to ${r}`]];a.autoTable({startY:39.5,head:i,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const B=m.map(v=>[v.productName,`${v.totalQty} ${v.unit}`,v.totalSale.toFixed(2)]),k={startY:a.autoTable.previous.finalY+1,head:l,body:B,headStyles:{...u,fillColor:b.secondHeader,textColor:"#FFFFFF"},columnStyles:x};a.autoTable(k);const z=`product_wise_summary_data_${Date.now()}.pdf`;a.save(z)})};d.useEffect(()=>{const o=r=>{j.current&&!j.current.contains(r.target)&&$.current&&!$.current.contains(r.target)&&r.target.tagName!=="svg"&&r.target.tagName!=="path"&&S(!1),D.current&&!D.current.contains(r.target)&&P(!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[]);const J=()=>{P(!1),S(!N)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:`${e.chartContainer} ${g==="dark"?e.darkMode:e.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsxs("button",{className:e.legendButton,onClick:V,ref:D,children:[t.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:e.codeBlockIcon,title:"Legends",style:{filter:O||m.length===0?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),t.jsx("div",{className:`fw-bold fs-5 ${g==="dark"?e.darkMode:e.lightMode}`,children:n("Product Volume")}),t.jsx("div",{className:"d-flex g-0",ref:j,children:t.jsxs("div",{className:`${e.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${e.icon} ${g==="dark"?e.darkMode:e.lightMode} px-2 py-1`,onClick:J,children:N?t.jsx(Z,{style:{fontSize:"1.1rem"}}):t.jsx(tt,{style:{fontSize:"1.1rem"}})}),N&&t.jsxs("div",{className:`${e.exportOptions} ${g==="dark"?e.darkMode:e.lightMode}`,ref:$,children:[w?t.jsxs("div",{className:e.exportOption,onClick:()=>{E(!w),S(!1)},children:[t.jsx(ot,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:n("View Graph")})]}):t.jsxs("div",{className:e.exportOption,onClick:()=>{E(!w),S(!1)},children:[t.jsx(et,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:n("View Table")})]}),t.jsxs("div",{className:e.exportOption,onClick:U,children:[t.jsx(at,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:n("Export to Excel")})]}),t.jsxs("div",{className:e.exportOption,onClick:q,children:[t.jsx(nt,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),L&&t.jsx("div",{className:e.NoDataOverlay,children:t.jsx(st,{animationData:rt,loop:!0})}),T.length==0&&!w&&!L?t.jsx("div",{className:`${e.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",w?t.jsx("div",{className:"container-fluid pt-2",children:t.jsx(it,{data:T,columns:Q,options:G})}):t.jsx(lt,{option:Y,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:e.piechart},m.length)]})})};export{Wt as default};
