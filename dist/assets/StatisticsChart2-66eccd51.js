import{_ as oe}from"./index-02818364.js";import{r as c,u as Ne,j as t,G as je,H as ke,h as Be,z as Oe,A as Te,I as De,C as $e,E as Ee,a as u}from"./vendor-257ea584.js";import{l as Pe,E as ze,a as ae,f as Ie,b as We}from"./NotoSansDevanagari-VariableFont_wdth_wght-a10c3ce4.js";const Re="_chartContainer_ew0vy_1",He="_lightMode_ew0vy_47",Le="_dateFilter_ew0vy_51",Ae="_officefilter_ew0vy_207",Ge="_topContainer_ew0vy_299",Ve="_darkMode_ew0vy_319",Ue="_iconsContainer_ew0vy_487",Ye="_icon_ew0vy_487",Me="_exportOptions_ew0vy_571",qe="_exportOption_ew0vy_571",Je="_NoDataOverlay_ew0vy_659",Xe="_tableContainer_ew0vy_849",Ke="_table_ew0vy_849",Qe="_summaryHeader_ew0vy_885",Ze="_periodHeader_ew0vy_893",et="_closeButton_ew0vy_925",tt="_tableWrapper_ew0vy_955",ot="_loadingOverlay_ew0vy_963",at="_loadingSpinner_ew0vy_989",nt="_boldOption_ew0vy_1001",st="_optionGroup_ew0vy_1011",rt="_resetButtonContainer_ew0vy_1039",it="_resetButton_ew0vy_1039",s={chartContainer:Re,lightMode:He,"label-text":"_label-text_ew0vy_47",dateFilter:Le,officefilter:Ae,topContainer:Ge,darkMode:Ve,"theme-container":"_theme-container_ew0vy_329",iconsContainer:Ue,icon:Ye,exportOptions:Me,exportOption:qe,NoDataOverlay:Je,tableContainer:Xe,table:Ke,summaryHeader:Qe,periodHeader:Ze,closeButton:et,tableWrapper:tt,loadingOverlay:ot,loadingSpinner:at,boldOption:nt,optionGroup:st,resetButtonContainer:rt,resetButton:it},pt=({themeMode:i,selectedRange:y,selectedOffice:Y,isAdmin:ne,alldata:T,isLoading:M,SelectedOfficeName:lt,setSelectedOffice:D,setIsAdmin:$,setCompanies:se,setWholesales:re,setRetails:ie,originallist:C,setOfficeIdLocal:E,officeIdLocal:le,setOptionvalue:q})=>{const[f,ce]=c.useState([]),[P,F]=c.useState(!1),z=c.useRef(null),I=c.useRef(null),[m,J]=c.useState(!1),[X,de]=c.useState([]),[x,W]=c.useState([]),[K,Q]=c.useState([]),[fe,R]=c.useState(!1),[pe,Z]=c.useState(!1),[he,N]=c.useState(!0),{t:n}=Ne();n("Office"),`${n("Sales")}`,n("Rows"),c.useEffect(()=>{const e=a=>{z.current&&!z.current.contains(a.target)&&I.current&&!I.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&F(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const ee=e=>{let a=[],d=[];T.graph3&&(T.graph3.map(o=>{a.push({officeId:o.officeId,officeName:o.officeName,officeType:o.officeType,sales:o.totalIncome.toFixed(2),color:o.officeTypeColor}),d.push({officeName:o.officeName,sales:o.totalIncome.toFixed(2)})}),d.push({officeName:"Total",sales:a.reduce((o,r)=>o+parseFloat(r.sales),0).toFixed(2)}),e===1&&(se(a.filter(o=>o.officeType==="Company")),re(a.filter(o=>o.officeType==="Wholesale Pumps")),ie(a.filter(o=>o.officeType==="Retail Pumps")),N(!0)),ce(a),de(d))};c.useEffect(()=>{y&&Y&&ee(he?0:1)},[T]);const ue={title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${n("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?n("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:f.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:f.length<=5,position:"right",color:i==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},j=e=>{let a="";const d=new Uint8Array(e),o=d.byteLength;for(let r=0;r<o;r++)a+=String.fromCharCode(d[r]);return window.btoa(a)},ye=async()=>{const e=k(y[0]),a=k(y[1]),d=await oe(()=>import("./exceljs.min-d3f5f5bd.js").then(p=>p.e),["assets/exceljs.min-d3f5f5bd.js","assets/vendor-257ea584.js"]),o=new d.Workbook,r=o.addWorksheet("Total Sales by Office"),H=await u.get(ae,{responseType:"arraybuffer"}),L=j(H.data),A=o.addImage({base64:L,extension:"png"});r.addImage(A,{tl:{col:0,row:0},ext:{width:100,height:60}});const g=r.getCell("A1");g.value=n("Total Sales by Business Entity"),g.font={bold:!0,color:{argb:"000000"},size:14},g.alignment={vertical:"middle",horizontal:"center"},r.mergeCells("A1:C1");const w=r.getCell("A2");w.value=`${n("Period")}: ${e} ${n("to")} ${a}`,w.font={bold:!0,color:{argb:"000000"},size:12},w.alignment={horizontal:"center"},r.mergeCells("A2:B2"),r.getColumn(1).width=50,r.getColumn(2).width=15,r.getColumn(3).width=15;const b=r.addRow([n("Office Name"),n("Sales")]);b.font={bold:!0},f.forEach(p=>{r.addRow([p.officeName,p.sales])});const B=r.addRow([n("Total"),""]);B.font={bold:!0,color:{argb:"000000"},size:12};const l=f.reduce((p,S)=>p+parseFloat(S.sales),0),_=r.getCell(`B${B.number}`);_.value=`â‚¹${l}`,_.numFmt="0.00",_.alignment={horizontal:"right"};const G=Date.now();o.xlsx.writeBuffer().then(async p=>{const S=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),O=new FormData;O.append("file",S,`${G}_sales_by_office.xlsx`);try{const V=(await u.post("http://115.124.120.251:5064/api/uploader",O,{headers:{"Content-Type":"multipart/form-data"}})).data.url;window.location.replace(`http://115.124.120.251:5064/static/${V}`)}catch(v){console.error("Error saving Excel file:",v)}})},me=async()=>{const e=k(y[0]),a=k(y[1]),o=new URLSearchParams(window.location.search).get("lang"),r=await u.get(ae,{responseType:"arraybuffer"}),H=await u.get(Ie,{responseType:"arraybuffer"}),L=j(H.data),A=await u.get(We,{responseType:"arraybuffer"}),g=j(A.data),w=j(r.data);oe(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-a10c3ce4.js").then(b=>b.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-a10c3ce4.js","assets/vendor-257ea584.js","assets/index-02818364.js","assets/index-4da97eed.css"]).then(async b=>{let B=b.default;const l=new B,_=w,G=35,p=20;l.addImage(_,"PNG",15,9,G,p),l.addFileToVFS("NotoSansBengali.ttf",L),l.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),l.setFont("NotoSansBengali"),l.addFileToVFS("NotoSansDevanagari.ttf",g),l.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),l.setFont("NotoSansDevanagari");const S=[[n("Total Sales by Business Entity")]];l.autoTable({startY:27,head:S,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const O=[[`${n("Period")}: ${e} ${n("to")} ${a}`]];l.autoTable({startY:36,head:O,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const v=f.map(h=>[h.officeName,h.sales]),V=f.reduce((h,U)=>h+parseFloat(U.sales),0);v.push([n("Total"),`${V.toFixed(2)}`]);const _e=[n("Office Name"),n("Sales")],Se={1:{halign:"right"},2:{halign:"right"}},ve={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};l.autoTable(_e,v,{startY:45,headStyles:ve,columnStyles:Se,styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const Ce=Date.now(),Fe=l.output("blob"),te=new FormData;te.append("file",Fe,`${Ce}_total_sales_by_office.pdf`);try{const U=await(await u.post("http://115.124.120.251:5064/api/uploader",te,{headers:{"Content-Type":"multipart/form-data"}})).data.url;window.location.replace(`http://115.124.120.251:5064/static/${U}`)}catch(h){console.error("Error saving PDF file:",h)}})},xe=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const a=f[e.dataIndex].officeId;f[e.dataIndex].officeType==="Company"&&(N(!1),W(o=>[...o,{selectedOffice:Y,isAdmin:ne}]),Q(o=>[...o,le]),D(a),$(6),E(a),Z(!0),R(!0))}},ge=()=>{if(x.length>0){N(!1);const e=x.pop(),a=K.pop();q({state:!0,Ovalue:a}),D(e.selectedOffice),E(a),$(e.isAdmin),W([...x]),Q([...K]),x.length===0&&R(!1)}},we=()=>{N(!1),D(C.officeId),q({state:!0,Ovalue:C.officeId}),$(C.adminStatus),E(C.officeId),W([]),Z(!1),R(!1)},be=()=>{F(!P)},k=e=>{if(!e)return"";const a=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${a}-${d}-${o}`};return t.jsxs("div",{className:`${s.chartContainer} ${i==="dark"?s.darkMode:s.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${i==="dark"?s.darkMode:s.lightMode}`,children:n("Total Sales by Business Entity")}),pe?t.jsx("div",{title:"Reset",className:s.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:we,children:t.jsx(je,{style:{fontSize:"1rem"}})})}):null,fe&&x.length>0?t.jsx("div",{title:"Previous",className:s.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ge,children:t.jsx(ke,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:z,children:t.jsxs("div",{className:`${s.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${s.icon} ${i==="dark"?s.darkMode:s.lightMode} px-2 py-1`,onClick:be,children:P?t.jsx(Be,{style:{fontSize:"1.1rem"}}):t.jsx(Oe,{style:{fontSize:"1.1rem"}})}),P&&t.jsxs("div",{className:`${s.exportOptions} ${i==="dark"?s.darkMode:s.lightMode}`,ref:I,children:[m?t.jsxs("div",{className:s.exportOption,onClick:()=>{J(!m),F(!1)},children:[t.jsx(De,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:n("View Graph")})]}):t.jsxs("div",{className:s.exportOption,onClick:()=>{J(!m),F(!1)},children:[t.jsx(Te,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:n("View Table")})]}),t.jsxs("div",{className:s.exportOption,onClick:ye,children:[t.jsx($e,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:n("Export to Excel")})]}),t.jsxs("div",{className:s.exportOption,onClick:me,children:[t.jsx(Ee,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),M&&t.jsx("div",{className:s.NoDataOverlay,children:t.jsx("img",{src:Pe,alt:"Loading...",width:50,height:50})}),X.length==1&&!m&&!M?t.jsx("div",{className:`${s.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",m?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"291px"},children:t.jsxs("table",{className:`table ${i=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:n("Office")}),t.jsxs("th",{scope:"col",children:[n("Sales"),"(â‚¹)"]})]})}),t.jsx("tbody",{children:X.map((e,a)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:a+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx(ze,{option:ue,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:xe},className:i==="dark"?s.darkMode:s.lightMode})]})};export{pt as default};
