import{_ as de}from"./index-652e1c3b.js";import{r as d,u as Ee,j as o,H as ze,I as We,i as Re,A as He,B as Le,J as Ae,E as Ge,G as Ve,a as _}from"./vendor-95b9cd9c.js";import{L as Me,R as Ue}from"./index-837eb269.js";import{k as Ye,l as qe,Q as v,a as fe,f as Je,b as Qe}from"./NotoSansDevanagari-VariableFont_wdth_wght-1e2e95f5.js";const Xe="_chartContainer_ew0vy_1",Ke="_lightMode_ew0vy_47",Ze="_dateFilter_ew0vy_51",et="_officefilter_ew0vy_207",tt="_topContainer_ew0vy_299",ot="_darkMode_ew0vy_319",at="_iconsContainer_ew0vy_487",nt="_icon_ew0vy_487",st="_exportOptions_ew0vy_571",rt="_exportOption_ew0vy_571",it="_NoDataOverlay_ew0vy_659",lt="_tableContainer_ew0vy_849",ct="_table_ew0vy_849",dt="_summaryHeader_ew0vy_885",ft="_periodHeader_ew0vy_893",pt="_closeButton_ew0vy_925",ht="_tableWrapper_ew0vy_955",ut="_loadingOverlay_ew0vy_963",gt="_loadingSpinner_ew0vy_989",yt="_boldOption_ew0vy_1001",wt="_optionGroup_ew0vy_1011",mt="_resetButtonContainer_ew0vy_1039",xt="_resetButton_ew0vy_1039",i={chartContainer:Xe,lightMode:Ke,"label-text":"_label-text_ew0vy_47",dateFilter:Ze,officefilter:et,topContainer:tt,darkMode:ot,"theme-container":"_theme-container_ew0vy_329",iconsContainer:at,icon:nt,exportOptions:st,exportOption:rt,NoDataOverlay:it,tableContainer:lt,table:ct,summaryHeader:dt,periodHeader:ft,closeButton:pt,tableWrapper:ht,loadingOverlay:ut,loadingSpinner:gt,boldOption:yt,optionGroup:wt,resetButtonContainer:mt,resetButton:xt},Nt=({themeMode:c,selectedRange:C,showGraph:oe,selectedOffice:L,isAdmin:pe,alldata:A,isLoading:ae,SelectedOfficeName:bt,setSelectedOfficeName:G,selectedOfficeNameLocal:x,setSelectedOfficeNameLocal:O,setSelectedOffice:T,setIsAdmin:I,setCompanies:he,setWholesales:ue,setRetails:ge,originallist:b,setOfficeIdLocal:V,officeIdLocal:ye,setOptionvalue:P})=>{const[h,we]=d.useState([]),[M,E]=d.useState(!1),U=d.useRef(null),Y=d.useRef(null),[F,q]=d.useState(!1),[J,me]=d.useState([]),[N,Q]=d.useState([]),[ne,se]=d.useState([]),[xe,X]=d.useState(!1),[be,re]=d.useState(!1),[Se,z]=d.useState(!0),[St,_e]=d.useState([]),{t:n}=Ee();n("Office"),`${n("Sales")}`,n("Rows"),d.useEffect(()=>{const e=a=>{U.current&&!U.current.contains(a.target)&&Y.current&&!Y.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&E(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const ie=e=>{let a=[],s=[];if(A.graph3){A.graph3.map(t=>{a.push({officeId:t.officeId,officeName:t.officeName,officeType:t.officeType,sales:t.totalIncome.toFixed(2),color:t.officeTypeColor}),s.push({officeName:t.officeName,sales:t.totalIncome.toFixed(2)})}),s.push({officeName:"Total",sales:a.reduce((t,l)=>t+parseFloat(l.sales),0).toFixed(2)}),e===1&&(he(a.filter(t=>t.officeType==="Company")),ue(a.filter(t=>t.officeType==="Wholesale Pumps")),ge(a.filter(t=>t.officeType==="Retail Pumps")),z(!0));const r=a.reduce((t,l)=>{const{officeType:u}=l;return t[u]||(t[u]=[]),t[u].push(l),t},{});we(a),_e(r),me(s)}};d.useEffect(()=>{C&&L&&ie(Se?0:1)},[A]);function le(e,a){var s=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),t=parseInt(e.substring(5,7),16);s=parseInt(s*(100+a)/100),r=parseInt(r*(100+a)/100),t=parseInt(t*(100+a)/100),s=s<255?s:255,r=r<255?r:255,t=t<255?t:255,s=Math.round(s),r=Math.round(r),t=Math.round(t);var l=s.toString(16).length==1?"0"+s.toString(16):s.toString(16),u=r.toString(16).length==1?"0"+r.toString(16):r.toString(16),k=t.toString(16).length==1?"0"+t.toString(16):t.toString(16);return"#"+l+u+k}const ve={title:{textStyle:{color:c==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${n("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameGap:80,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:h.map(e=>e.officeName),axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?n("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:c==="dark"?"grey":"silver",type:"line"}}},legend:{show:!0},series:[{type:"bar",barWidth:"30%",itemStyle:{borderRadius:[0,5,5,0]},data:h.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:new Me(0,0,0,1,[{offset:1,color:le(e.color,40)},{offset:0,color:le(e.color,100)}])}})),label:{show:!0,position:"right",color:c==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},W=e=>{let a="";const s=new Uint8Array(e),r=s.byteLength;for(let t=0;t<r;t++)a+=String.fromCharCode(s[t]);return window.btoa(a)},Ce=async()=>{const e=v.loading("Please wait..."),a=R(C[0]),s=R(C[1]),r=await de(()=>import("./exceljs.min-03f8d777.js").then(p=>p.e),["assets/exceljs.min-03f8d777.js","assets/vendor-95b9cd9c.js"]),t=new r.Workbook,l=t.addWorksheet("Total Sales by Office"),u=await _.get(fe,{responseType:"arraybuffer"}),k=W(u.data),Z=t.addImage({base64:k,extension:"png"});l.addImage(Z,{tl:{col:0,row:0},ext:{width:100,height:60}});const j=l.getCell("A1");j.value=`${n("Sales")} ${n("of")} ${K(x,10)}`,j.font={bold:!0,color:{argb:"000000"},size:14},j.alignment={vertical:"middle",horizontal:"center"},l.mergeCells("A1:C1");const $=l.getCell("A2");$.value=`${n("Period")}: ${a} ${n("to")} ${s}`,$.font={bold:!0,color:{argb:"000000"},size:12},$.alignment={horizontal:"center"},l.mergeCells("A2:C2"),l.getColumn(1).width=15,l.getColumn(2).width=50,l.getColumn(3).width=15;const S=l.addRow([n("#"),n("Office Name"),n("Sales")]);S.font={bold:!0},S.eachCell(p=>{p.font={bold:!0,color:{argb:"000000"},size:12},p.border={bottom:{style:"thin",color:{argb:"000000"}}}}),h.forEach((p,w)=>{const y=l.addRow([w+1,p.officeName,p.sales]);y.getCell(1).alignment={horizontal:"left"},y.getCell(2).alignment={horizontal:"left"},y.getCell(3).alignment={horizontal:"right"}});const H=l.addRow(["",n("Total"),""]);H.font={bold:!0,color:{argb:"000000"},size:12};const f=h.reduce((p,w)=>p+parseFloat(w.sales),0),D=l.getCell(`C${H.number}`);D.value=`₹ ${f}`,D.numFmt="0.00",D.alignment={horizontal:"right"};const ee=Date.now();t.xlsx.writeBuffer().then(async p=>{const w=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=new FormData;y.append("file",w,`${ee}sales_of_${x}_${a}_${s}.xlsx`);try{const m=await _.post("http://115.124.120.251:5064/api/uploader",y,{headers:{"Content-Type":"multipart/form-data"}});m.status==200?v.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):v.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const te=m.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${te}`}catch(m){console.error("Error saving Excel file:",m)}})},Fe=async()=>{const e=v.loading("Please wait..."),a=R(C[0]),s=R(C[1]),t=new URLSearchParams(window.location.search).get("lang"),l=await _.get(fe,{responseType:"arraybuffer"}),u=await _.get(Je,{responseType:"arraybuffer"}),k=W(u.data),Z=await _.get(Qe,{responseType:"arraybuffer"}),j=W(Z.data),$=W(l.data);de(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-1e2e95f5.js").then(S=>S.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-1e2e95f5.js","assets/vendor-95b9cd9c.js","assets/index-652e1c3b.js","assets/index-ccf11cd4.css","assets/NotoSansDevanagari-VariableFont_wdth_wght-55fec1ff.css"]).then(async S=>{let H=S.default;const f=new H,D=$,ee=35,p=20;f.addImage(D,"PNG",15,9,ee,p),f.addFileToVFS("NotoSansBengali.ttf",k),f.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),f.setFont("NotoSansBengali"),f.addFileToVFS("NotoSansDevanagari.ttf",j),f.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),f.setFont("NotoSansDevanagari");const w=[[`${n("Sales")} ${n("of")} ${K(x,10)}`]];f.autoTable({startY:27,head:w,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const y=[[`${n("Period")}: ${a} ${n("to")} ${s}`]];f.autoTable({startY:36,head:y,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const m=h.map((g,B)=>[B+1,g.officeName,`₹ ${g.sales}`]),te=h.reduce((g,B)=>g+parseFloat(B.sales),0);m.push(["",n("Total"),`₹ ${te.toFixed(2)}`]);const De=[n("#"),n("Office Name"),n("Sales")],Be={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},Oe={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"},Te={0:5,1:25,2:25,3:25};f.autoTable(De,m,{startY:45,headStyles:Oe,columnStyles:Be,styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali"},columnWidth:"wrap",columnWidths:Te});const Ie=Date.now(),Pe=f.output("blob"),ce=new FormData;ce.append("file",Pe,`${Ie}sales_of_${x}_${a}_${s}.pdf`);try{const g=await _.post("http://115.124.120.251:5064/api/uploader",ce,{headers:{"Content-Type":"multipart/form-data"}});g.status==200?v.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):v.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const B=await g.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${B}`}catch(g){console.error("Error saving PDF file:",g)}})},Ne=e=>{if(e&&e.data&&e.dataIndex>=0&&h[e.dataIndex]){const a=h[e.dataIndex].officeId,s=h[e.dataIndex].officeType,r=h[e.dataIndex].officeName;s==="Company"?(z(!1),Q(t=>[...t,{selectedOffice:L,isAdmin:pe,selectedOfficeNameLocal:x}]),se(t=>[...t,ye]),P({state:!0,Ovalue:a}),G(r),O(r),T(a),I(6),V(a),re(!0),X(!0)):L!==a&&(P({state:!0,Ovalue:a}),O(r),T(a),I(0))}},ke=()=>{if(N.length>0){z(!1);const e=N.pop(),a=ne.pop();P({state:!0,Ovalue:a}),G(e.selectedOfficeNameLocal),O(e.selectedOfficeNameLocal),T(e.selectedOffice),V(a),I(e.isAdmin),Q([...N]),se([...ne]),N.length===0&&X(!1)}},je=()=>{z(!1),T(b.officeId),P({state:!0,Ovalue:b.officeId}),I(b.adminStatus),V(b.officeId),G(b.userOfficeName),O(b.userOfficeName),Q([]),re(!1),X(!1)};d.useEffect(()=>{q(!oe)},[oe]);const $e=()=>{E(!M)},R=e=>{if(!e)return"";const a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${s}-${a}`},K=(e,a)=>window.innerWidth>500||e.length<=a?e:e.substring(0,a)+"...";return o.jsxs("div",{className:`${i.chartContainer} ${c==="dark"?i.darkMode:i.lightMode}`,children:[o.jsx(Ye,{position:"top-center",theme:c}),o.jsx("div",{className:"container-fluid",children:o.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[o.jsxs("div",{className:`fw-bold noselect fs-${window.innerWidth<=768?7:5} ${c==="dark"?i.darkMode:i.lightMode}`,children:[n("Sales")," ",n("of")," ",K(x,10)]}),be?o.jsx("div",{title:"Reset",className:i.resetButtonContainer,children:o.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:je,children:o.jsx(ze,{style:{fontSize:"1rem"}})})}):null,xe&&N.length>0?o.jsx("div",{title:"Previous",className:i.resetButtonContainer,children:o.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ke,children:o.jsx(We,{style:{fontSize:"1rem"}})})}):null,o.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:U,children:o.jsxs("div",{className:`${i.iconsContainer} d-flex justify-content-center align-items-center`,children:[o.jsx("div",{className:`${i.icon} ${c==="dark"?i.darkMode:i.lightMode} px-2 py-1`,onClick:$e,children:M?o.jsx(Re,{style:{fontSize:"1.1rem"}}):o.jsx(He,{style:{fontSize:"1.1rem"}})}),M&&o.jsxs("div",{className:`${i.exportOptions} ${c==="dark"?i.darkMode:i.lightMode}`,ref:Y,children:[F?o.jsxs("div",{className:i.exportOption,onClick:()=>{q(!F),E(!1)},children:[o.jsx(Ae,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),o.jsx("span",{children:n("View Graph")})]}):o.jsxs("div",{className:i.exportOption,onClick:()=>{q(!F),E(!1)},children:[o.jsx(Le,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),o.jsx("span",{children:n("View Table")})]}),o.jsxs("div",{className:i.exportOption,onClick:Ce,children:[o.jsx(Ge,{style:{fontSize:"1.1rem",color:"green"}}),o.jsx("span",{children:n("Export to Excel")})]}),o.jsxs("div",{className:i.exportOption,onClick:Fe,children:[o.jsx(Ve,{style:{fontSize:"1.1rem",color:"red"}}),o.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),ae&&o.jsx("div",{className:i.NoDataOverlay,children:o.jsx("img",{src:qe,alt:"Loading...",width:50,height:50})}),J.length==1&&!F&&!ae?o.jsx("div",{className:`${i.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",F?o.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"342px"},children:o.jsxs("table",{className:`table ${c=="dark"?"table-dark":""}`,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",children:"#"}),o.jsx("th",{scope:"col",children:n("Office")}),o.jsxs("th",{scope:"col",children:[n("Sales"),"(₹)"]})]})}),o.jsx("tbody",{children:J.map((e,a)=>o.jsxs("tr",{children:[o.jsx("th",{scope:"row",children:J.length-1===a?"":a+1}),o.jsx("td",{children:e.officeName}),o.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):o.jsx(Ue,{option:ve,style:{height:"350px",width:"100%",maxWidth:"2300px"},onEvents:{click:Ne},className:c==="dark"?i.darkMode:i.lightMode})]})};export{Nt as default};
