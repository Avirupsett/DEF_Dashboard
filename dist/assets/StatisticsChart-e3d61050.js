import{_ as P}from"./index-51c5d04c.js";import{r as h,u as Q,y as Z,j as t,h as ee,z as te,A as ae,B as oe,C as ne,E as se,a as re}from"./vendor-841ab2dd.js";import{L as le,a as ie,E as ce,M as de,l as B,F as pe}from"./index-b6f93ad8.js";const fe="_chartContainer_1mphg_1",me="_lightMode_1mphg_47",he="_dateFilter_1mphg_51",xe="_officefilter_1mphg_207",ge="_topContainer_1mphg_299",ue="_darkMode_1mphg_319",be="_iconsContainer_1mphg_487",_e="_icon_1mphg_487",ye="_exportOptions_1mphg_571",Se="_exportOption_1mphg_571",Ce="_tableContainer_1mphg_825",we="_table_1mphg_825",Fe="_summaryHeader_1mphg_861",De="_periodHeader_1mphg_869",ve="_closeButton_1mphg_901",Ee="_tableWrapper_1mphg_931",ke="_loadingOverlay_1mphg_939",je="_NoDataOverlay_1mphg_963",Ne="_loadingSpinner_1mphg_991",Ie="_boldOption_1mphg_1003",Ae="_optionGroup_1mphg_1013",n={chartContainer:fe,lightMode:me,"label-text":"_label-text_1mphg_47",dateFilter:he,officefilter:xe,topContainer:ge,darkMode:ue,"theme-container":"_theme-container_1mphg_329",iconsContainer:be,icon:_e,exportOptions:ye,exportOption:Se,tableContainer:Ce,table:we,summaryHeader:Fe,periodHeader:De,closeButton:ve,tableWrapper:Ee,loadingOverlay:ke,NoDataOverlay:je,loadingSpinner:Ne,boldOption:Ie,optionGroup:Ae},Te=({selectedRange:f,themeMode:i,selectedOffice:j,isAdmin:H,alldata:z,isLoading:T})=>{const[d,G]=h.useState([]),[N,S]=h.useState(!1),I=h.useRef(null),A=h.useRef(null),[R,q]=h.useState(!0),[W,M]=h.useState([]),[u,E]=h.useState(!1),{t:a}=Q(),V=[{name:"requestedDate",label:a("Date")},{name:"sales",label:`${a("Sales")}(₹)`},{name:"expense",label:`${a("Expense")}(₹)`}],Y={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:a("Rows")}}};h.useEffect(()=>{const e=C(f[0]),s=C(f[1]);e&&s&&j&&(()=>{const m=z;if(Array.isArray(m.graph1)){const o=m.graph1.map(c=>({requestedDate:c.requestedDate,sales:c.totalIncome,expense:c.totalExpense}));let w=o.filter(c=>c.sales!==0||c.expense!==0);const b=o.reduce((c,x)=>c+x.sales,0).toFixed(2),_=o.reduce((c,x)=>c+x.expense,0).toFixed(2);w.push({requestedDate:a("Total"),sales:b,expense:_}),M(w),G(m.graph1)}})()},[f,j,H,z]);const L=(d.filter(e=>e.totalIncome>0).reduce((e,s)=>e+s.totalIncome,0)/d.filter(e=>e.totalIncome>0).length).toFixed(0);h.useEffect(()=>{if(f[0]&&f[1]){const e=new Date(f[0]),s=new Date(f[1]),l=Z(s,e)+1;q(l<=7)}},[f,j]);const U={color:["#66BA69","#E81A1A","#FFC107"],title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:function(e){for(var s=`<b>${a("Date")}:</b> `+e[0].name+"<br/>",l=0;l<e.length;l++)s+="<b>"+e[l].seriesName+":</b> "+e[l].value+"<br/>";return s},textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{top:window.innerWidth>550?0:270,data:[a("Sales"),a("Expense"),a("Average Sales")],textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?10:12}},grid:{left:window.innerWidth<=768?"7%":"4%",right:"3%",top:"10%",bottom:d.length>0?"15%":"20%",containLabel:d.length>0},xAxis:{type:"category",name:window.innerWidth>550?a("Date"):"",nameLocation:"middle",nameGap:35,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},boundaryGap:!0,data:d.map(e=>e.requestedDate),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000"}},yAxis:[{type:"value",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:42,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e4?e/1e3+"k":e},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"dashed"}}},{type:"value",show:!1},{type:"value",show:!1}],series:R?[{name:a("Sales"),type:"bar",data:d.map(e=>e.totalIncome),yAxisIndex:0},{name:a("Expense"),type:"bar",data:d.map(e=>e.totalExpense),yAxisIndex:0},{name:a("Average Sales"),type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:d.map(()=>L)}]:[{name:a("Sales"),type:"line",smooth:!0,data:d.map(e=>e.totalIncome),yAxisIndex:0},{name:a("Expense"),type:"line",smooth:!0,data:d.map(e=>e.totalExpense),yAxisIndex:0},{name:a("Average Sales"),type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:d.map(()=>L)}]},J=async()=>{const e=C(f[0]),s=C(f[1]),l=await P(()=>import("./exceljs.min-fcf8ece0.js").then(_=>_.e),["assets/exceljs.min-fcf8ece0.js","assets/vendor-841ab2dd.js"]),m=new l.Workbook,o=m.addWorksheet("Graph Data"),w=await re.get(B,{responseType:"blob"}),b=new FileReader;b.onload=function(){const _=b.result,c=m.addImage({base64:_,extension:"png"});o.addImage(c,{tl:{col:0,row:0},ext:{width:100,height:60}});const x=o.getCell("A1");x.value=a("Sales-Expense Summary"),x.font={bold:!0,color:{argb:"000000"},size:14},x.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:C1");const y=o.getCell("A2");y.value=`${a("Period")}: ${e} ${a("to")} ${s}`,y.font={bold:!0,color:{argb:"000000"},size:12},y.alignment={horizontal:"center"},o.mergeCells("A2:C2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const v=o.addRow([a("Date"),a("Sales"),a("Expense")]);v.font={bold:!0,color:{argb:"000000"},size:12,underline:!0},v.eachCell(r=>{r.font={bold:!0,color:{argb:"000000"},size:12},r.border={bottom:{style:"thin",color:{argb:"000000"}}}});const F=d.filter(r=>r.totalIncome!==0||r.totalExpense!==0);F.forEach(r=>{const g=o.addRow([r.requestedDate,Number(r.totalIncome),Number(r.totalExpense)]);g.getCell(2).numFmt="0.00",g.getCell(3).numFmt="0.00"});const D=o.addRow([a("Total"),"",""]);D.font={bold:!0,color:{argb:"000000"},size:12};const O=F.reduce((r,g)=>r+g.totalIncome,0),$=F.reduce((r,g)=>r+g.totalExpense,0),k=o.getCell(`B${D.number}`);k.value=`₹${O.toFixed(2)}`,k.alignment={horizontal:"right"};const p=o.getCell(`C${D.number}`);p.value=`₹${$.toFixed(2)}`,p.alignment={horizontal:"right"},m.xlsx.writeBuffer().then(r=>{const g=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});pe.saveAs(g,"sales-expense.xlsx")})},b.readAsDataURL(w.data)},X=()=>{const e=C(f[0]),s=C(f[1]);P(()=>import("./index-b6f93ad8.js").then(l=>l.j),["assets/index-b6f93ad8.js","assets/vendor-841ab2dd.js","assets/index-51c5d04c.js","assets/index-4da97eed.css"]).then(l=>{let m=l.default;const o=new m;o.setFontSize(12);const w=B,b=35,_=20;o.addImage(w,"PNG",15,9,b,_);const c=[["Sales-Expense Summary"]];o.autoTable({startY:27,head:c,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const x=[[`Period: ${e} to ${s}`]];o.autoTable({startY:36,head:x,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const y=d.filter(p=>p.totalIncome!==0||p.totalExpense!==0),v=y.map(p=>[p.requestedDate,p.totalIncome.toFixed(2),p.totalExpense.toFixed(2)]),F=y.reduce((p,r)=>p+r.totalIncome,0),D=y.reduce((p,r)=>p+r.totalExpense,0);(F!==0||D!==0)&&v.push(["Total",`${F.toFixed(2)}`,`${D.toFixed(2)}`]);const O=["Date","Sales","Expense"],$={1:{halign:"right"},2:{halign:"right"}},k={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};o.autoTable(O,v,{startY:45,headStyles:k,columnStyles:$}),o.save("sales-expense.pdf")})};h.useEffect(()=>{const e=s=>{I.current&&!I.current.contains(s.target)&&A.current&&!A.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&S(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const K=()=>{S(!N)},C=e=>{if(!e)return"";const s=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),m=String(e.getDate()).padStart(2,"0");return`${s}-${l}-${m}`};return t.jsxs("div",{className:`${n.chartContainer} ${i==="dark"?n.darkMode:n.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-5 ${i==="dark"?n.darkMode:n.lightMode}`,children:a("Sales-Expense")}),t.jsx("button",{onClick:()=>{E(!u),S(!1)},className:"btn btn-primary btn-sm",children:"Table"}),t.jsx("a",{href:"javascript:void(0)",className:"btn btn-primary btn-sm",onClick:()=>{E(!u),S(!1)},children:"Graph"}),t.jsx("div",{className:"d-flex g-0",ref:I,children:t.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${n.icon} ${i==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:K,children:N?t.jsx(ee,{style:{fontSize:"1.1rem"}}):t.jsx(te,{style:{fontSize:"1.1rem"}})}),N&&t.jsxs("div",{className:`${n.exportOptions} ${i==="dark"?n.darkMode:n.lightMode}`,ref:A,children:[u?t.jsxs("div",{className:n.exportOption,onClick:()=>{E(!u),S(!1)},children:[t.jsx(oe,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:a("View Graph")})]}):t.jsxs("div",{className:n.exportOption,onClick:()=>{E(!u),S(!1)},children:[t.jsx(ae,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:a("View Table")})]}),t.jsxs("div",{className:n.exportOption,onClick:J,children:[t.jsx(ne,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:a("Export to Excel")})]}),t.jsxs("div",{className:n.exportOption,onClick:X,children:[t.jsx(se,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:a("Export to PDF")})]})]})]})})]})}),T&&t.jsx("div",{className:n.NoDataOverlay,children:t.jsx(le,{animationData:ie,loop:!0})}),W.length==1&&!u&&!T?t.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:a("No Data Found")}):"",u?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(de,{data:W,columns:V,options:Y})}):t.jsx(ce,{option:U,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:i==="dark"?n.darkMode:n.lightMode})]})};export{Te as default};
