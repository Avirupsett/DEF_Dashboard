import{_ as U}from"./index-fd6a7c6d.js";import{r as d,u as le,j as e}from"./vendor-36ea1262.js";import{H as re,n as ie,w as ce,x as de,y as he,z as pe,A as fe,i as N}from"./index.esm-39a9cba4.js";import{l as ue}from"./ReactToastify-c5df916d.js";import{Q as x,l as V,f as ge,a as me}from"./NotoSansDevanagari-VariableFont_wdth_wght-47b406a6.js";import"./jspdf.es.min-1b2a50b8.js";import"./Dashboard-36456d17.js";import"./install-b5fa7292.js";import"./assertThisInitialized-a147f0d7.js";const _e="_piechart_16h7l_5",xe="_chartContainer_16h7l_19",ye="_legendButtonContainer_16h7l_47",be="_legendButton_16h7l_47",Ce="_codeBlockIcon_16h7l_131",we="_lightMode_16h7l_193",De="_dateFilter_16h7l_203",ve="_officefilter_16h7l_361",Fe="_topContainer_16h7l_453",Se="_darkMode_16h7l_473",je="_iconsContainer_16h7l_641",ke="_icon_16h7l_641",Ne="_exportOptions_16h7l_733",Oe="_exportOption_16h7l_733",$e="_NoDataOverlay_16h7l_883",Be="_tableContainer_16h7l_1019",Te="_table_16h7l_1019",Ee="_summaryHeader_16h7l_1055",Le="_periodHeader_16h7l_1063",ze="_closeButton_16h7l_1095",Ie="_tableWrapper_16h7l_1125",Pe="_loadingOverlay_16h7l_1133",Ae="_loadingSpinner_16h7l_1159",Re="_boldOption_16h7l_1171",He="_optionGroup_16h7l_1181",a={piechart:_e,chartContainer:xe,"legend-text":"_legend-text_16h7l_27",legendButtonContainer:ye,legendButton:be,codeBlockIcon:Ce,lightMode:we,"label-text":"_label-text_16h7l_193",dateFilter:De,officefilter:ve,topContainer:Fe,darkMode:Se,"theme-container":"_theme-container_16h7l_483",iconsContainer:je,icon:ke,exportOptions:Ne,exportOption:Oe,NoDataOverlay:$e,tableContainer:Be,table:Te,summaryHeader:Ee,periodHeader:Le,closeButton:ze,tableWrapper:Ie,loadingOverlay:Pe,loadingSpinner:Ae,boldOption:Re,optionGroup:He},lt=({echarts:Me,ReactECharts:G,themeMode:g,selectedRange:F,selectedOffice:qe,showGraph:P,isAdmin:We,alldata:Ue,officeName:A,isLoading:R,setSelectedRange:Ve,isDateRangeActive:Ge,setIsDateRangeActive:Ye,deliveryData:f})=>{const[Y,Je]=d.useState([]),[O,y]=d.useState(!1),$=d.useRef(null),B=d.useRef(null),T=d.useRef(null),{t:n}=le(),[H,E]=d.useState(!1);d.useState([]);const[b,S]=d.useState(!1);d.useEffect(()=>{}),d.useEffect(()=>{S(!P)},[P]);const J={tooltip:{trigger:"axis"},xAxis:{type:"time",axisLabel:{rotate:window.innerWidth<768?45:0,hideOverlap:!0,formatter:"{d} {MMM}",color:g==="dark"?"#ffffff":"#000000"},axisPointer:{label:{formatter:function(t){let o=new Date(t.value);return C(o)}}}},yAxis:{type:"value",name:"Total Deliveries"},series:[{name:"Total Deliveries",type:"line",data:f?f.map(t=>[new Date(t.requestedDate),t.totalDeliveries]):[]}]},M=t=>{let o="";const h=new Uint8Array(t),m=h.byteLength;for(let r=0;r<m;r++)o+=String.fromCharCode(h[r]);return window.btoa(o)},C=t=>{if(!t)return"";let o=new Date(t);const h=o.getFullYear(),m=String(o.getMonth()+1).padStart(2,"0");return`${String(o.getDate()).padStart(2,"0")}-${m}-${h}`};d.useEffect(()=>{const t=o=>{$.current&&!$.current.contains(o.target)&&B.current&&!B.current.contains(o.target)&&o.target.tagName!=="svg"&&o.target.tagName!=="path"&&y(!1),T.current&&!T.current.contains(o.target)&&E(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]);const Q=()=>{E(!1),y(!O)},X=async()=>{const t=x.loading("Please wait..."),o=C(F[0]),h=C(F[1]),m=await U(()=>import("./exceljs.min-6ae529e9.js").then(u=>u.e),["assets/exceljs.min-6ae529e9.js","assets/vendor-36ea1262.js"]),r=new m.Workbook,l=r.addWorksheet("Data");fetch(V).then(u=>u.blob()).then(async u=>{const w=new FileReader;w.onload=async function(){const L=w.result,D=r.addImage({base64:L,extension:"png"});l.addImage(D,{tl:{col:0,row:0},ext:{width:100,height:60}});const v=l.getCell("A1");v.value=`${n("Delivery Trend")}`,v.font={bold:!0,color:{argb:"000000"},size:14},v.alignment={vertical:"middle",horizontal:"center"},l.mergeCells("A1:D1");const s=l.getCell("A2");s.value=`${n("Period")}: ${o} ${n("to")} ${h}`,s.font={bold:!0,color:{argb:"000000"},size:12},s.alignment={horizontal:"center"},l.mergeCells("A2:D2"),l.getColumn(1).width=15,l.getColumn(2).width=50,l.getColumn(3).width=15,l.getColumn(4).width=15;const j=l.addRow([n("#"),n("Date"),n("Total Deliveries")]);j.font={bold:!0,color:{argb:"000000"},size:12},j.eachCell(i=>{i.font={bold:!0,color:{argb:"000000"},size:12},i.border={bottom:{style:"thin",color:{argb:"000000"}}}}),f.forEach((i,_)=>{if(i.totalDeliveries>0){const c=l.addRow([_+1,i.requestedDate,i.totalDeliveries]);c.getCell(1).alignment={horizontal:"left"},c.getCell(2).alignment={horizontal:"left"},c.getCell(3).alignment={horizontal:"right"},c.getCell(4).alignment={horizontal:"right"}}});const k=`${Date.now()}Total_Deliveries_${A}_${o}_${h}.xlsx`;r.xlsx.writeBuffer().then(async i=>{const _=new FormData;_.append("file",new Blob([i]),k);try{const c=await N.post("http://115.124.120.251:5064/api/uploader",_,{headers:{"Content-Type":"multipart/form-data"}});c.status==200?x.update(t,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):x.update(t,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const z=c.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${z}`}catch(c){console.error("Error saving Excel file:",c)}})},w.readAsDataURL(u)})},K=async()=>{const t=x.loading("Please wait..."),o=C(F[0]),h=C(F[1]),r=new URLSearchParams(window.location.search).get("lang"),l=await N.get(ge,{responseType:"arraybuffer"}),u=M(l.data),w=await N.get(me,{responseType:"arraybuffer"}),L=M(w.data);U(()=>import("./jspdf.es.min-1b2a50b8.js").then(D=>D.j),["assets/jspdf.es.min-1b2a50b8.js","assets/index-fd6a7c6d.js","assets/vendor-36ea1262.js","assets/index-ce24f766.css","assets/Dashboard-36456d17.js","assets/index.esm-39a9cba4.js","assets/install-b5fa7292.js","assets/assertThisInitialized-a147f0d7.js","assets/Dashboard-5c3f3713.css"]).then(async D=>{let v=D.default;const s=new v;s.addFileToVFS("NotoSansBengali.ttf",u),s.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),s.setFont("NotoSansBengali"),s.addFileToVFS("NotoSansDevanagari.ttf",L),s.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),s.setFont("NotoSansDevanagari");const j=[[n("#"),n("Date"),n("Total Deliveries")]],q={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"},3:{halign:"center"}},k={fontSize:12,fontStyle:"bold",halign:"center"},i={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},_=V,c=35,z=20;s.addImage(_,"PNG",15,12,c,z);const ee=[[`${n("Delivery Trend")}`]];s.autoTable({head:ee,body:[],headStyles:{...k,fillColor:i.summaryHeader,textColor:"#FFFFFF"},margin:{top:30},styles:{font:r==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const te=[[`${n("Period")}: ${o} ${n("to")} ${h}`]];s.autoTable({startY:39.5,head:te,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:r==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});let oe=f.map((p,I)=>{if(p.totalDeliveries>0)return[I+1,p.requestedDate,p.totalDeliveries]});const ae={startY:s.autoTable.previous.finalY+1,head:j,body:oe,headStyles:{...k,fillColor:i.secondHeader,textColor:"#FFFFFF"},columnStyles:q,styles:{font:r==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}};s.autoTable(ae);const ne=`${Date.now()}delivery_trend_${A}_${o}_${h}.pdf`,se=s.output("blob"),W=new FormData;W.append("file",se,ne);try{const p=await N.post("http://115.124.120.251:5064/api/uploader",W,{headers:{"Content-Type":"multipart/form-data"}});p.status==200?x.update(t,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):x.update(t,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const I=await p.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${I}`}catch(p){console.error("Error saving PDF file:",p)}})};re({typography:{button:{textTransform:"none"}}});const Z=()=>{E(!H),y(!1),S(!1)};return e.jsx(e.Fragment,{children:e.jsxs("div",{ref:T,className:`${a.chartContainer} ${g==="dark"?a.darkMode:a.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsx("button",{className:a.legendButton,onClick:Z,children:e.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:a.codeBlockIcon,title:"Legends",style:{filter:H?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})}),e.jsx("div",{className:`fw-bold noselect me-2 fs-${window.innerWidth<=768?7:5} ${g==="dark"?a.darkMode:a.lightMode}`,children:n("Delivery Trend")}),e.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:$,children:e.jsxs("div",{className:`${a.iconsContainer} d-flex justify-content-center align-items-center`,children:[e.jsx("div",{className:`${a.icon} ${g==="dark"?a.darkMode:a.lightMode} px-2 py-1`,onClick:Q,children:O?e.jsx(ie,{style:{fontSize:"1.1rem"}}):e.jsx(ce,{style:{fontSize:"1.1rem"}})}),O&&e.jsxs("div",{className:`${a.exportOptions} ${g==="dark"?a.darkMode:a.lightMode}`,ref:B,children:[b?e.jsxs("div",{className:a.exportOption,onClick:()=>{S(!b),y(!1)},children:[e.jsx(he,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),e.jsx("span",{children:n("View Graph")})]}):e.jsxs("div",{className:a.exportOption,onClick:()=>{S(!b),y(!1)},children:[e.jsx(de,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:n("View Table")})]}),e.jsxs("div",{className:a.exportOption,onClick:X,children:[e.jsx(pe,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:n("Export to Excel")})]}),e.jsxs("div",{className:a.exportOption,onClick:K,children:[e.jsx(fe,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),R&&e.jsx("div",{className:a.loadingOverlay,children:e.jsx("img",{src:ue,alt:"Loading...",width:50,height:50})}),f&&f.length==0&&!b&&!R?e.jsx("div",{className:`${a.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",b?e.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"333px"},children:e.jsxs("table",{className:`table  ${g=="dark"?"table-dark":""}`,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"#"}),e.jsx("th",{scope:"col",children:n("Date")}),e.jsx("th",{scope:"col",children:n("Deliveries")})]})}),e.jsx("tbody",{children:f.map((t,o)=>e.jsxs("tr",{children:[e.jsx("th",{scope:"row",children:o+1}),e.jsx("td",{children:t.requestedDate}),e.jsx("td",{children:t.totalDeliveries})]},`${t.requestedDate}`))})]})}):e.jsx(G,{option:J,style:{height:"341px",width:"100%",maxWidth:"2300px"},className:a.piechart},Y.length)]})})};export{lt as default};
