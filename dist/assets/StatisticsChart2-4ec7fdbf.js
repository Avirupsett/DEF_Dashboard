import{_ as we}from"./index-4d89e49a.js";import{I as G,r as w,u as Le,j as t,J as Pe,K as We,i as ze,B as Ie,C as Ae,L as He,G as Ue,H as Ge,a as L}from"./vendor-d2d59fe7.js";import{R as Me}from"./index-ac977246.js";import{k as Ve,l as qe,Q as P,a as ye,f as Ye,b as Xe}from"./NotoSansDevanagari-VariableFont_wdth_wght-67bc695a.js";const Je="_chartContainer_ew0vy_1",Ke="_lightMode_ew0vy_47",Qe="_dateFilter_ew0vy_51",Ze="_officefilter_ew0vy_207",et="_topContainer_ew0vy_299",tt="_darkMode_ew0vy_319",ot="_iconsContainer_ew0vy_487",nt="_icon_ew0vy_487",at="_exportOptions_ew0vy_571",st="_exportOption_ew0vy_571",rt="_NoDataOverlay_ew0vy_659",it="_tableContainer_ew0vy_849",lt="_table_ew0vy_849",ct="_summaryHeader_ew0vy_885",dt="_periodHeader_ew0vy_893",ft="_closeButton_ew0vy_925",pt="_tableWrapper_ew0vy_955",ut="_loadingOverlay_ew0vy_963",ht="_loadingSpinner_ew0vy_989",wt="_boldOption_ew0vy_1001",yt="_optionGroup_ew0vy_1011",mt="_resetButtonContainer_ew0vy_1039",gt="_resetButton_ew0vy_1039",l={chartContainer:Je,lightMode:Ke,"label-text":"_label-text_ew0vy_47",dateFilter:Qe,officefilter:Ze,topContainer:et,darkMode:tt,"theme-container":"_theme-container_ew0vy_329",iconsContainer:ot,icon:nt,exportOptions:at,exportOption:st,NoDataOverlay:rt,tableContainer:it,table:lt,summaryHeader:ct,periodHeader:dt,closeButton:ft,tableWrapper:pt,loadingOverlay:ut,loadingSpinner:ht,boldOption:wt,optionGroup:yt,resetButtonContainer:mt,resetButton:gt};var xt={exports:{}};(function(d,D){(function(B,F){F()})(G,function(){function B(a,s){return typeof s>"u"?s={autoBom:!1}:typeof s!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function F(a,s,u){var i=new XMLHttpRequest;i.open("GET",a),i.responseType="blob",i.onload=function(){x(i.response,s,u)},i.onerror=function(){console.error("could not download file")},i.send()}function T(a){var s=new XMLHttpRequest;s.open("HEAD",a,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function j(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(s)}}var g=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof G=="object"&&G.global===G?G:void 0,E=g.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),x=g.saveAs||(typeof window!="object"||window!==g?function(){}:"download"in HTMLAnchorElement.prototype&&!E?function(a,s,u){var i=g.URL||g.webkitURL,h=document.createElement("a");s=s||a.name||"download",h.download=s,h.rel="noopener",typeof a=="string"?(h.href=a,h.origin===location.origin?j(h):T(h.href)?F(a,s,u):j(h,h.target="_blank")):(h.href=i.createObjectURL(a),setTimeout(function(){i.revokeObjectURL(h.href)},4e4),setTimeout(function(){j(h)},0))}:"msSaveOrOpenBlob"in navigator?function(a,s,u){if(s=s||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(B(a,u),s);else if(T(a))F(a,s,u);else{var i=document.createElement("a");i.href=a,i.target="_blank",setTimeout(function(){j(i)})}}:function(a,s,u,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof a=="string")return F(a,s,u);var h=a.type==="application/octet-stream",K=/constructor/i.test(g.HTMLElement)||g.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||h&&K||E)&&typeof FileReader<"u"){var k=new FileReader;k.onloadend=function(){var f=k.result;f=v?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=f:location=f,i=null},k.readAsDataURL(a)}else{var M=g.URL||g.webkitURL,S=M.createObjectURL(a);i?i.location=S:location.href=S,i=null,setTimeout(function(){M.revokeObjectURL(S)},4e4)}});g.saveAs=x.saveAs=x,d.exports=x})})(xt);const Ft=({themeMode:d,selectedRange:D,selectedOffice:B,isAdmin:F,alldata:T,isLoading:j,SelectedOfficeName:g,setSelectedOfficeName:E,selectedOfficeNameLocal:x,setSelectedOfficeNameLocal:a,setSelectedOffice:s,setIsAdmin:u,setCompanies:i,setWholesales:h,setRetails:K,originallist:v,setOfficeIdLocal:k,officeIdLocal:M,setOptionvalue:S})=>{const[f,me]=w.useState([]),[Q,V]=w.useState(!1),Z=w.useRef(null),ee=w.useRef(null),[W,ce]=w.useState(!1),[te,ge]=w.useState([]),[z,oe]=w.useState([]),[de,fe]=w.useState([]),[xe,ne]=w.useState(!1),[be,pe]=w.useState(!1),[ve,q]=w.useState(!0),[bt,_e]=w.useState([]),{t:r}=Le();r("Office"),`${r("Sales")}`,r("Rows"),w.useEffect(()=>{const e=o=>{Z.current&&!Z.current.contains(o.target)&&ee.current&&!ee.current.contains(o.target)&&o.target.tagName!=="svg"&&o.target.tagName!=="path"&&V(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const ue=e=>{let o=[],p=[];if(T.graph3){T.graph3.map(n=>{o.push({officeId:n.officeId,officeName:n.officeName,officeType:n.officeType,sales:n.totalIncome.toFixed(2),color:n.officeTypeColor}),p.push({officeName:n.officeName,sales:n.totalIncome.toFixed(2)})}),p.push({officeName:"Total",sales:o.reduce((n,c)=>n+parseFloat(c.sales),0).toFixed(2)}),e===1&&(i(o.filter(n=>n.officeType==="Company")),h(o.filter(n=>n.officeType==="Wholesale Pumps")),K(o.filter(n=>n.officeType==="Retail Pumps")),q(!0));const b=o.reduce((n,c)=>{const{officeType:N}=c;return n[N]||(n[N]=[]),n[N].push(c),n},{});me(o),_e(b),ge(p)}};w.useEffect(()=>{D&&B&&ue(ve?0:1)},[T]);const Se={title:{textStyle:{color:d==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${r("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameGap:80,nameTextStyle:{color:d==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:d==="dark"?"#ffffff":"#000000"}},axisLabel:{color:d==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?r("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:d==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:d==="dark"?"#ffffff":"#000000"}},axisLabel:{color:d==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:d==="dark"?"grey":"silver",type:"line"}}},legend:{show:!0},series:[{type:"bar",barWidth:"30%",itemStyle:{borderRadius:[0,5,5,0]},data:f.map((e,o)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:!0,position:"right",color:d==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},Y=e=>{let o="";const p=new Uint8Array(e),b=p.byteLength;for(let n=0;n<b;n++)o+=String.fromCharCode(p[n]);return window.btoa(o)},Ce=async()=>{const e=P.loading("Please wait..."),o=X(D[0]),p=X(D[1]),b=await we(()=>import("./exceljs.min-e7e785f7.js").then(m=>m.e),["assets/exceljs.min-e7e785f7.js","assets/vendor-d2d59fe7.js"]),n=new b.Workbook,c=n.addWorksheet("Total Sales by Office"),N=await L.get(ye,{responseType:"arraybuffer"}),se=Y(N.data),re=n.addImage({base64:se,extension:"png"});c.addImage(re,{tl:{col:0,row:0},ext:{width:100,height:60}});const I=c.getCell("A1");I.value=`${r("Sales")} ${r("of")} ${ae(x,10)}`,I.font={bold:!0,color:{argb:"000000"},size:14},I.alignment={vertical:"middle",horizontal:"center"},c.mergeCells("A1:C1");const A=c.getCell("A2");A.value=`${r("Period")}: ${o} ${r("to")} ${p}`,A.font={bold:!0,color:{argb:"000000"},size:12},A.alignment={horizontal:"center"},c.mergeCells("A2:C2"),c.getColumn(1).width=15,c.getColumn(2).width=50,c.getColumn(3).width=15;const R=c.addRow([r("#"),r("Office Name"),r("Sales")]);R.font={bold:!0},R.eachCell(m=>{m.font={bold:!0,color:{argb:"000000"},size:12},m.border={bottom:{style:"thin",color:{argb:"000000"}}}}),f.forEach((m,$)=>{const C=c.addRow([$+1,m.officeName,m.sales]);C.getCell(1).alignment={horizontal:"left"},C.getCell(2).alignment={horizontal:"left"},C.getCell(3).alignment={horizontal:"right"}});const J=c.addRow(["",r("Total"),""]);J.font={bold:!0,color:{argb:"000000"},size:12};const y=f.reduce((m,$)=>m+parseFloat($.sales),0),H=c.getCell(`C${J.number}`);H.value=`â‚¹ ${y}`,H.numFmt="0.00",H.alignment={horizontal:"right"};const ie=Date.now();n.xlsx.writeBuffer().then(async m=>{const $=new Blob([m],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=new FormData;C.append("file",$,`${ie}sales_of_${x}_${o}_${p}.xlsx`);try{const O=await L.post("http://115.124.120.251:5064/api/uploader",C,{headers:{"Content-Type":"multipart/form-data"}});O.status==200?P.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):P.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const le=O.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${le}`}catch(O){console.error("Error saving Excel file:",O)}})},Fe=async()=>{const e=P.loading("Please wait..."),o=X(D[0]),p=X(D[1]),n=new URLSearchParams(window.location.search).get("lang"),c=await L.get(ye,{responseType:"arraybuffer"}),N=await L.get(Ye,{responseType:"arraybuffer"}),se=Y(N.data),re=await L.get(Xe,{responseType:"arraybuffer"}),I=Y(re.data),A=Y(c.data);we(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-67bc695a.js").then(R=>R.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-67bc695a.js","assets/vendor-d2d59fe7.js","assets/index-4d89e49a.js","assets/index-0090fde3.css","assets/NotoSansDevanagari-VariableFont_wdth_wght-55fec1ff.css"]).then(async R=>{let J=R.default;const y=new J,H=A,ie=35,m=20;y.addImage(H,"PNG",15,9,ie,m),y.addFileToVFS("NotoSansBengali.ttf",se),y.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),y.setFont("NotoSansBengali"),y.addFileToVFS("NotoSansDevanagari.ttf",I),y.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),y.setFont("NotoSansDevanagari");const $=[[`${r("Sales")} ${r("of")} ${ae(x,10)}`]];y.autoTable({startY:27,head:$,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:n==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const C=[[`${r("Period")}: ${o} ${r("to")} ${p}`]];y.autoTable({startY:36,head:C,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:n==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const O=f.map((_,U)=>[U+1,_.officeName,`â‚¹ ${_.sales}`]),le=f.reduce((_,U)=>_+parseFloat(U.sales),0);O.push(["",r("Total"),`â‚¹ ${le.toFixed(2)}`]);const Oe=[r("#"),r("Office Name"),r("Sales")],De={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},Be={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"},Te={0:5,1:25,2:25,3:25};y.autoTable(Oe,O,{startY:45,headStyles:Be,columnStyles:De,styles:{font:n==="hi"?"NotoSansDevanagari":"NotoSansBengali"},columnWidth:"wrap",columnWidths:Te});const Ee=Date.now(),Re=y.output("blob"),he=new FormData;he.append("file",Re,`${Ee}sales_of_${x}_${o}_${p}.pdf`);try{const _=await L.post("http://115.124.120.251:5064/api/uploader",he,{headers:{"Content-Type":"multipart/form-data"}});_.status==200?P.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):P.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const U=await _.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${U}`}catch(_){console.error("Error saving PDF file:",_)}})},je=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const o=f[e.dataIndex].officeId,p=f[e.dataIndex].officeType,b=f[e.dataIndex].officeName;p==="Company"?(q(!1),oe(n=>[...n,{selectedOffice:B,isAdmin:F,selectedOfficeNameLocal:x}]),fe(n=>[...n,M]),S({state:!0,Ovalue:o}),E(b),a(b),s(o),u(6),k(o),pe(!0),ne(!0)):B!==o&&(S({state:!0,Ovalue:o}),a(b),s(o),u(0))}},ke=()=>{if(z.length>0){q(!1);const e=z.pop(),o=de.pop();S({state:!0,Ovalue:o}),E(e.selectedOfficeNameLocal),a(e.selectedOfficeNameLocal),s(e.selectedOffice),k(o),u(e.isAdmin),oe([...z]),fe([...de]),z.length===0&&ne(!1)}},Ne=()=>{q(!1),s(v.officeId),S({state:!0,Ovalue:v.officeId}),u(v.adminStatus),k(v.officeId),E(v.userOfficeName),a(v.userOfficeName),oe([]),pe(!1),ne(!1)},$e=()=>{V(!Q)},X=e=>{if(!e)return"";const o=e.getFullYear(),p=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${p}-${o}`},ae=(e,o)=>window.innerWidth>500||e.length<=o?e:e.substring(0,o)+"...";return t.jsxs("div",{className:`${l.chartContainer} ${d==="dark"?l.darkMode:l.lightMode}`,children:[t.jsx(Ve,{position:"top-center",theme:d}),t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsxs("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${d==="dark"?l.darkMode:l.lightMode}`,children:[r("Sales")," ",r("of")," ",ae(x,10)]}),be?t.jsx("div",{title:"Reset",className:l.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:Ne,children:t.jsx(Pe,{style:{fontSize:"1rem"}})})}):null,xe&&z.length>0?t.jsx("div",{title:"Previous",className:l.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ke,children:t.jsx(We,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:Z,children:t.jsxs("div",{className:`${l.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${l.icon} ${d==="dark"?l.darkMode:l.lightMode} px-2 py-1`,onClick:$e,children:Q?t.jsx(ze,{style:{fontSize:"1.1rem"}}):t.jsx(Ie,{style:{fontSize:"1.1rem"}})}),Q&&t.jsxs("div",{className:`${l.exportOptions} ${d==="dark"?l.darkMode:l.lightMode}`,ref:ee,children:[W?t.jsxs("div",{className:l.exportOption,onClick:()=>{ce(!W),V(!1)},children:[t.jsx(He,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:r("View Graph")})]}):t.jsxs("div",{className:l.exportOption,onClick:()=>{ce(!W),V(!1)},children:[t.jsx(Ae,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:r("View Table")})]}),t.jsxs("div",{className:l.exportOption,onClick:Ce,children:[t.jsx(Ue,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:r("Export to Excel")})]}),t.jsxs("div",{className:l.exportOption,onClick:Fe,children:[t.jsx(Ge,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:r("Export to PDF")})]})]})]})})]})}),j&&t.jsx("div",{className:l.NoDataOverlay,children:t.jsx("img",{src:qe,alt:"Loading...",width:50,height:50})}),te.length==1&&!W&&!j?t.jsx("div",{className:`${l.NoDataOverlay} fs-5`,children:r("No Data Found")}):"",W?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"342px"},children:t.jsxs("table",{className:`table ${d=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:r("Office")}),t.jsxs("th",{scope:"col",children:[r("Sales"),"(â‚¹)"]})]})}),t.jsx("tbody",{children:te.map((e,o)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:te.length-1===o?"":o+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx(Me,{option:Se,style:{height:"350px",width:"100%",maxWidth:"2300px"},onEvents:{click:je},className:d==="dark"?l.darkMode:l.lightMode})]})};export{Ft as default};
