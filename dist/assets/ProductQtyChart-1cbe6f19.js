import{_ as T}from"./index-0bab7b9d.js";import{r as c,l as J,j as t,g as X,w as K,x as Z,E as tt,z as et,A as ot,C as at}from"./vendor-770ffdd0.js";import{E as nt,M as rt,l as H,F as st}from"./index-82263592.js";const lt="_piechart_5qi71_11",it="_chartContainer_5qi71_23",ct="_legendButtonContainer_5qi71_49",dt="_legendButton_5qi71_49",pt="_codeBlockIcon_5qi71_133",ut="_lightMode_5qi71_191",ft="_dateFilter_5qi71_195",ht="_officefilter_5qi71_351",gt="_topContainer_5qi71_443",_t="_darkMode_5qi71_463",mt="_iconsContainer_5qi71_631",xt="_icon_5qi71_631",bt="_exportOptions_5qi71_715",yt="_exportOption_5qi71_715",Ct="_tableContainer_5qi71_975",St="_table_5qi71_975",wt="_summaryHeader_5qi71_1011",kt="_periodHeader_5qi71_1019",Ft="_closeButton_5qi71_1051",jt="_tableWrapper_5qi71_1081",vt="_loadingOverlay_5qi71_1089",Nt="_loadingSpinner_5qi71_1115",qt="_boldOption_5qi71_1127",Pt="_optionGroup_5qi71_1137",e={piechart:lt,chartContainer:it,"legend-text":"_legend-text_5qi71_31",legendButtonContainer:ct,legendButton:dt,codeBlockIcon:pt,lightMode:ut,"label-text":"_label-text_5qi71_191",dateFilter:ft,officefilter:ht,topContainer:gt,darkMode:_t,"theme-container":"_theme-container_5qi71_473",iconsContainer:mt,icon:xt,exportOptions:bt,exportOption:yt,tableContainer:Ct,table:St,summaryHeader:wt,periodHeader:kt,closeButton:Ft,tableWrapper:jt,loadingOverlay:vt,loadingSpinner:Nt,boldOption:qt,optionGroup:Pt},Ot=({themeMode:m,selectedRange:x,selectedOffice:O,isAdmin:B})=>{const[b,W]=c.useState([]),[F,C]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),N=c.useRef(null),[q,P]=c.useState(!1),[I,R]=c.useState([]),[S,$]=c.useState(!1),[L,z]=c.useState(!1),Q=[{name:"Product Name",label:"Product"},{name:"Quantity",label:"Quantity"},{name:"Sales",label:"Sales(₹)"}],M={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"229px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};c.useEffect(()=>{z(!0);const a=y(x[0]),l=y(x[1]);J.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${a}/${l}/${O}/${B}`).then(d=>{const o=d.data.graph2;let r={},g={},f={},_={};if(o.forEach(p=>{const{lstproduct:u}=p;u.forEach(n=>{let{productName:i,totalSales:s,color:E,qty:w,unitShortName:D}=n;s!==0&&(r[i]?(r[i]+=s,f[i]+=w):(r[i]=s,g[i]=E,f[i]=w,_[i]=D))})}),r){let p=[],u=[];for(let n in r)p.push({productName:n,totalSale:r[n],color:g[n],totalQty:f[n],unit:_[n]}),u.push({"Product Name":n,Sales:r[n],Quantity:`${f[n]} ${_[n]}`});R(u),W(p)}}).catch(d=>{}).finally(()=>{z(!1)})},[x,O,B]);const A=()=>{b.length>0&&P(!q),C(!1),$(!1)},G={tooltip:{trigger:"item",formatter:"<b>{b}</b><br><b>Total Qty:</b> {c}",textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:m==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:q,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:m==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"top",style:{fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Qty",type:"pie",radius:["35%","70%"],center:["50%","50%"],roseType:"radius",selectedMode:"single",avoidLabelOverlap:!0,label:{show:b.length<=5,color:m==="dark"?"#ffffff":"#111111"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:b.length>0?b.map((a,l)=>({value:a.totalQty,name:a.productName,itemStyle:{color:a.color}})):[],itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},Y=async()=>{const a=y(x[0]),l=y(x[1]),d=await T(()=>import("./exceljs.min-d8450118.js").then(r=>r.e),["assets/exceljs.min-d8450118.js","assets/vendor-770ffdd0.js"]),h=new d.Workbook,o=h.addWorksheet("Data");fetch(H).then(r=>r.blob()).then(r=>{const g=new FileReader;g.onload=function(){const f=g.result,_=h.addImage({base64:f,extension:"png"});o.addImage(_,{tl:{col:0,row:0},ext:{width:100,height:70}});const p=o.getCell("A2");p.value="Product Wise Summary Data",p.font={bold:!0,color:{argb:"000000"},size:14},p.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A2:C2");const u=o.getCell("A3");u.value=`Period: ${a} to ${l}`,u.font={bold:!0,color:{argb:"000000"},size:12},u.alignment={horizontal:"center"},o.mergeCells("A3:C3"),o.getColumn(1).width=50,o.getColumn(2).width=15;const n=o.addRow(["Product Name","Quantity","Total Sale"]);n.font={bold:!0,color:{argb:"000000"},size:12},n.eachCell(s=>{s.font={bold:!0,color:{argb:"000000"},size:12},s.border={bottom:{style:"thin",color:{argb:"000000"}}}}),b.forEach(s=>{o.addRow([s.productName,`${s.totalQty} ${s.unit}`,`₹${s.totalSale}`])});const i=`product_wise_summary_data_${Date.now()}.xlsx`;h.xlsx.writeBuffer().then(s=>{st.saveAs(new Blob([s]),i)})},g.readAsDataURL(r)})},y=a=>{if(!a)return"";const l=a.getFullYear(),d=String(a.getMonth()+1).padStart(2,"0"),h=String(a.getDate()).padStart(2,"0");return`${l}-${d}-${h}`},U=async()=>{const a=y(x[0]),l=y(x[1]);T(()=>import("./index-82263592.js").then(d=>d.j),["assets/index-82263592.js","assets/vendor-770ffdd0.js","assets/index-0bab7b9d.js","assets/index-7b634162.css"]).then(d=>{let h=d.default;const o=new h,r=[["Product Name","Quantity","Total Sale"]],g={1:{halign:"right"},2:{halign:"right"}},f={fontSize:12,fontStyle:"bold",halign:"center"},_={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},p=H,u=35,n=20;o.addImage(p,"PNG",15,12,u,n);const i=[["Product Wise Summary Data"]];o.autoTable({head:i,body:[],headStyles:{...f,fillColor:_.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const s=[[`Period: ${a} to ${l}`]];o.autoTable({startY:39.5,head:s,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const E=b.map(k=>[k.productName,`${k.totalQty} ${k.unit}`,k.totalSale.toFixed(2)]),w={startY:o.autoTable.previous.finalY+1,head:r,body:E,headStyles:{...f,fillColor:_.secondHeader,textColor:"#FFFFFF"},columnStyles:g};o.autoTable(w);const D=`product_wise_summary_data_${Date.now()}.pdf`;o.save(D)})};c.useEffect(()=>{const a=l=>{j.current&&!j.current.contains(l.target)&&v.current&&!v.current.contains(l.target)&&l.target.tagName!=="svg"&&l.target.tagName!=="path"&&C(!1),N.current&&!N.current.contains(l.target)&&P(!1)};return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}},[]);const V=()=>{P(!1),C(!F)};return t.jsx(t.Fragment,{children:t.jsxs("div",{className:`${e.chartContainer} ${m==="dark"?e.darkMode:e.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsxs("button",{className:e.legendButton,onClick:A,ref:N,children:[t.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:e.codeBlockIcon,title:"Legends",style:{filter:q?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),t.jsx("div",{className:`fw-bold fs-5 ${m==="dark"?e.darkMode:e.lightMode}`,children:"Product Quantity"}),t.jsx("div",{className:"d-flex g-0",ref:j,children:t.jsxs("div",{className:`${e.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${e.icon} ${m==="dark"?e.darkMode:e.lightMode} px-2 py-1`,onClick:V,children:F?t.jsx(X,{style:{fontSize:"1.1rem"}}):t.jsx(K,{style:{fontSize:"1.1rem"}})}),F&&t.jsxs("div",{className:`${e.exportOptions} ${m==="dark"?e.darkMode:e.lightMode}`,ref:v,children:[S?t.jsxs("div",{className:e.exportOption,onClick:()=>{$(!S),C(!1)},children:[t.jsx(tt,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:"Export to Graph"})]}):t.jsxs("div",{className:e.exportOption,onClick:()=>{$(!S),C(!1)},children:[t.jsx(Z,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:"Export to Table"})]}),t.jsxs("div",{className:e.exportOption,onClick:Y,children:[t.jsx(et,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:"Export to Excel"})]}),t.jsxs("div",{className:e.exportOption,onClick:U,children:[t.jsx(ot,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),L&&t.jsx("div",{className:e.loadingOverlay,children:t.jsx(at,{disableShrink:!0})}),S?t.jsx("div",{className:"container-fluid pt-2",children:t.jsx(rt,{data:I,columns:Q,options:M})}):t.jsx(nt,{option:G,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:e.piechart},b.length)]})})};export{Ot as default};
