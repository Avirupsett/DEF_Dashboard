import{_ as E}from"./index-63e61157.js";import{r as p,l as J,j as e,g as B,w as X,x as K,y as Z,z as ee,C as te}from"./vendor-e79ef30a.js";import{E as oe,M as ae,l as z,F as se}from"./index-a0b9aea6.js";const ne="_piechart_1qsus_11",le="_chartContainer_1qsus_23",re="_legendButtonContainer_1qsus_49",ie="_legendButton_1qsus_49",ce="_codeBlockIcon_1qsus_133",de="_lightMode_1qsus_191",ue="_dateFilter_1qsus_195",pe="_officefilter_1qsus_351",fe="_topContainer_1qsus_443",he="_darkMode_1qsus_463",_e="_iconsContainer_1qsus_631",ge="_icon_1qsus_631",me="_exportOptions_1qsus_715",xe="_exportOption_1qsus_715",be="_tableContainer_1qsus_975",ye="_table_1qsus_975",Se="_summaryHeader_1qsus_1011",Ce="_periodHeader_1qsus_1019",we="_closeButton_1qsus_1051",ke="_tableWrapper_1qsus_1081",Fe="_loadingOverlay_1qsus_1089",ve="_loadingSpinner_1qsus_1115",je="_boldOption_1qsus_1127",qe="_optionGroup_1qsus_1137",t={piechart:ne,chartContainer:le,"legend-text":"_legend-text_1qsus_31",legendButtonContainer:re,legendButton:ie,codeBlockIcon:ce,lightMode:de,"label-text":"_label-text_1qsus_191",dateFilter:ue,officefilter:pe,topContainer:fe,darkMode:he,"theme-container":"_theme-container_1qsus_473",iconsContainer:_e,icon:ge,exportOptions:me,exportOption:xe,tableContainer:be,table:ye,summaryHeader:Se,periodHeader:Ce,closeButton:we,tableWrapper:ke,loadingOverlay:Fe,loadingSpinner:ve,boldOption:je,optionGroup:qe},De=({themeMode:m,selectedRange:x,selectedOffice:$,isAdmin:P})=>{const[b,H]=p.useState([]),[k,F]=p.useState(!1),T=p.useRef(null),W=p.useRef(null),[v,D]=p.useState(!1),[I,L]=p.useState([]),[S,j]=p.useState(!1),[R,O]=p.useState(!1),M=[{name:"Product Name",label:"Product"},{name:"Quantity",label:"Quantity"},{name:"Sales",label:"Sales(₹)"}],A={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"238px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};p.useEffect(()=>{O(!0);const l=y(x[0]),f=y(x[1]);J.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${l}/${f}/${$}/${P}`).then(i=>{const o=i.data.graph2;let s={},_={},u={},g={};if(o.forEach(c=>{const{lstproduct:d}=c;d.forEach(a=>{let{productName:r,totalSales:n,color:q,qty:C,unitShortName:N}=a;n!==0&&(s[r]?(s[r]+=n,u[r]+=C):(s[r]=n,_[r]=q,u[r]=C,g[r]=N))})}),s){let c=[],d=[];for(let a in s)c.push({productName:a,totalSale:s[a],color:_[a],totalQty:u[a],unit:g[a]}),d.push({"Product Name":a,Sales:s[a],Quantity:`${u[a]} ${g[a]}`});L(d),H(c)}}).catch(i=>{}).finally(()=>{O(!1)})},[x,$,P]);const Q=()=>{b.length>0&&(D(!v),F(!1),j(!1))},G={tooltip:{trigger:"item",formatter:"<b>{b}</b><br><b>Total Sales:</b> ₹{c}",textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:m==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:v,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:m==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"2%",style:{text:"Product Volume",fill:m==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Sales",type:"pie",radius:["40%","65%"],center:["50%","50%"],selectedMode:"single",avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:b.length>0?b.map((l,f)=>({value:l.totalSale,name:l.productName,itemStyle:{color:l.color}})):[],labelLine:{length:30,length2:10},itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},Y=async()=>{const l=y(x[0]),f=y(x[1]),i=await E(()=>import("./exceljs.min-75f8aaff.js").then(s=>s.e),["assets/exceljs.min-75f8aaff.js","assets/vendor-e79ef30a.js"]),h=new i.Workbook,o=h.addWorksheet("Data");fetch(z).then(s=>s.blob()).then(s=>{const _=new FileReader;_.onload=function(){const u=_.result,g=h.addImage({base64:u,extension:"png"});o.addImage(g,{tl:{col:0,row:0},ext:{width:100,height:70}});const c=o.getCell("A2");c.value="Product Wise Summary Data",c.font={bold:!0,color:{argb:"000000"},size:14},c.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A2:C2");const d=o.getCell("A3");d.value=`Period: ${l} to ${f}`,d.font={bold:!0,color:{argb:"000000"},size:12},d.alignment={horizontal:"center"},o.mergeCells("A3:C3"),o.getColumn(1).width=50,o.getColumn(2).width=15;const a=o.addRow(["Product Name","Quantity","Total Sale"]);a.font={bold:!0,color:{argb:"000000"},size:12},a.eachCell(n=>{n.font={bold:!0,color:{argb:"000000"},size:12},n.border={bottom:{style:"thin",color:{argb:"000000"}}}}),b.forEach(n=>{o.addRow([n.productName,`${n.totalQty} ${n.unit}`,`₹${n.totalSale}`])});const r=`product_wise_summary_data_${Date.now()}.xlsx`;h.xlsx.writeBuffer().then(n=>{se.saveAs(new Blob([n]),r)})},_.readAsDataURL(s)})},y=l=>{if(!l)return"";const f=l.getFullYear(),i=String(l.getMonth()+1).padStart(2,"0"),h=String(l.getDate()).padStart(2,"0");return`${f}-${i}-${h}`},U=async()=>{const l=y(x[0]),f=y(x[1]);E(()=>import("./index-a0b9aea6.js").then(i=>i.j),["assets/index-a0b9aea6.js","assets/vendor-e79ef30a.js","assets/index-63e61157.js","assets/index-4855f2f2.css"]).then(i=>{let h=i.default;const o=new h,s=[["Product Name","Quantity","Total Sale"]],_={1:{halign:"right"},2:{halign:"right"}},u={fontSize:12,fontStyle:"bold",halign:"center"},g={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},c=z,d=35,a=20;o.addImage(c,"PNG",15,12,d,a);const r=[["Product Wise Summary Data"]];o.autoTable({head:r,body:[],headStyles:{...u,fillColor:g.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const n=[[`Period: ${l} to ${f}`]];o.autoTable({startY:39.5,head:n,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const q=b.map(w=>[w.productName,`${w.totalQty} ${w.unit}`,w.totalSale.toFixed(2)]),C={startY:o.autoTable.previous.finalY+1,head:s,body:q,headStyles:{...u,fillColor:g.secondHeader,textColor:"#FFFFFF"},columnStyles:_};o.autoTable(C);const N=`product_wise_summary_data_${Date.now()}.pdf`;o.save(N)})},V=()=>{D(!1),F(!k)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`${t.chartContainer} ${m==="dark"?t.darkMode:t.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsxs("button",{className:t.legendButton,onClick:Q,children:[e.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:t.codeBlockIcon,title:"Legends",style:{filter:v?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),e.jsx("div",{className:"d-flex g-0",ref:T,children:e.jsxs("div",{className:`${t.iconsContainer} d-flex justify-content-center align-items-center`,children:[S?e.jsx("div",{className:`${t.icon} ${m==="dark"?t.darkMode:t.lightMode}`,children:e.jsx("div",{children:e.jsx(B,{style:{fontSize:"1.1rem"},onClick:()=>{j(!S)}})})}):e.jsx("div",{className:`${t.icon} ${m==="dark"?t.darkMode:t.lightMode} px-2 py-1`,onClick:V,children:k?e.jsx(B,{style:{fontSize:"1.1rem"}}):e.jsx(X,{style:{fontSize:"1.1rem"}})}),k&&e.jsxs("div",{className:`${t.exportOptions} ${m==="dark"?t.darkMode:t.lightMode}`,ref:W,children:[e.jsxs("div",{className:t.exportOption,onClick:()=>{j(!S),F(!1)},children:[e.jsx(K,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:"Export to Table"})]}),e.jsxs("div",{className:t.exportOption,onClick:Y,children:[e.jsx(Z,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:"Export to Excel"})]}),e.jsxs("div",{className:t.exportOption,onClick:U,children:[e.jsx(ee,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),R&&e.jsx("div",{className:t.loadingOverlay,children:e.jsx(te,{disableShrink:!0})}),S?e.jsx("div",{className:"container-fluid",children:e.jsx(ae,{data:I,columns:M,options:A})}):e.jsx(oe,{option:G,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:t.piechart},b.length)]})})};export{De as default};
