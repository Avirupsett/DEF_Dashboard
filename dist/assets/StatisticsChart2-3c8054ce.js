import{_ as P}from"./index-87073c71.js";import{r as p,u as q,j as o,h as K,z as Q,A as Z,G as ee,C as te,E as oe,a as D}from"./vendor-50d77580.js";import{L as ae,a as ne,E as se,M as re,l as A,F as ie}from"./index-67390234.js";const le="_chartContainer_ew0vy_1",ce="_lightMode_ew0vy_47",de="_dateFilter_ew0vy_51",fe="_officefilter_ew0vy_207",pe="_topContainer_ew0vy_299",he="_darkMode_ew0vy_319",me="_iconsContainer_ew0vy_487",ge="_icon_ew0vy_487",ye="_exportOptions_ew0vy_571",xe="_exportOption_ew0vy_571",_e="_NoDataOverlay_ew0vy_659",ue="_tableContainer_ew0vy_849",we="_table_ew0vy_849",be="_summaryHeader_ew0vy_885",Se="_periodHeader_ew0vy_893",ve="_closeButton_ew0vy_925",Ce="_tableWrapper_ew0vy_955",Fe="_loadingOverlay_ew0vy_963",ke="_loadingSpinner_ew0vy_989",Ne="_boldOption_ew0vy_1001",je="_optionGroup_ew0vy_1011",Oe="_resetButtonContainer_ew0vy_1039",$e="_resetButton_ew0vy_1039",n={chartContainer:le,lightMode:ce,"label-text":"_label-text_ew0vy_47",dateFilter:de,officefilter:fe,topContainer:pe,darkMode:he,"theme-container":"_theme-container_ew0vy_329",iconsContainer:me,icon:ge,exportOptions:ye,exportOption:xe,NoDataOverlay:_e,tableContainer:ue,table:we,summaryHeader:be,periodHeader:Se,closeButton:ve,tableWrapper:Ce,loadingOverlay:Fe,loadingSpinner:ke,boldOption:Ne,optionGroup:je,resetButtonContainer:Oe,resetButton:$e},ze=({themeMode:r,selectedRange:h,selectedOffice:S,isAdmin:T,SelectedOfficeName:De})=>{const[m,H]=p.useState([]),[N,v]=p.useState(!1),j=p.useRef(null),O=p.useRef(null),[E,B]=p.useState(!0),[_,z]=p.useState(!1),[W,I]=p.useState([]),{t:a}=q(),R=[{name:"officeName",label:a("Office")},{name:"sales",label:`${a("Sales")}(₹)`}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:a("Rows")}}};p.useEffect(()=>{const e=s=>{j.current&&!j.current.contains(s.target)&&O.current&&!O.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&v(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]),p.useEffect(()=>{const e=x(h[0]),s=x(h[1]);e&&s&&S&&(()=>{B(!0),h&&S&&D.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${e}/${s}/${S}/${T}`).then(l=>{const{data:t}=l;if(t.graph1){let g=[],c=[];for(let i=0;i<t.graph1.length;i++)g.push({officeName:t.graph1[i].officeName,officeType:t.graph1[i].officeType,sales:t.graph1[i].totalIncome.toFixed(0),color:t.graph1[i].officeTypeColor}),c.push({officeName:t.graph1[i].officeName,sales:t.graph1[i].totalIncome.toFixed(2)});c.push({officeName:a("Total"),sales:g.reduce((i,y)=>i+parseFloat(y.sales),0).toFixed(2)}),I(c),H(g)}}).catch(l=>{console.log("Error fetching data:",l)}).finally(()=>{B(!1)})})()},[h,S,T]);const M={title:{textStyle:{color:r==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${a("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:r==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:m.map(e=>e.officeName),axisLine:{lineStyle:{color:r==="dark"?"#ffffff":"#000000"}},axisLabel:{color:r==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?a("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:r==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:r==="dark"?"#ffffff":"#000000"}},axisLabel:{color:r==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:r==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:m.map((e,s)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:m.length<=5,position:"right",color:r==="dark"?"#ffffff":"#000000"}}]},L=e=>{let s="";const f=new Uint8Array(e),l=f.byteLength;for(let t=0;t<l;t++)s+=String.fromCharCode(f[t]);return window.btoa(s)},V=async()=>{const e=x(h[0]),s=x(h[1]),f=await P(()=>import("./exceljs.min-46260496.js").then(d=>d.e),["assets/exceljs.min-46260496.js","assets/vendor-50d77580.js"]),l=new f.Workbook,t=l.addWorksheet("Total Sales by Office"),g=await D.get(A,{responseType:"arraybuffer"}),c=L(g.data),i=l.addImage({base64:c,extension:"png"});t.addImage(i,{tl:{col:0,row:0},ext:{width:40,height:40}});const y=t.getCell("A1");y.value=a("Total Sales by Business Entity"),y.font={bold:!0,color:{argb:"000000"},size:14},y.alignment={vertical:"middle",horizontal:"center"},t.mergeCells("A1:C1");const u=t.getCell("A2");u.value=`${a("Period")}: ${e} ${a("to")} ${s}`,u.font={bold:!0,color:{argb:"000000"},size:12},u.alignment={horizontal:"center"},t.mergeCells("A2:C2"),t.getColumn(1).width=50,t.getColumn(2).width=15,t.getColumn(3).width=15;const $=t.addRow([a("Office Name"),a("Sales")]);$.font={bold:!0},m.forEach(d=>{t.addRow([d.officeName,d.sales])});const C=t.addRow([a("Total"),""]);C.font={bold:!0,color:{argb:"000000"},size:12};const F=m.reduce((d,b)=>d+parseFloat(b.sales),0),w=t.getCell(`B${C.number}`);w.value=`₹${F}`,w.numFmt="0.00",w.alignment={horizontal:"right"},l.xlsx.writeBuffer().then(d=>{const b=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ie.saveAs(b,"total_sales_by_office.xlsx")})},Y=async()=>{const e=x(h[0]),s=x(h[1]),f=await D.get(A,{responseType:"arraybuffer"}),l=L(f.data);P(()=>import("./index-67390234.js").then(t=>t.j),["assets/index-67390234.js","assets/vendor-50d77580.js","assets/index-87073c71.js","assets/index-4da97eed.css"]).then(t=>{let g=t.default;const c=new g,i=l,y=35,u=20;c.addImage(i,"PNG",15,9,y,u);const $=[[a("Total Sales by Business Entity")]];c.autoTable({startY:27,head:$,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const C=[[`${a(Period)}: ${e} ${a(to)} ${s}`]];c.autoTable({startY:36,head:C,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const F=m.map(k=>[k.officeName,parseFloat(k.sales.toFixed(2))]),w=m.reduce((k,X)=>k+parseFloat(X.sales),0);F.push([a("Total"),`${w.toFixed(2)}`]);const d=[a("Office Name"),a("Sales")],b={1:{halign:"right"},2:{halign:"right"}},J={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};c.autoTable(d,F,{startY:45,headStyles:J,columnStyles:b}),c.save("total_sales_by_office.pdf")})},U=()=>{v(!N)},x=e=>{if(!e)return"";const s=e.getFullYear(),f=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${s}-${f}-${l}`};return o.jsxs("div",{className:`${n.chartContainer} ${r==="dark"?n.darkMode:n.lightMode}`,children:[o.jsx("div",{className:"container-fluid",children:o.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[o.jsx("div",{className:`fw-bold fs-5 ${r==="dark"?n.darkMode:n.lightMode}`,children:a("Total Sales by Business Entity")}),o.jsx("div",{className:"d-flex g-0",ref:j,children:o.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[o.jsx("div",{className:`${n.icon} ${r==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:U,children:N?o.jsx(K,{style:{fontSize:"1.1rem"}}):o.jsx(Q,{style:{fontSize:"1.1rem"}})}),N&&o.jsxs("div",{className:`${n.exportOptions} ${r==="dark"?n.darkMode:n.lightMode}`,ref:O,children:[_?o.jsxs("div",{className:n.exportOption,onClick:()=>{z(!_),v(!1)},children:[o.jsx(ee,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),o.jsx("span",{children:a("View Graph")})]}):o.jsxs("div",{className:n.exportOption,onClick:()=>{z(!_),v(!1)},children:[o.jsx(Z,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),o.jsx("span",{children:a("View Table")})]}),o.jsxs("div",{className:n.exportOption,onClick:V,children:[o.jsx(te,{style:{fontSize:"1.1rem",color:"green"}}),o.jsx("span",{children:a("Export to Excel")})]}),o.jsxs("div",{className:n.exportOption,onClick:Y,children:[o.jsx(oe,{style:{fontSize:"1.1rem",color:"red"}}),o.jsx("span",{children:a("Export to PDF")})]})]})]})})]})}),E&&o.jsx("div",{className:n.NoDataOverlay,children:o.jsx(ae,{animationData:ne,loop:!0})}),W.length==1&&!_&&!E?o.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:a("No Data Found")}):"",_?o.jsx("div",{className:"container-fluid mt-2",children:o.jsx(re,{data:W,columns:R,options:G})}):o.jsx(se,{option:M,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:r==="dark"?n.darkMode:n.lightMode})]})};export{ze as default};
