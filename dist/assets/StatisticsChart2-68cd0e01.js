import{_ as D}from"./index-63e61157.js";import{r as x,j as e,g as P,w as K,x as Q,y as Z,z as ee,C as te,l as v}from"./vendor-e79ef30a.js";import{E as oe,M as ae,l as W,F as ne}from"./index-a0b9aea6.js";const se="_chartContainer_64nzh_1",re="_lightMode_64nzh_47",le="_dateFilter_64nzh_51",ie="_officefilter_64nzh_207",ce="_topContainer_64nzh_299",de="_darkMode_64nzh_319",fe="_iconsContainer_64nzh_487",he="_icon_64nzh_487",pe="_exportOptions_64nzh_571",me="_exportOption_64nzh_571",xe="_tableContainer_64nzh_831",ge="_table_64nzh_831",_e="_summaryHeader_64nzh_867",be="_periodHeader_64nzh_875",ue="_closeButton_64nzh_907",ye="_tableWrapper_64nzh_937",Se="_loadingOverlay_64nzh_945",we="_loadingSpinner_64nzh_971",Ce="_boldOption_64nzh_983",Fe="_optionGroup_64nzh_993",a={chartContainer:se,lightMode:re,"label-text":"_label-text_64nzh_47",dateFilter:le,officefilter:ie,topContainer:ce,darkMode:de,"theme-container":"_theme-container_64nzh_329",iconsContainer:fe,icon:he,exportOptions:pe,exportOption:me,tableContainer:xe,table:ge,summaryHeader:_e,periodHeader:be,closeButton:ue,tableWrapper:ye,loadingOverlay:Se,loadingSpinner:we,boldOption:Ce,optionGroup:Fe},ve=({themeMode:l,selectedRange:m,selectedOffice:z,isAdmin:O,SelectedOfficeName:k})=>{const[g,B]=x.useState([]),[j,N]=x.useState(!1),I=x.useRef(null),L=x.useRef(null),[A,T]=x.useState(!0),[S,E]=x.useState(!1),[H,R]=x.useState([]),M=[{name:"officeName",label:"Office"},{name:"sales",label:"Sales(₹)"}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};x.useEffect(()=>{m&&z&&(()=>{T(!0);const d=b(m[0]),f=b(m[1]);v.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${d}/${f}/${z}/${O}`).then(i=>{const{data:o}=i;console.log("API response data:",o);let s={};if(o.graph1.forEach(n=>{const{lstOffice:h}=n;h.forEach(r=>{let{officeName:c,totalIncome:_}=r;_!==0&&(s[c]?s[c]+=_:s[c]=_)}),n.totalIncome>0&&h.length==0&&(s[k]?s[k]+=n.totalIncome:s[k]=n.totalIncome)}),s){let n=[],h=[];for(let r in s)n.push({officeName:r,sales:s[r]}),h.push({officeName:r,sales:s[r].toFixed(2)});h.push({officeName:"Total",sales:n.reduce((r,c)=>r+parseFloat(c.sales),0).toFixed(2)}),R(h),B(n)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{T(!1)})})()},[m,z,O]);const Y={color:["#66BA69"],title:{textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:"<b>Office:</b> {b} <br> <b>Sales:</b> {c} ",textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:g.map(t=>t.officeName),axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",fontSize:12,formatter:t=>window.innerWidth<=768?t.length>10?t.substring(0,10)+"...":t:t.length>0?t.substring(0,10)+"...":t}},grid:{left:window.innerWidth<=768?85:100,right:45,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?"Sales":"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",formatter:t=>t>=1e3?t/1e3+"k":t,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:l==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"25%",data:g.map(t=>t.sales),label:{show:g.length<=5,position:"right"}}]},$=t=>{let d="";const f=new Uint8Array(t),i=f.byteLength;for(let o=0;o<i;o++)d+=String.fromCharCode(f[o]);return window.btoa(d)},U=async()=>{const t=b(m[0]),d=b(m[1]),f=await D(()=>import("./exceljs.min-75f8aaff.js").then(p=>p.e),["assets/exceljs.min-75f8aaff.js","assets/vendor-e79ef30a.js"]),i=new f.Workbook,o=i.addWorksheet("Total Sales by Office"),s=await v.get(W,{responseType:"arraybuffer"}),n=$(s.data),h=i.addImage({base64:n,extension:"png"});o.addImage(h,{tl:{col:0,row:0},ext:{width:40,height:40}});const r=o.getCell("A1");r.value="Total Sales by Office",r.font={bold:!0,color:{argb:"000000"},size:14},r.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:C1");const c=o.getCell("A2");c.value=`Period: ${t} to ${d}`,c.font={bold:!0,color:{argb:"000000"},size:12},c.alignment={horizontal:"center"},o.mergeCells("A2:C2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const _=o.addRow(["Office Name","Sales"]);_.font={bold:!0},g.forEach(p=>{o.addRow([p.officeName,p.sales])});const w=o.addRow(["Total",""]);w.font={bold:!0,color:{argb:"000000"},size:12};const C=g.reduce((p,y)=>p+parseFloat(y.sales),0),u=o.getCell(`B${w.number}`);u.value=`₹${C}`,u.numFmt="0.00",u.alignment={horizontal:"right"},i.xlsx.writeBuffer().then(p=>{const y=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ne.saveAs(y,"total_sales_by_office.xlsx")})},V=async()=>{const t=b(m[0]),d=b(m[1]),f=await v.get(W,{responseType:"arraybuffer"}),i=$(f.data);D(()=>import("./index-a0b9aea6.js").then(o=>o.j),["assets/index-a0b9aea6.js","assets/vendor-e79ef30a.js","assets/index-63e61157.js","assets/index-4855f2f2.css"]).then(o=>{let s=o.default;const n=new s,h=i,r=35,c=20;n.addImage(h,"PNG",15,9,r,c);const _=[["Total Sales by Office"]];n.autoTable({startY:27,head:_,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const w=[[`Period: ${t} to ${d}`]];n.autoTable({startY:36,head:w,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const C=g.map(F=>[F.officeName,parseFloat(F.sales.toFixed(2))]),u=g.reduce((F,q)=>F+parseFloat(q.sales),0);C.push(["Total",`${u.toFixed(2)}`]);const p=["Office Name","Sales"],y={1:{halign:"right"},2:{halign:"right"}},X={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};n.autoTable(p,C,{startY:45,headStyles:X,columnStyles:y}),n.save("total_sales_by_office.pdf")})},J=()=>{N(!j)},b=t=>{if(!t)return"";const d=t.getFullYear(),f=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${d}-${f}-${i}`};return e.jsxs("div",{className:`${a.chartContainer} ${l==="dark"?a.darkMode:a.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsx("div",{className:"fw-bold fs-5 ",children:"Total Sales by Pump "}),e.jsx("div",{className:"d-flex g-0",ref:I,children:e.jsxs("div",{className:`${a.iconsContainer} d-flex justify-content-center align-items-center`,children:[S?e.jsx("div",{className:`${a.icon} ${l==="dark"?a.darkMode:a.lightMode}`,children:e.jsx("div",{children:e.jsx(P,{style:{fontSize:"1.1rem"},onClick:()=>{E(!S)}})})}):e.jsx("div",{className:`${a.icon} ${l==="dark"?a.darkMode:a.lightMode} px-2 py-1`,onClick:J,children:j?e.jsx(P,{style:{fontSize:"1.1rem"}}):e.jsx(K,{style:{fontSize:"1.1rem"}})}),j&&e.jsxs("div",{className:`${a.exportOptions} ${l==="dark"?a.darkMode:a.lightMode}`,ref:L,children:[e.jsxs("div",{className:a.exportOption,onClick:()=>{E(!S),N(!1)},children:[e.jsx(Q,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:"Export to Table"})]}),e.jsxs("div",{className:a.exportOption,onClick:U,children:[e.jsx(Z,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:"Export to Excel"})]}),e.jsxs("div",{className:a.exportOption,onClick:V,children:[e.jsx(ee,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),A&&e.jsx("div",{className:a.loadingOverlay,children:e.jsx(te,{disableShrink:!0})}),S?e.jsx("div",{className:"container-fluid mt-2",children:e.jsx(ae,{data:H,columns:M,options:G})}):e.jsx(oe,{option:Y,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:l==="dark"?a.darkMode:a.lightMode})]})};export{ve as default};
