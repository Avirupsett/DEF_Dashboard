import{_ as I}from"./index-63e61157.js";import{r as x,v as Z,j as t,g as N,w as ee,x as te,y as ae,z as oe,C as ne,l as P}from"./vendor-e79ef30a.js";import{E as se,M as re,l as W,F as le}from"./index-a0b9aea6.js";const ie="_chartContainer_hk4h8_1",de="_lightMode_hk4h8_47",ce="_dateFilter_hk4h8_51",he="_officefilter_hk4h8_207",pe="_topContainer_hk4h8_299",fe="_darkMode_hk4h8_319",xe="_iconsContainer_hk4h8_487",ue="_icon_hk4h8_487",me="_exportOptions_hk4h8_571",ge="_exportOption_hk4h8_571",be="_tableContainer_hk4h8_831",_e="_table_hk4h8_831",ye="_summaryHeader_hk4h8_867",Se="_periodHeader_hk4h8_875",we="_closeButton_hk4h8_907",Ce="_tableWrapper_hk4h8_937",ke="_loadingOverlay_hk4h8_945",Fe="_loadingSpinner_hk4h8_971",De="_boldOption_hk4h8_983",ve="_optionGroup_hk4h8_993",n={chartContainer:ie,lightMode:de,"label-text":"_label-text_hk4h8_47",dateFilter:ce,officefilter:he,topContainer:pe,darkMode:fe,"theme-container":"_theme-container_hk4h8_329",iconsContainer:xe,icon:ue,exportOptions:me,exportOption:ge,tableContainer:be,table:_e,summaryHeader:ye,periodHeader:Se,closeButton:we,tableWrapper:Ce,loadingOverlay:ke,loadingSpinner:Fe,boldOption:De,optionGroup:ve},$e=({selectedRange:d,themeMode:l,selectedOffice:k,isAdmin:A})=>{const[c,B]=x.useState([]),[v,$]=x.useState(!1),L=x.useRef(null),H=x.useRef(null),[G,z]=x.useState(!0),[q,R]=x.useState(!0),[M,Y]=x.useState([]),[F,T]=x.useState(!1),U=[{name:"requestedDate",label:"Date"},{name:"sales",label:"Sales(₹)"},{name:"expense",label:"Expense(₹)"}],V={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};x.useEffect(()=>{d&&k&&(()=>{z(!0);const i=_(d[0]),s=_(d[1]);P.get(`http://115.124.120.251:5059/api/Dashboard/DEFDashBoardGraphData/${i}/${s}/${k}/${A}`).then(p=>{const{data:a}=p;if(console.log("API response data:",a),Array.isArray(a.graph1)){const u=a.graph1.map(r=>({requestedDate:r.requestedDate,sales:r.totalIncome,expense:r.totalExpense}));let m=u.filter(r=>r.sales!==0||r.expense!==0);const b=u.reduce((r,f)=>r+f.sales,0).toFixed(2),w=u.reduce((r,f)=>r+f.expense,0).toFixed(2);m.push({requestedDate:"Total",sales:b,expense:w}),Y(m),B(u)}}).catch(p=>{console.log("Error fetching data:",p)}).finally(()=>{z(!1)})})()},[d,k,A]);const O=(c.filter(e=>e.sales>0).reduce((e,i)=>e+i.sales,0)/c.filter(e=>e.sales>0).length).toFixed(2);x.useEffect(()=>{if(d[0]&&d[1]){const e=new Date(d[0]),i=new Date(d[1]),s=Z(i,e)+1;R(s<=7)}},[d,k]);const J={color:["#66BA69","#E81A1A","#FFC107"],title:{textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:function(e){for(var i="<b>Date:</b> "+e[0].name+"<br/>",s=0;s<e.length;s++)i+="<b>"+e[s].seriesName+":</b> "+e[s].value+"<br/>";return i},textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{top:window.innerWidth>550?0:270,data:["Sales","Expense","Average Sales"],textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?10:12}},grid:{left:window.innerWidth<=768?"7%":"4%",right:"3%",top:"10%",bottom:c.length>0?"15%":"20%",containLabel:c.length>0},xAxis:{type:"category",name:window.innerWidth>550?"Date":"",nameLocation:"middle",nameGap:35,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},boundaryGap:!0,data:c.map(e=>e.requestedDate),axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000"}},yAxis:[{type:"value",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:42,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e4?e/1e3+"k":e},splitLine:{show:!0,lineStyle:{color:l==="dark"?"grey":"silver",type:"dashed"}}},{type:"value",show:!1},{type:"value",show:!1}],series:q?[{name:"Sales",type:"bar",data:c.map(e=>e.sales),yAxisIndex:0},{name:"Expense",type:"bar",data:c.map(e=>e.expense),yAxisIndex:0},{name:"Average Sales",type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:c.map(()=>O)}]:[{name:"Sales",type:"line",smooth:!0,data:c.map(e=>e.sales),yAxisIndex:0},{name:"Expense",type:"line",smooth:!0,data:c.map(e=>e.expense),yAxisIndex:0},{name:"Average Sales",type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:c.map(()=>O)}]},X=async()=>{const e=_(d[0]),i=_(d[1]),s=await I(()=>import("./exceljs.min-75f8aaff.js").then(b=>b.e),["assets/exceljs.min-75f8aaff.js","assets/vendor-e79ef30a.js"]),p=new s.Workbook,a=p.addWorksheet("Graph Data"),u=await P.get(W,{responseType:"blob"}),m=new FileReader;m.onload=function(){const b=m.result,w=p.addImage({base64:b,extension:"png"});a.addImage(w,{tl:{col:0,row:0},ext:{width:100,height:60}});const r=a.getCell("A1");r.value="Sales-Expense Summary",r.font={bold:!0,color:{argb:"000000"},size:14},r.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A1:C1");const f=a.getCell("A2");f.value=`Period: ${e} to ${i}`,f.font={bold:!0,color:{argb:"000000"},size:12},f.alignment={horizontal:"center"},a.mergeCells("A2:C2"),a.getColumn(1).width=50,a.getColumn(2).width=15,a.getColumn(3).width=15;const C=a.addRow(["Date","Sales","Expense"]);C.font={bold:!0,color:{argb:"000000"},size:12,underline:!0},C.eachCell(o=>{o.font={bold:!0,color:{argb:"000000"},size:12},o.border={bottom:{style:"thin",color:{argb:"000000"}}}});const y=c.filter(o=>o.sales!==0||o.expense!==0);y.forEach(o=>{const g=a.addRow([o.requestedDate,Number(o.sales),Number(o.expense)]);g.getCell(2).numFmt="0.00",g.getCell(3).numFmt="0.00"});const S=a.addRow(["Total","",""]);S.font={bold:!0,color:{argb:"000000"},size:12};const E=y.reduce((o,g)=>o+g.sales,0),j=y.reduce((o,g)=>o+g.expense,0),D=a.getCell(`B${S.number}`);D.value=`₹${E.toFixed(2)}`,D.alignment={horizontal:"right"};const h=a.getCell(`C${S.number}`);h.value=`₹${j.toFixed(2)}`,h.alignment={horizontal:"right"},p.xlsx.writeBuffer().then(o=>{const g=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});le.saveAs(g,"sales-expense.xlsx")})},m.readAsDataURL(u.data)},K=()=>{const e=_(d[0]),i=_(d[1]);I(()=>import("./index-a0b9aea6.js").then(s=>s.j),["assets/index-a0b9aea6.js","assets/vendor-e79ef30a.js","assets/index-63e61157.js","assets/index-4855f2f2.css"]).then(s=>{let p=s.default;const a=new p,u=W,m=35,b=20;a.addImage(u,"PNG",15,9,m,b);const w=[["Sales-Expense Summary"]];a.autoTable({startY:27,head:w,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const r=[[`Period: ${e} to ${i}`]];a.autoTable({startY:36,head:r,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const f=c.filter(h=>h.sales!==0||h.expense!==0),C=f.map(h=>[h.requestedDate,parseFloat(h.sales),parseFloat(h.expense)]),y=f.reduce((h,o)=>h+o.sales,0),S=f.reduce((h,o)=>h+o.expense,0);(y!==0||S!==0)&&C.push(["Total",`${y.toFixed(2)}`,`${S.toFixed(2)}`]);const E=["Date","Sales","Expense"],j={1:{halign:"right"},2:{halign:"right"}},D={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};a.autoTable(E,C,{startY:45,headStyles:D,columnStyles:j}),a.save("sales-expense.pdf")})},Q=()=>{$(!v)},_=e=>{if(!e)return"";const i=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),p=String(e.getDate()).padStart(2,"0");return`${i}-${s}-${p}`};return t.jsxs("div",{className:`${n.chartContainer} ${l==="dark"?n.darkMode:n.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsx("div",{className:"fw-bold fs-5 ",children:"Sales-Expense"}),t.jsx("div",{className:"d-flex g-0",ref:L,children:t.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[F?t.jsx("div",{className:`${n.icon} ${l==="dark"?n.darkMode:n.lightMode}`,children:t.jsx("div",{children:t.jsx(N,{style:{fontSize:"1.1rem"},onClick:()=>{T(!F)}})})}):t.jsx("div",{className:`${n.icon} ${l==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:Q,children:v?t.jsx(N,{style:{fontSize:"1.1rem"}}):t.jsx(ee,{style:{fontSize:"1.1rem"}})}),v&&t.jsxs("div",{className:`${n.exportOptions} ${l==="dark"?n.darkMode:n.lightMode}`,ref:H,children:[t.jsxs("div",{className:n.exportOption,onClick:()=>{T(!F),$(!1)},children:[t.jsx(te,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:"Export to Table"})]}),t.jsxs("div",{className:n.exportOption,onClick:X,children:[t.jsx(ae,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:"Export to Excel"})]}),t.jsxs("div",{className:n.exportOption,onClick:K,children:[t.jsx(oe,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),G&&t.jsx("div",{className:n.loadingOverlay,children:t.jsx(ne,{disableShrink:!0})}),F?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(re,{data:M,columns:U,options:V})}):t.jsx(se,{option:J,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:l==="dark"?n.darkMode:n.lightMode})]})};export{$e as default};
