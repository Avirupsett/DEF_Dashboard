import{_ as W}from"./index-0bab7b9d.js";import{r as x,v as Q,j as t,g as Z,w as ee,x as te,y as ae,z as oe,A as ne,C as se,l as L}from"./vendor-770ffdd0.js";import{E as re,M as le,l as P,F as ie}from"./index-82263592.js";const de="_chartContainer_1yphy_1",ce="_lightMode_1yphy_47",pe="_dateFilter_1yphy_51",fe="_officefilter_1yphy_207",he="_topContainer_1yphy_299",xe="_darkMode_1yphy_319",ye="_iconsContainer_1yphy_487",ue="_icon_1yphy_487",me="_exportOptions_1yphy_571",ge="_exportOption_1yphy_571",be="_tableContainer_1yphy_831",_e="_table_1yphy_831",Se="_summaryHeader_1yphy_867",Ce="_periodHeader_1yphy_875",we="_closeButton_1yphy_907",Fe="_tableWrapper_1yphy_937",De="_loadingOverlay_1yphy_945",ve="_loadingSpinner_1yphy_971",ke="_boldOption_1yphy_983",Ee="_optionGroup_1yphy_993",s={chartContainer:de,lightMode:ce,"label-text":"_label-text_1yphy_47",dateFilter:pe,officefilter:fe,topContainer:he,darkMode:xe,"theme-container":"_theme-container_1yphy_329",iconsContainer:ye,icon:ue,exportOptions:me,exportOption:ge,tableContainer:be,table:_e,summaryHeader:Se,periodHeader:Ce,closeButton:we,tableWrapper:Fe,loadingOverlay:De,loadingSpinner:ve,boldOption:ke,optionGroup:Ee},ze=({selectedRange:d,themeMode:i,selectedOffice:F,isAdmin:O})=>{const[c,B]=x.useState([]),[E,D]=x.useState(!1),j=x.useRef(null),A=x.useRef(null),[H,T]=x.useState(!0),[G,q]=x.useState(!0),[R,M]=x.useState([]),[v,N]=x.useState(!1),Y=[{name:"requestedDate",label:"Date"},{name:"sales",label:"Sales(₹)"},{name:"expense",label:"Expense(₹)"}],U={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};x.useEffect(()=>{d&&F&&(()=>{T(!0);const o=b(d[0]),r=b(d[1]);L.get(`http://115.124.120.251:5059/api/Dashboard/DEFDashBoardGraphData/${o}/${r}/${F}/${O}`).then(f=>{const{data:a}=f;if(Array.isArray(a.graph1)){const y=a.graph1.map(l=>({requestedDate:l.requestedDate,sales:l.totalIncome,expense:l.totalExpense}));let u=y.filter(l=>l.sales!==0||l.expense!==0);const g=y.reduce((l,h)=>l+h.sales,0).toFixed(2),C=y.reduce((l,h)=>l+h.expense,0).toFixed(2);u.push({requestedDate:"Total",sales:g,expense:C}),M(u),B(y)}}).catch(f=>{console.log("Error fetching data:",f)}).finally(()=>{T(!1)})})()},[d,F,O]);const I=(c.filter(e=>e.sales>0).reduce((e,o)=>e+o.sales,0)/c.filter(e=>e.sales>0).length).toFixed(2);x.useEffect(()=>{if(d[0]&&d[1]){const e=new Date(d[0]),o=new Date(d[1]),r=Q(o,e)+1;q(r<=7)}},[d,F]);const V={color:["#66BA69","#E81A1A","#FFC107"],title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:function(e){for(var o="<b>Date:</b> "+e[0].name+"<br/>",r=0;r<e.length;r++)o+="<b>"+e[r].seriesName+":</b> "+e[r].value+"<br/>";return o},textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{top:window.innerWidth>550?0:270,data:["Sales","Expense","Average Sales"],textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?10:12}},grid:{left:window.innerWidth<=768?"7%":"4%",right:"3%",top:"10%",bottom:c.length>0?"15%":"20%",containLabel:c.length>0},xAxis:{type:"category",name:window.innerWidth>550?"Date":"",nameLocation:"middle",nameGap:35,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},boundaryGap:!0,data:c.map(e=>e.requestedDate),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000"}},yAxis:[{type:"value",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:42,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e4?e/1e3+"k":e},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"dashed"}}},{type:"value",show:!1},{type:"value",show:!1}],series:G?[{name:"Sales",type:"bar",data:c.map(e=>e.sales),yAxisIndex:0},{name:"Expense",type:"bar",data:c.map(e=>e.expense),yAxisIndex:0},{name:"Average Sales",type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:c.map(()=>I)}]:[{name:"Sales",type:"line",smooth:!0,data:c.map(e=>e.sales),yAxisIndex:0},{name:"Expense",type:"line",smooth:!0,data:c.map(e=>e.expense),yAxisIndex:0},{name:"Average Sales",type:"line",yAxisIndex:0,smooth:!0,lineStyle:{color:"#FFC107",width:2,type:"dashed"},data:c.map(()=>I)}]},J=async()=>{const e=b(d[0]),o=b(d[1]),r=await W(()=>import("./exceljs.min-d8450118.js").then(g=>g.e),["assets/exceljs.min-d8450118.js","assets/vendor-770ffdd0.js"]),f=new r.Workbook,a=f.addWorksheet("Graph Data"),y=await L.get(P,{responseType:"blob"}),u=new FileReader;u.onload=function(){const g=u.result,C=f.addImage({base64:g,extension:"png"});a.addImage(C,{tl:{col:0,row:0},ext:{width:100,height:60}});const l=a.getCell("A1");l.value="Sales-Expense Summary",l.font={bold:!0,color:{argb:"000000"},size:14},l.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A1:C1");const h=a.getCell("A2");h.value=`Period: ${e} to ${o}`,h.font={bold:!0,color:{argb:"000000"},size:12},h.alignment={horizontal:"center"},a.mergeCells("A2:C2"),a.getColumn(1).width=50,a.getColumn(2).width=15,a.getColumn(3).width=15;const w=a.addRow(["Date","Sales","Expense"]);w.font={bold:!0,color:{argb:"000000"},size:12,underline:!0},w.eachCell(n=>{n.font={bold:!0,color:{argb:"000000"},size:12},n.border={bottom:{style:"thin",color:{argb:"000000"}}}});const _=c.filter(n=>n.sales!==0||n.expense!==0);_.forEach(n=>{const m=a.addRow([n.requestedDate,Number(n.sales),Number(n.expense)]);m.getCell(2).numFmt="0.00",m.getCell(3).numFmt="0.00"});const S=a.addRow(["Total","",""]);S.font={bold:!0,color:{argb:"000000"},size:12};const $=_.reduce((n,m)=>n+m.sales,0),z=_.reduce((n,m)=>n+m.expense,0),k=a.getCell(`B${S.number}`);k.value=`₹${$.toFixed(2)}`,k.alignment={horizontal:"right"};const p=a.getCell(`C${S.number}`);p.value=`₹${z.toFixed(2)}`,p.alignment={horizontal:"right"},f.xlsx.writeBuffer().then(n=>{const m=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ie.saveAs(m,"sales-expense.xlsx")})},u.readAsDataURL(y.data)},X=()=>{const e=b(d[0]),o=b(d[1]);W(()=>import("./index-82263592.js").then(r=>r.j),["assets/index-82263592.js","assets/vendor-770ffdd0.js","assets/index-0bab7b9d.js","assets/index-7b634162.css"]).then(r=>{let f=r.default;const a=new f,y=P,u=35,g=20;a.addImage(y,"PNG",15,9,u,g);const C=[["Sales-Expense Summary"]];a.autoTable({startY:27,head:C,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const l=[[`Period: ${e} to ${o}`]];a.autoTable({startY:36,head:l,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const h=c.filter(p=>p.sales!==0||p.expense!==0),w=h.map(p=>[p.requestedDate,parseFloat(p.sales),parseFloat(p.expense)]),_=h.reduce((p,n)=>p+n.sales,0),S=h.reduce((p,n)=>p+n.expense,0);(_!==0||S!==0)&&w.push(["Total",`${_.toFixed(2)}`,`${S.toFixed(2)}`]);const $=["Date","Sales","Expense"],z={1:{halign:"right"},2:{halign:"right"}},k={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};a.autoTable($,w,{startY:45,headStyles:k,columnStyles:z}),a.save("sales-expense.pdf")})};x.useEffect(()=>{const e=o=>{j.current&&!j.current.contains(o.target)&&A.current&&!A.current.contains(o.target)&&o.target.tagName!=="svg"&&o.target.tagName!=="path"&&D(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const K=()=>{D(!E)},b=e=>{if(!e)return"";const o=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),f=String(e.getDate()).padStart(2,"0");return`${o}-${r}-${f}`};return t.jsxs("div",{className:`${s.chartContainer} ${i==="dark"?s.darkMode:s.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-5 ${i==="dark"?s.darkMode:s.lightMode}`,children:"Sales-Expense"}),t.jsx("div",{className:"d-flex g-0",ref:j,children:t.jsxs("div",{className:`${s.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${s.icon} ${i==="dark"?s.darkMode:s.lightMode} px-2 py-1`,onClick:K,children:E?t.jsx(Z,{style:{fontSize:"1.1rem"}}):t.jsx(ee,{style:{fontSize:"1.1rem"}})}),E&&t.jsxs("div",{className:`${s.exportOptions} ${i==="dark"?s.darkMode:s.lightMode}`,ref:A,children:[v?t.jsxs("div",{className:s.exportOption,onClick:()=>{N(!v),D(!1)},children:[t.jsx(ae,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:"Export to Graph"})]}):t.jsxs("div",{className:s.exportOption,onClick:()=>{N(!v),D(!1)},children:[t.jsx(te,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:"Export to Table"})]}),t.jsxs("div",{className:s.exportOption,onClick:J,children:[t.jsx(oe,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:"Export to Excel"})]}),t.jsxs("div",{className:s.exportOption,onClick:X,children:[t.jsx(ne,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),H&&t.jsx("div",{className:s.loadingOverlay,children:t.jsx(se,{disableShrink:!0})}),v?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(le,{data:R,columns:Y,options:U})}):t.jsx(re,{option:V,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:i==="dark"?s.darkMode:s.lightMode})]})};export{ze as default};
