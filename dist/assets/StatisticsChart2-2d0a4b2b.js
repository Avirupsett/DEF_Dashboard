import{_ as ce}from"./index-3d8d8b63.js";import{r as d,u as Pe,j as o,I as ze,J as We,i as Ee,B as Re,C as He,K as Le,G as Ge,H as Ae,a as _}from"./vendor-d27bb63f.js";import{L as Ve,R as Me}from"./index-3570dccd.js";import{k as Ue,l as Ye,Q as v,a as de,f as qe,b as Je}from"./NotoSansDevanagari-VariableFont_wdth_wght-05058995.js";const Ke="_chartContainer_ew0vy_1",Qe="_lightMode_ew0vy_47",Xe="_dateFilter_ew0vy_51",Ze="_officefilter_ew0vy_207",et="_topContainer_ew0vy_299",tt="_darkMode_ew0vy_319",ot="_iconsContainer_ew0vy_487",at="_icon_ew0vy_487",nt="_exportOptions_ew0vy_571",st="_exportOption_ew0vy_571",rt="_NoDataOverlay_ew0vy_659",it="_tableContainer_ew0vy_849",lt="_table_ew0vy_849",ct="_summaryHeader_ew0vy_885",dt="_periodHeader_ew0vy_893",ft="_closeButton_ew0vy_925",pt="_tableWrapper_ew0vy_955",ht="_loadingOverlay_ew0vy_963",ut="_loadingSpinner_ew0vy_989",gt="_boldOption_ew0vy_1001",yt="_optionGroup_ew0vy_1011",wt="_resetButtonContainer_ew0vy_1039",mt="_resetButton_ew0vy_1039",i={chartContainer:Ke,lightMode:Qe,"label-text":"_label-text_ew0vy_47",dateFilter:Xe,officefilter:Ze,topContainer:et,darkMode:tt,"theme-container":"_theme-container_ew0vy_329",iconsContainer:ot,icon:at,exportOptions:nt,exportOption:st,NoDataOverlay:rt,tableContainer:it,table:lt,summaryHeader:ct,periodHeader:dt,closeButton:ft,tableWrapper:pt,loadingOverlay:ht,loadingSpinner:ut,boldOption:gt,optionGroup:yt,resetButtonContainer:wt,resetButton:mt},Ft=({themeMode:c,selectedRange:C,selectedOffice:L,isAdmin:fe,alldata:G,isLoading:te,SelectedOfficeName:xt,setSelectedOfficeName:A,selectedOfficeNameLocal:x,setSelectedOfficeNameLocal:O,setSelectedOffice:T,setIsAdmin:I,setCompanies:pe,setWholesales:he,setRetails:ue,originallist:b,setOfficeIdLocal:V,officeIdLocal:ge,setOptionvalue:P})=>{const[h,ye]=d.useState([]),[M,z]=d.useState(!1),U=d.useRef(null),Y=d.useRef(null),[F,oe]=d.useState(!1),[q,we]=d.useState([]),[N,J]=d.useState([]),[ae,ne]=d.useState([]),[me,K]=d.useState(!1),[xe,se]=d.useState(!1),[be,W]=d.useState(!0),[bt,Se]=d.useState([]),{t:n}=Pe();n("Office"),`${n("Sales")}`,n("Rows"),d.useEffect(()=>{const e=a=>{U.current&&!U.current.contains(a.target)&&Y.current&&!Y.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&z(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const re=e=>{let a=[],s=[];if(G.graph3){G.graph3.map(t=>{a.push({officeId:t.officeId,officeName:t.officeName,officeType:t.officeType,sales:t.totalIncome.toFixed(2),color:t.officeTypeColor}),s.push({officeName:t.officeName,sales:t.totalIncome.toFixed(2)})}),s.push({officeName:"Total",sales:a.reduce((t,l)=>t+parseFloat(l.sales),0).toFixed(2)}),e===1&&(pe(a.filter(t=>t.officeType==="Company")),he(a.filter(t=>t.officeType==="Wholesale Pumps")),ue(a.filter(t=>t.officeType==="Retail Pumps")),W(!0));const r=a.reduce((t,l)=>{const{officeType:u}=l;return t[u]||(t[u]=[]),t[u].push(l),t},{});ye(a),Se(r),we(s)}};d.useEffect(()=>{C&&L&&re(be?0:1)},[G]);function ie(e,a){var s=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),t=parseInt(e.substring(5,7),16);s=parseInt(s*(100+a)/100),r=parseInt(r*(100+a)/100),t=parseInt(t*(100+a)/100),s=s<255?s:255,r=r<255?r:255,t=t<255?t:255,s=Math.round(s),r=Math.round(r),t=Math.round(t);var l=s.toString(16).length==1?"0"+s.toString(16):s.toString(16),u=r.toString(16).length==1?"0"+r.toString(16):r.toString(16),k=t.toString(16).length==1?"0"+t.toString(16):t.toString(16);return"#"+l+u+k}const _e={title:{textStyle:{color:c==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${n("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameGap:80,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:h.map(e=>e.officeName),axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?n("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:c==="dark"?"grey":"silver",type:"line"}}},legend:{show:!0},series:[{type:"bar",barWidth:"30%",itemStyle:{borderRadius:[0,5,5,0]},data:h.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:new Ve(0,0,0,1,[{offset:1,color:ie(e.color,40)},{offset:0,color:ie(e.color,100)}])}})),label:{show:!0,position:"right",color:c==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},E=e=>{let a="";const s=new Uint8Array(e),r=s.byteLength;for(let t=0;t<r;t++)a+=String.fromCharCode(s[t]);return window.btoa(a)},ve=async()=>{const e=v.loading("Please wait..."),a=R(C[0]),s=R(C[1]),r=await ce(()=>import("./exceljs.min-b41d4843.js").then(p=>p.e),["assets/exceljs.min-b41d4843.js","assets/vendor-d27bb63f.js"]),t=new r.Workbook,l=t.addWorksheet("Total Sales by Office"),u=await _.get(de,{responseType:"arraybuffer"}),k=E(u.data),X=t.addImage({base64:k,extension:"png"});l.addImage(X,{tl:{col:0,row:0},ext:{width:100,height:60}});const j=l.getCell("A1");j.value=`${n("Sales")} ${n("of")} ${Q(x,10)}`,j.font={bold:!0,color:{argb:"000000"},size:14},j.alignment={vertical:"middle",horizontal:"center"},l.mergeCells("A1:C1");const $=l.getCell("A2");$.value=`${n("Period")}: ${a} ${n("to")} ${s}`,$.font={bold:!0,color:{argb:"000000"},size:12},$.alignment={horizontal:"center"},l.mergeCells("A2:C2"),l.getColumn(1).width=15,l.getColumn(2).width=50,l.getColumn(3).width=15;const S=l.addRow([n("#"),n("Office Name"),n("Sales")]);S.font={bold:!0},S.eachCell(p=>{p.font={bold:!0,color:{argb:"000000"},size:12},p.border={bottom:{style:"thin",color:{argb:"000000"}}}}),h.forEach((p,w)=>{const y=l.addRow([w+1,p.officeName,p.sales]);y.getCell(1).alignment={horizontal:"left"},y.getCell(2).alignment={horizontal:"left"},y.getCell(3).alignment={horizontal:"right"}});const H=l.addRow(["",n("Total"),""]);H.font={bold:!0,color:{argb:"000000"},size:12};const f=h.reduce((p,w)=>p+parseFloat(w.sales),0),D=l.getCell(`C${H.number}`);D.value=`₹ ${f}`,D.numFmt="0.00",D.alignment={horizontal:"right"};const Z=Date.now();t.xlsx.writeBuffer().then(async p=>{const w=new Blob([p],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=new FormData;y.append("file",w,`${Z}sales_of_${x}_${a}_${s}.xlsx`);try{const m=await _.post("http://115.124.120.251:5064/api/uploader",y,{headers:{"Content-Type":"multipart/form-data"}});m.status==200?v.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):v.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const ee=m.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${ee}`}catch(m){console.error("Error saving Excel file:",m)}})},Ce=async()=>{const e=v.loading("Please wait..."),a=R(C[0]),s=R(C[1]),t=new URLSearchParams(window.location.search).get("lang"),l=await _.get(de,{responseType:"arraybuffer"}),u=await _.get(qe,{responseType:"arraybuffer"}),k=E(u.data),X=await _.get(Je,{responseType:"arraybuffer"}),j=E(X.data),$=E(l.data);ce(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-05058995.js").then(S=>S.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-05058995.js","assets/vendor-d27bb63f.js","assets/index-3d8d8b63.js","assets/index-0090fde3.css","assets/NotoSansDevanagari-VariableFont_wdth_wght-55fec1ff.css"]).then(async S=>{let H=S.default;const f=new H,D=$,Z=35,p=20;f.addImage(D,"PNG",15,9,Z,p),f.addFileToVFS("NotoSansBengali.ttf",k),f.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),f.setFont("NotoSansBengali"),f.addFileToVFS("NotoSansDevanagari.ttf",j),f.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),f.setFont("NotoSansDevanagari");const w=[[`${n("Sales")} ${n("of")} ${Q(x,10)}`]];f.autoTable({startY:27,head:w,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const y=[[`${n("Period")}: ${a} ${n("to")} ${s}`]];f.autoTable({startY:36,head:y,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const m=h.map((g,B)=>[B+1,g.officeName,`₹ ${g.sales}`]),ee=h.reduce((g,B)=>g+parseFloat(B.sales),0);m.push(["",n("Total"),`₹ ${ee.toFixed(2)}`]);const $e=[n("#"),n("Office Name"),n("Sales")],De={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},Be={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"},Oe={0:5,1:25,2:25,3:25};f.autoTable($e,m,{startY:45,headStyles:Be,columnStyles:De,styles:{font:t==="hi"?"NotoSansDevanagari":"NotoSansBengali"},columnWidth:"wrap",columnWidths:Oe});const Te=Date.now(),Ie=f.output("blob"),le=new FormData;le.append("file",Ie,`${Te}sales_of_${x}_${a}_${s}.pdf`);try{const g=await _.post("http://115.124.120.251:5064/api/uploader",le,{headers:{"Content-Type":"multipart/form-data"}});g.status==200?v.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):v.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const B=await g.data.url;window.location.href=`http://115.124.120.251:5064/static/downloads/${B}`}catch(g){console.error("Error saving PDF file:",g)}})},Fe=e=>{if(e&&e.data&&e.dataIndex>=0&&h[e.dataIndex]){const a=h[e.dataIndex].officeId,s=h[e.dataIndex].officeType,r=h[e.dataIndex].officeName;s==="Company"?(W(!1),J(t=>[...t,{selectedOffice:L,isAdmin:fe,selectedOfficeNameLocal:x}]),ne(t=>[...t,ge]),P({state:!0,Ovalue:a}),A(r),O(r),T(a),I(6),V(a),se(!0),K(!0)):L!==a&&(P({state:!0,Ovalue:a}),O(r),T(a),I(0))}},Ne=()=>{if(N.length>0){W(!1);const e=N.pop(),a=ae.pop();P({state:!0,Ovalue:a}),A(e.selectedOfficeNameLocal),O(e.selectedOfficeNameLocal),T(e.selectedOffice),V(a),I(e.isAdmin),J([...N]),ne([...ae]),N.length===0&&K(!1)}},ke=()=>{W(!1),T(b.officeId),P({state:!0,Ovalue:b.officeId}),I(b.adminStatus),V(b.officeId),A(b.userOfficeName),O(b.userOfficeName),J([]),se(!1),K(!1)},je=()=>{z(!M)},R=e=>{if(!e)return"";const a=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${s}-${a}`},Q=(e,a)=>window.innerWidth>500||e.length<=a?e:e.substring(0,a)+"...";return o.jsxs("div",{className:`${i.chartContainer} ${c==="dark"?i.darkMode:i.lightMode}`,children:[o.jsx(Ue,{position:"top-center",theme:c}),o.jsx("div",{className:"container-fluid",children:o.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[o.jsxs("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${c==="dark"?i.darkMode:i.lightMode}`,children:[n("Sales")," ",n("of")," ",Q(x,10)]}),xe?o.jsx("div",{title:"Reset",className:i.resetButtonContainer,children:o.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ke,children:o.jsx(ze,{style:{fontSize:"1rem"}})})}):null,me&&N.length>0?o.jsx("div",{title:"Previous",className:i.resetButtonContainer,children:o.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:Ne,children:o.jsx(We,{style:{fontSize:"1rem"}})})}):null,o.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:U,children:o.jsxs("div",{className:`${i.iconsContainer} d-flex justify-content-center align-items-center`,children:[o.jsx("div",{className:`${i.icon} ${c==="dark"?i.darkMode:i.lightMode} px-2 py-1`,onClick:je,children:M?o.jsx(Ee,{style:{fontSize:"1.1rem"}}):o.jsx(Re,{style:{fontSize:"1.1rem"}})}),M&&o.jsxs("div",{className:`${i.exportOptions} ${c==="dark"?i.darkMode:i.lightMode}`,ref:Y,children:[F?o.jsxs("div",{className:i.exportOption,onClick:()=>{oe(!F),z(!1)},children:[o.jsx(Le,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),o.jsx("span",{children:n("View Graph")})]}):o.jsxs("div",{className:i.exportOption,onClick:()=>{oe(!F),z(!1)},children:[o.jsx(He,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),o.jsx("span",{children:n("View Table")})]}),o.jsxs("div",{className:i.exportOption,onClick:ve,children:[o.jsx(Ge,{style:{fontSize:"1.1rem",color:"green"}}),o.jsx("span",{children:n("Export to Excel")})]}),o.jsxs("div",{className:i.exportOption,onClick:Ce,children:[o.jsx(Ae,{style:{fontSize:"1.1rem",color:"red"}}),o.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),te&&o.jsx("div",{className:i.NoDataOverlay,children:o.jsx("img",{src:Ye,alt:"Loading...",width:50,height:50})}),q.length==1&&!F&&!te?o.jsx("div",{className:`${i.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",F?o.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"342px"},children:o.jsxs("table",{className:`table ${c=="dark"?"table-dark":""}`,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",children:"#"}),o.jsx("th",{scope:"col",children:n("Office")}),o.jsxs("th",{scope:"col",children:[n("Sales"),"(₹)"]})]})}),o.jsx("tbody",{children:q.map((e,a)=>o.jsxs("tr",{children:[o.jsx("th",{scope:"row",children:q.length-1===a?"":a+1}),o.jsx("td",{children:e.officeName}),o.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):o.jsx(Me,{option:_e,style:{height:"350px",width:"100%",maxWidth:"2300px"},onEvents:{click:Fe},className:c==="dark"?i.darkMode:i.lightMode})]})};export{Ft as default};
