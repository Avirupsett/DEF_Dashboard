import{_ as K}from"./index-ef582c05.js";import{r as c,u as ye,j as t,G as ge,H as we,h as be,z as _e,A as Se,I as ve,C as Ce,E as je,a as R}from"./vendor-257ea584.js";import{l as Fe,E as ke,a as Q,F as Ne}from"./index-520e0e8e.js";const Oe="_chartContainer_ew0vy_1",Te="_lightMode_ew0vy_47",Be="_dateFilter_ew0vy_51",$e="_officefilter_ew0vy_207",Ee="_topContainer_ew0vy_299",De="_darkMode_ew0vy_319",ze="_iconsContainer_ew0vy_487",Pe="_icon_ew0vy_487",We="_exportOptions_ew0vy_571",Ie="_exportOption_ew0vy_571",He="_NoDataOverlay_ew0vy_659",Le="_tableContainer_ew0vy_849",Re="_table_ew0vy_849",Ae="_summaryHeader_ew0vy_885",Ge="_periodHeader_ew0vy_893",Ve="_closeButton_ew0vy_925",Ye="_tableWrapper_ew0vy_955",Me="_loadingOverlay_ew0vy_963",Ue="_loadingSpinner_ew0vy_989",Je="_boldOption_ew0vy_1001",Xe="_optionGroup_ew0vy_1011",qe="_resetButtonContainer_ew0vy_1039",Ke="_resetButton_ew0vy_1039",s={chartContainer:Oe,lightMode:Te,"label-text":"_label-text_ew0vy_47",dateFilter:Be,officefilter:$e,topContainer:Ee,darkMode:De,"theme-container":"_theme-container_ew0vy_329",iconsContainer:ze,icon:Pe,exportOptions:We,exportOption:Ie,NoDataOverlay:He,tableContainer:Le,table:Re,summaryHeader:Ae,periodHeader:Ge,closeButton:Ve,tableWrapper:Ye,loadingOverlay:Me,loadingSpinner:Ue,boldOption:Je,optionGroup:Xe,resetButtonContainer:qe,resetButton:Ke},ot=({themeMode:l,selectedRange:x,selectedOffice:C,isAdmin:B,SelectedOfficeName:Qe,setSelectedOffice:$,setIsAdmin:E,setCompanies:Z,setWholesales:ee,setRetails:te,originallist:j,setOfficeIdLocal:D,officeIdLocal:oe,setOptionvalue:A})=>{const[h,ae]=c.useState([]),[z,F]=c.useState(!1),P=c.useRef(null),W=c.useRef(null),[G,g]=c.useState(!0),[w,V]=c.useState(!1),[Y,se]=c.useState([]),[b,I]=c.useState([]),[M,U]=c.useState([]),[ne,H]=c.useState(!1),[re,J]=c.useState(!1),[ie,k]=c.useState(!0),{t:r}=ye();r("Office"),`${r("Sales")}`,r("Rows"),c.useEffect(()=>{const e=a=>{P.current&&!P.current.contains(a.target)&&W.current&&!W.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&F(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const X=e=>{g(!0);const a=y(x[0]),d=y(x[1]);R.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${a}/${d}/${C}/${B}`).then(i=>{const{data:o}=i;if(o.graph1){let p=[],f=[];for(let n=0;n<o.graph1.length;n++)p.push({officeId:o.graph1[n].officeId,officeName:o.graph1[n].officeName,officeType:o.graph1[n].officeType,sales:o.graph1[n].totalIncome.toFixed(2),color:o.graph1[n].officeTypeColor}),f.push({officeName:o.graph1[n].officeName,sales:o.graph1[n].totalIncome.toFixed(2)});f.push({officeName:"Total",sales:p.reduce((n,m)=>n+parseFloat(m.sales),0).toFixed(2)}),ae(p),e===1&&(Z(p.filter(n=>n.officeType==="Company")),ee(p.filter(n=>n.officeType==="Wholesale Pumps")),te(p.filter(n=>n.officeType==="Retail Pumps")),setTimeout(()=>{k(!0)},2e3)),se(f)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{g(!1)})};c.useEffect(()=>{x&&C&&X(ie?0:1)},[x,C,B]);const le={title:{textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${r("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:h.map(e=>e.officeName),axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?r("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:l==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:h.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:h.length<=5,position:"right",color:l==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},q=e=>{let a="";const d=new Uint8Array(e),i=d.byteLength;for(let o=0;o<i;o++)a+=String.fromCharCode(d[o]);return window.btoa(a)},ce=async()=>{const e=y(x[0]),a=y(x[1]),d=await K(()=>import("./exceljs.min-d3f5f5bd.js").then(u=>u.e),["assets/exceljs.min-d3f5f5bd.js","assets/vendor-257ea584.js"]),i=new d.Workbook,o=i.addWorksheet("Total Sales by Office"),p=await R.get(Q,{responseType:"arraybuffer"}),f=q(p.data),n=i.addImage({base64:f,extension:"png"});o.addImage(n,{tl:{col:0,row:0},ext:{width:100,height:60}});const m=o.getCell("A1");m.value=r("Total Sales by Business Entity"),m.font={bold:!0,color:{argb:"000000"},size:14},m.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:B1");const _=o.getCell("A2");_.value=`${r("Period")}: ${e} ${r("to")} ${a}`,_.font={bold:!0,color:{argb:"000000"},size:12},_.alignment={horizontal:"center"},o.mergeCells("A2:B2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const L=o.addRow([r("Office Name"),r("Sales")]);L.font={bold:!0},h.forEach(u=>{o.addRow([u.officeName,u.sales])});const N=o.addRow([r("Total"),""]);N.font={bold:!0,color:{argb:"000000"},size:12};const O=h.reduce((u,v)=>u+parseFloat(v.sales),0),S=o.getCell(`B${N.number}`);S.value=`â‚¹${O}`,S.numFmt="0.00",S.alignment={horizontal:"right"},i.xlsx.writeBuffer().then(u=>{const v=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Ne.saveAs(v,"total_sales_by_office.xlsx")})},de=async()=>{const e=y(x[0]),a=y(x[1]),d=await R.get(Q,{responseType:"arraybuffer"}),i=q(d.data);K(()=>import("./index-520e0e8e.js").then(o=>o.j),["assets/index-520e0e8e.js","assets/vendor-257ea584.js","assets/index-ef582c05.js","assets/index-4da97eed.css"]).then(o=>{let p=o.default;const f=new p,n=i,m=35,_=20;f.addImage(n,"PNG",15,9,m,_);const L=[["Total Sales by Business Entity"]];f.autoTable({startY:27,head:L,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const N=[[`"Period": ${e} "to" ${a}`]];f.autoTable({startY:36,head:N,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const O=h.map(T=>[T.officeName,T.sales]),S=h.reduce((T,me)=>T+parseFloat(me.sales),0);O.push(["Total",`${S.toFixed(2)}`]);const u=["Office Name","Sales"],v={1:{halign:"right"},2:{halign:"right"}},xe={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};f.autoTable(u,O,{startY:45,headStyles:xe,columnStyles:v}),f.save("total_sales_by_office.pdf")})},fe=e=>{if(e&&e.data&&e.dataIndex>=0&&h[e.dataIndex]){const a=h[e.dataIndex].officeId;h[e.dataIndex].officeType==="Company"&&(k(!1),g(!0),I(i=>[...i,{selectedOffice:C,isAdmin:B}]),U(i=>[...i,oe]),$(a),E(6),D(a),J(!0),H(!0))}},he=()=>{if(b.length>0){k(!1);const e=b.pop(),a=M.pop();g(!0),A({state:!0,Ovalue:a}),$(e.selectedOffice),D(a),E(e.isAdmin),I([...b]),U([...M]),b.length===0&&H(!1)}},pe=()=>{k(!1),g(!0),$(j.officeId),A({state:!0,Ovalue:j.officeId}),E(j.adminStatus),D(j.officeId),I([]),J(!1),H(!1)},ue=()=>{F(!z)},y=e=>{if(!e)return"";const a=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${a}-${d}-${i}`};return t.jsxs("div",{className:`${s.chartContainer} ${l==="dark"?s.darkMode:s.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${l==="dark"?s.darkMode:s.lightMode}`,children:r("Total Sales by Business Entity")}),re?t.jsx("div",{title:"Reset",className:s.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:pe,children:t.jsx(ge,{style:{fontSize:"1rem"}})})}):null,ne&&b.length>0?t.jsx("div",{title:"Previous",className:s.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:he,children:t.jsx(we,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:P,children:t.jsxs("div",{className:`${s.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${s.icon} ${l==="dark"?s.darkMode:s.lightMode} px-2 py-1`,onClick:ue,children:z?t.jsx(be,{style:{fontSize:"1.1rem"}}):t.jsx(_e,{style:{fontSize:"1.1rem"}})}),z&&t.jsxs("div",{className:`${s.exportOptions} ${l==="dark"?s.darkMode:s.lightMode}`,ref:W,children:[w?t.jsxs("div",{className:s.exportOption,onClick:()=>{V(!w),F(!1)},children:[t.jsx(ve,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:r("View Graph")})]}):t.jsxs("div",{className:s.exportOption,onClick:()=>{V(!w),F(!1)},children:[t.jsx(Se,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:r("View Table")})]}),t.jsxs("div",{className:s.exportOption,onClick:ce,children:[t.jsx(Ce,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:r("Export to Excel")})]}),t.jsxs("div",{className:s.exportOption,onClick:de,children:[t.jsx(je,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:r("Export to PDF")})]})]})]})})]})}),G&&t.jsx("div",{className:s.NoDataOverlay,children:t.jsx("img",{src:Fe,alt:"Loading...",width:50,height:50})}),Y.length==1&&!w&&!G?t.jsx("div",{className:`${s.NoDataOverlay} fs-5`,children:r("No Data Found")}):"",w?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"291px"},children:t.jsxs("table",{className:`table ${l=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:r("Office")}),t.jsxs("th",{scope:"col",children:[r("Sales"),"(â‚¹)"]})]})}),t.jsx("tbody",{children:Y.map((e,a)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:a+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx(ke,{option:le,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:fe},className:l==="dark"?s.darkMode:s.lightMode})]})};export{ot as default};
