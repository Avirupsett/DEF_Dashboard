import{r as s,u as $,j as e}from"./vendor-d1a31163.js";import{D as A,T as C,a as S,b as p,c as x,M as k,C as E,P as U}from"./MetricsCard-551bc132.js";import{M as R,B as v}from"./Box-f65f2bf3.js";import L from"./MapComponent-f6e63738.js";import{I as P,B as I}from"./index.esm-7adca8f5.js";import{a as O}from"./axios-d9b95618.js";import{T as g}from"./Tab-e259bd25.js";import"./installSVGRenderer-7788c1a1.js";import"./extendSxProp-4fc022a8.js";import"./react-is.production.min-ec3da07b.js";import"./useTheme-55d19bd2.js";import"./createSvgIcon-a8b447bb.js";function ee(){const[a,u]=s.useState({distanceCovered:0,drivingTime:0,idleTime:0,averageSpeed:0,profile:{driverName:"",driverLicenceNo:"",driverContactNo:""},graph1:{totalTankFuel:0,fuelUnloaded:0},graph2:{totalJob:0,jobCompleted:0},prevJourney:[],myTrip:[],alltime:{distanceCovered:0,drivingTime:0,idleTime:0,averageSpeed:0},currentDeliveredPlanId:0}),[i,b]=s.useState(!0),[d,D]=s.useState(!1),[n,J]=s.useState(!0),[f,j]=s.useState("1"),[y,T]=s.useState([]),h=new URLSearchParams(window.location.search),{t,i18n:M}=$(),N=async()=>{try{M.changeLanguage(h.get("lang")||"en");let l="";const r=h.get("jwtToken");r&&(l=JSON.parse(atob(r.split(".")[1])));const w=h.get("driverId");if(w){let o=await O.get(`https://dev-def-dash-route-api.inspirigenceworks.co.in/api/v1/dashboard/driver/metrics/${w}`);const{data:m}=o;o.data&&b(!1),u(m)}else if(l){const o=l.sub;if(o){let m=await O.get(`https://dev-def-dash-route-api.inspirigenceworks.co.in/api/v1/dashboard/driver/metrics/${o}`);const{data:F}=m;m.data&&b(!1),u(F)}}}catch(l){console.log(l),b(!1)}};s.useEffect(()=>{N();const l=setInterval(N,3e5);return()=>clearInterval(l)},[]);const[c,B]=s.useState(window.innerWidth);return s.useEffect(()=>{const l=()=>{B(window.innerWidth)};return window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),e.jsxs("div",{className:"d-flex align-items-start justify-content-between",children:[e.jsxs("div",{className:" mx-0 align-items-start ",style:{width:c>950?"60%":"100%",overflowY:"scroll",height:"99vh"},children:[e.jsxs("div",{className:"fs-4 mt-3 fw-bolder px-xl-5 px-lg-4 px-md-3 px-2",style:{color:"#15283b"},children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[a.profile.driverName,e.jsx("div",{className:"px-2 py-1 rounded-2 fs-6 mx-2",style:{backgroundColor:"rgb(37, 99, 235,0.1)",color:"rgb(37, 99, 235)",letterSpacing:"1px"},children:"Driver"}),e.jsx("div",{className:"spinner-border text-primary ",role:"status",style:{display:i?"block":"none"}})]}),e.jsx("a",{href:`tel:${a.profile.driverContactNo}`,style:{cursor:"pointer"},children:e.jsx(R,{className:"fs-3",style:{color:"rgb(37, 99, 235)",cursor:"pointer"}})})]}),e.jsx("hr",{style:{borderColor:"rgb(37, 99, 235)",borderWidth:"2px",marginBottom:"5px",marginTop:"10px"}})]}),e.jsx(A,{distanceCovered:a.alltime.distanceCovered,drivingTime:a.alltime.drivingTime,idleTime:a.alltime.idleTime,averageSpeed:a.alltime.averageSpeed}),e.jsx("div",{style:{display:c<=950?"block":"none"},children:e.jsx(v,{sx:{width:"100%"},children:e.jsxs(C,{value:f,children:[e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(S,{centered:!0,onChange:(l,r)=>j(r),"aria-label":"lab API tabs example",children:[e.jsx(g,{disabled:!!i,className:"fw-bold fs-5",label:"Stats",value:"1"}),e.jsx(g,{disabled:!!i,className:"fw-bold fs-5",label:"Map",value:"2"})]})}),e.jsxs(p,{value:"1",className:"px-0",children:[e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1",style:{color:"#15283b"},children:[e.jsx(P,{className:"fs-2",style:{marginBottom:"4px",verticalAlign:"bottom",marginRight:"8px",color:"rgb(37, 99, 235)"}}),t("Stats For Ongoing Trip")]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-around",children:[e.jsx(x,{title:"Tanker Fuel Level",filllevel:a.graph1.totalTankFuel-a.graph1.fuelUnloaded,emptylevel:a.graph1.fuelUnloaded,fillTitle:"Fuel Left",emptyTitle:"Fuel Unloaded"}),e.jsx(x,{title:"Jobs Completed",emptylevel:a.graph2.totalJob-a.graph2.jobCompleted,filllevel:a.graph2.jobCompleted,fillTitle:"Job Done",emptyTitle:"Job Left"})]}),e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1 mt-3",style:{color:"#15283b"},children:[e.jsx(I,{className:"fs-2",style:{marginLeft:"2px",marginBottom:"4px",display:"inline-block",verticalAlign:"bottom",marginRight:"10px",color:"rgb(37, 99, 235)"}}),t("Current Metrics")]}),e.jsx(k,{distanceCovered:a.distanceCovered,drivingTime:a.drivingTime,idleTime:a.idleTime,averageSpeed:a.averageSpeed})]}),e.jsx(p,{value:"2",className:"p-0",children:e.jsx("div",{className:"",style:{height:c>950?"88vh":"50vh"},children:e.jsx(L,{deliveryPlanId:a.currentDeliveredPlanId,mapComponentData:y,setMapComponentData:T})})})]})})}),e.jsx("div",{className:"accordion px-xl-5 px-lg-4 px-md-3 px-2 mt-3",children:e.jsxs("div",{className:"accordion-item ",children:[e.jsx("h2",{className:"accordion-header",id:"headingOne",children:e.jsx("button",{onClick:()=>D(!d),className:`accordion-button ${d?"collapsed":""} fs-4`,type:"button",style:{color:d?"#15283b":"rgb(37, 99, 235)"},"data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne",children:t("Ongoing Trip")})}),e.jsx("div",{id:"collapseOne",className:`accordion-collapse collapse ${d?"":"show"}`,"aria-labelledby":"headingOne","data-bs-parent":"#accordionExample",children:e.jsx("div",{className:"accordion-body p-1 py-2",children:e.jsx("div",{className:"",children:e.jsx(E,{currentTrip:a.myTrip})})})})]})}),e.jsx("div",{className:"accordion px-xl-5 px-lg-4 px-md-3 px-2 mt-3 mb-3",children:e.jsxs("div",{className:"accordion-item ",children:[e.jsx("h2",{className:"accordion-header",id:"headingOne",children:e.jsx("button",{onClick:()=>J(!n),className:`accordion-button ${n?"collapsed":""} fs-4`,type:"button",style:{color:n?"#15283b":"rgb(37, 99, 235)"},"data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne",children:t("Previous Trip")})}),e.jsx("div",{id:"collapseOne",className:`accordion-collapse collapse ${n?"":"show"}`,"aria-labelledby":"headingOne","data-bs-parent":"#accordionExample",children:e.jsx("div",{className:"accordion-body p-1 py-2",children:e.jsx("div",{className:"",children:e.jsx(U,{prevJourney:a.prevJourney})})})})]})})]}),e.jsx("div",{style:{width:"40%",display:c>950?"block":"none"},children:e.jsx("div",{className:"p-2 pt-2 mx-1 my-1  rounded-3",style:{boxShadow:"rgba(0, 0, 0, 0.075) 0.1rem 0.1rem 1rem 2px",backgroundColor:"white",position:"relative",marginTop:"0px"},children:e.jsx(v,{sx:{width:"100%"},children:e.jsxs(C,{value:f,children:[e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(S,{centered:!0,onChange:(l,r)=>j(r),"aria-label":"lab API tabs example",children:[e.jsx(g,{disabled:!!i,className:"fw-bold fs-5",label:"Stats",value:"1"}),e.jsx(g,{disabled:!!i,className:"fw-bold fs-5",label:"Map",value:"2"})]})}),e.jsxs(p,{value:"1",className:"px-0",children:[e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1",style:{color:"#15283b"},children:[e.jsx(P,{className:"fs-2",style:{marginBottom:"4px",verticalAlign:"bottom",marginRight:"8px",color:"rgb(37, 99, 235)"}}),t("Stats For Ongoing Trip")]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-around",children:[e.jsx(x,{title:"Tanker Fuel Level",filllevel:a.graph1.totalTankFuel-a.graph1.fuelUnloaded,emptylevel:a.graph1.fuelUnloaded,fillTitle:"Fuel Left",emptyTitle:"Fuel Unloaded"}),e.jsx(x,{title:"Jobs Completed",emptylevel:a.graph2.totalJob-a.graph2.jobCompleted,filllevel:a.graph2.jobCompleted,fillTitle:"Job Done",emptyTitle:"Job Left"})]}),e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1 mt-3",style:{color:"#15283b"},children:[e.jsx(I,{className:"fs-2",style:{marginLeft:"2px",marginBottom:"4px",display:"inline-block",verticalAlign:"bottom",marginRight:"10px",color:"rgb(37, 99, 235)"}}),t("Current Metrics")]}),e.jsx(k,{distanceCovered:a.distanceCovered,drivingTime:a.drivingTime,idleTime:a.idleTime,averageSpeed:a.averageSpeed})]}),e.jsx(p,{value:"2",className:"p-0",children:e.jsx("div",{className:"",style:{height:"88vh"},children:e.jsx(L,{deliveryPlanId:a.currentDeliveredPlanId,mapComponentData:y,setMapComponentData:T})})})]})})})})]})}export{ee as default};
