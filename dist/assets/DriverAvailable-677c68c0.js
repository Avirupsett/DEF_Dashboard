import{r,j as e,e as z,t as y,f as W,u as J}from"./vendor-d1a31163.js";import{r as m}from"./index-536690ae.js";import{F as _,a as G,c as q}from"./axios-d9b95618.js";import{a as K,B as V}from"./Box-f65f2bf3.js";import{Q as E,k as X}from"./react-toastify.esm-34a8b48c.js";import{T as Y}from"./ThemeProvider-68b9b4a4.js";import{F as Z,S as ee,M as O}from"./Select-006978da.js";import{I as se}from"./InputLabel-0d786470.js";/* empty css                      */import"./extendSxProp-4fc022a8.js";import"./createSvgIcon-a8b447bb.js";import"./react-is.production.min-ec3da07b.js";import"./useTheme-55d19bd2.js";const te="_viewbutton_ynk9f_29",ae="_assignbutton_ynk9f_37",M={viewbutton:te,assignbutton:ae},re=({data:f,deliveryPlanId:i,updatedBy:j,token:g})=>{const[S,x]=r.useState("all"),N=r.useMemo(()=>[{Header:"Sl No",accessor:(t,s)=>s+1,Cell:({cell:t})=>e.jsx("div",{className:"px-2 fw-bold ",style:{color:"#3B82F6",border:"1px solid #3B82F6",borderRadius:"50%",width:"fit-content"},children:t.value})},{Header:"Driver Name",accessor:"driverName",Cell:({cell:t,row:s})=>e.jsxs("div",{className:"",style:{},children:[t.value," ",s.original.DeliveryPlanStatus?e.jsx("span",{className:"p-2 py-1 rounded-3",style:{backgroundColor:"#EDE9FE",color:"#7C3AED"},children:s.original.DeliveryPlanStatus}):e.jsx(e.Fragment,{})]})},{Header:"Contact No",accessor:"contactNumber"},{Header:"Lic. No",accessor:"licenceNo"},{Header:"Status",accessor:"assigned",Cell:({cell:t,row:s})=>t.value&&s.original.deliveryPlanId===i?e.jsxs("div",{className:"p-2 py-1 d-flex align-items-center",style:{color:"rgb(133 77 14 /1)",backgroundColor:" rgb(254 240 138/50%)",borderRadius:"8px",letterSpacing:".5px",width:"fit-content"},children:[e.jsx(_,{className:"me-1"})," Busy"]}):t.value?e.jsxs("div",{className:"p-2 py-1 d-flex align-items-center",style:{color:"rgb(133 77 14 /1)",backgroundColor:" rgb(254 240 138/50%)",borderRadius:"8px",letterSpacing:".5px",width:"fit-content"},children:[e.jsx(_,{className:"me-1"})," Busy"]}):e.jsxs("div",{className:"p-2 py-1 d-flex align-items-center",style:{color:"rgb(22 101 52/1)",backgroundColor:" rgb(187 247 208/50%)",borderRadius:"8px",letterSpacing:".5px",width:"fit-content"},children:[e.jsx(_,{className:"me-1"})," Available"]})},{Header:"Stats",id:"stats",Cell:({cell:t,row:s})=>e.jsxs("button",{className:`ps-2 pe-3 py-1 rounded-3 fs-6 btn ${M.viewbutton}`,style:{color:"#6366F1",border:"2px solid #6366F1"},onClick:()=>F(s.original.driverId,s.original.DeliveryPlanStatus,s.original.DeliveryPlanStatusId,s.original.assigned,s.original.deliveryPlanId),children:[e.jsx(K,{className:"me-1"})," View"]})},{Header:"Action",accessor:"assigned",id:"action",Cell:({cell:t,row:s})=>t.value?s.original.deliveryPlanId==i?e.jsx("div",{className:"fs-5 fw-bold",style:{color:"#3B82F6"},children:"Assigned"}):e.jsx(e.Fragment,{}):e.jsx("button",{className:`px-3 py-1 text-white rounded-3 fs-6 btn ${M.assignbutton}`,style:{backgroundColor:"#3B82F6"},onClick:()=>P(s.original.driverId),children:"Assign"})}],[]),n=z(),F=(t,s,h,Q,U)=>{Q&&U===i?n("/driverdashboardweb/"+t,{state:{isback:!1,status:s,statusId:h,token:g}}):n("/driverdashboardweb/"+t,{state:{isback:!0,status:s,statusId:h,token:g}})},P=async t=>{const s=E.loading("Assigning...");await G.post("https://dev-def-pumps-api.inspirigenceworks.co.in/api/DeliveryPlan/AssignDriver",{deliveryPlanId:i,driverId:t,updatedBy:j}).then(h=>{E.update(s,{render:"Assigned Successfully",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}),n("/driverdashboardweb/"+t,{state:{isback:!1,statusId:3}})}).catch(h=>{E.update(s,{render:"Assigned Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1})})},{getTableProps:C,getTableBodyProps:k,headerGroups:w,page:o,prepareRow:b,state:A,setGlobalFilter:B,gotoPage:d,nextPage:I,previousPage:D,canNextPage:l,canPreviousPage:c,pageOptions:L,pageCount:R,setPageSize:$,setFilter:a}=m.useTable({columns:N,data:f,initialState:{pageIndex:0,pageSize:10}},m.useFilters,m.useGlobalFilter,m.useSortBy,m.usePagination),{globalFilter:u,pageIndex:T,pageSize:p}=A,H=(t,s)=>{s==="all"?a("assigned",""):a("assigned",s)},v=q({});return e.jsxs("div",{className:"my-2",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx("div",{className:"d-flex",children:e.jsx("input",{type:"text",className:"form-control ms-3 my-2",placeholder:"Search","aria-label":"Search",value:u||"",onChange:t=>B(t.target.value)})}),e.jsx("div",{className:"d-flex my-2 me-3 ms-2",children:e.jsx(Y,{theme:v,children:e.jsx(V,{sx:{minWidth:120},children:e.jsxs(Z,{sx:{mx:1,mt:1,minWidth:180},size:"small",children:[e.jsx(se,{className:"px-1",id:"demo-simple-select-helper-label",style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important',backgroundColor:"white"},children:y("Status")}),e.jsxs(ee,{labelId:"demo-simple-select-standard-label",id:"demo-simple-select-standard",displayEmpty:!0,value:S,onChange:t=>{x(t.target.value),H(o,t.target.value)},style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},selectprops:{MenuProps:{MenuListProps:{className:M.menu}}},children:[e.jsx(O,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"all",children:y("All")}),e.jsx(O,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"true",children:y("Busy")}),e.jsx(O,{style:{color:"var(--text-color)",fontFamily:'"Public Sans", sans-serif !important'},value:"false",children:y("Available")})]})]})})})})]}),e.jsxs("div",{className:"rounded-3 mx-3 overflow-x-auto",style:{border:"2px solid #F4F4F5",boxShadow:"rgba(0, 0, 0, 0.075) 0.1rem 0.1rem 1rem 2px"},children:[e.jsxs("table",{...C(),style:{width:"100%"},children:[e.jsx("thead",{className:"",children:w.map(t=>e.jsx("tr",{style:{backgroundColor:"#3B82F6"},...t.getHeaderGroupProps(),children:t.headers.map(s=>e.jsxs("th",{className:"fs-5 text-white px-2 py-2",...s.getHeaderProps(s.getSortByToggleProps()),children:[s.render("Header"),e.jsx("span",{children:s.isSorted?s.isSortedDesc?" ↑":" ↓":""})]}))}))}),e.jsx("tbody",{...k(),children:o.map(t=>(b(t),e.jsx("tr",{...t.getRowProps(),children:t.cells.map(s=>e.jsx("td",{className:"px-2 fs-6 py-2",...s.getCellProps(),children:s.render("Cell")}))})))})]}),o.length===0&&e.jsx("div",{className:"text-center py-3 fs-6",style:{color:"#4B5563"},children:"No Records found..."})]}),e.jsxs("div",{className:"d-flex justify-content-center align-items-center flex-column",children:[e.jsxs("span",{className:"py-2 fs-6",children:["Page"," ",e.jsxs("strong",{children:[T+1," of ",L.length]})," "]}),e.jsx("div",{}),e.jsxs("div",{className:"d-flex justify-content-center fs-5",children:[e.jsx("button",{className:"mx-1 px-2 py-1 text-white rounded-3",style:{backgroundColor:c?"#3B82F6":"#60A5FA"},onClick:()=>d(0),disabled:!c,children:"<<"})," ",e.jsxs("button",{className:"mx-1 px-2 py-1 pe-3 text-white rounded-3",style:{backgroundColor:c?"#3B82F6":"#60A5FA"},onClick:()=>D(),disabled:!c,children:["<"," Prev"]})," ",e.jsxs("button",{className:"mx-1 px-2 py-1 ps-3 text-white rounded-3",style:{backgroundColor:l?"#3B82F6":"#60A5FA"},onClick:()=>I(),disabled:!l,children:["Next ",">"]})," ",e.jsx("button",{className:"mx-1 px-2 py-1 text-white rounded-3",style:{backgroundColor:l?"#3B82F6":"#60A5FA"},onClick:()=>d(R-1),disabled:!l,children:">>"})," "]})]})]})};function he(){const[f,i]=r.useState([]),[j,g]=r.useState(0),[S,x]=r.useState(!0),[N,n]=r.useState(!1),[F,P]=r.useState(""),[C,k]=r.useState(""),[w,o]=r.useState(""),[b,A]=r.useState("false"),B=z(),{state:d}=W(),[I,D]=r.useState(""),l=new URLSearchParams(window.location.search),{t:c,i18n:L}=J();function R(a){return atob(a)}const $=async()=>{try{L.changeLanguage(l.get("lang")||"en");let a="";const u=l.get("token"),T=l.get("tableview");if(A(T),u&&(a=JSON.parse(R(u))),a){const p=a.deliveryPlanId;if(D(a.updatedBy),g(p),p){let H=await G.get(`https://dev-def-dash-route-api.inspirigenceworks.co.in/api/v1/driver_available/${p}`);const{data:v}=H,t=v.driverAvailable.filter(s=>s.deliveryPlanId===p&&s.assigned===!0&&s.driverId===a.driverId);t.length>0&&(P(t[0].driverId),k(t[0].DeliveryPlanStatus),o(t[0].DeliveryPlanStatusId),d&&d.redirect===!1?n(!1):n(!0)),i(v.driverAvailable),x(!1)}}}catch(a){console.log(a),x(!1)}};return r.useEffect(()=>{$()},[]),e.jsxs(e.Fragment,{children:[e.jsx(X,{position:"top-center"}),S?e.jsx("div",{className:"my-3 d-flex justify-content-center align-items-center",children:e.jsx("div",{className:"spinner-border text-primary ",role:"status",style:{}})}):e.jsx(e.Fragment,{children:N&&(b==="false"||b===null)?B(`/driverdashboardweb/${F}`,{state:{isback:!1,status:C,statusId:w,token:l.get("token")}}):e.jsx(re,{data:f,deliveryPlanId:j,updatedBy:I,token:l.get("token")})})]})}export{he as default};
