import{_ as K}from"./index-4665ef4c.js";import{r as c,u as we,j as t,G as _e,H as be,h as Se,z as ve,A as Ce,I as Fe,C as ke,E as Ne,a as R}from"./vendor-1b7ca1de.js";import{l as je,E as Oe,M as Te,a as Q,F as Be}from"./index-cbecf326.js";const $e="_chartContainer_ew0vy_1",Ee="_lightMode_ew0vy_47",De="_dateFilter_ew0vy_51",ze="_officefilter_ew0vy_207",Ie="_topContainer_ew0vy_299",Pe="_darkMode_ew0vy_319",We="_iconsContainer_ew0vy_487",He="_icon_ew0vy_487",Le="_exportOptions_ew0vy_571",Re="_exportOption_ew0vy_571",Ae="_NoDataOverlay_ew0vy_659",Ge="_tableContainer_ew0vy_849",Me="_table_ew0vy_849",Ve="_summaryHeader_ew0vy_885",Ye="_periodHeader_ew0vy_893",Ue="_closeButton_ew0vy_925",Je="_tableWrapper_ew0vy_955",Xe="_loadingOverlay_ew0vy_963",qe="_loadingSpinner_ew0vy_989",Ke="_boldOption_ew0vy_1001",Qe="_optionGroup_ew0vy_1011",Ze="_resetButtonContainer_ew0vy_1039",et="_resetButton_ew0vy_1039",n={chartContainer:$e,lightMode:Ee,"label-text":"_label-text_ew0vy_47",dateFilter:De,officefilter:ze,topContainer:Ie,darkMode:Pe,"theme-container":"_theme-container_ew0vy_329",iconsContainer:We,icon:He,exportOptions:Le,exportOption:Re,NoDataOverlay:Ae,tableContainer:Ge,table:Me,summaryHeader:Ve,periodHeader:Ye,closeButton:Ue,tableWrapper:Je,loadingOverlay:Xe,loadingSpinner:qe,boldOption:Ke,optionGroup:Qe,resetButtonContainer:Ze,resetButton:et},st=({themeMode:l,selectedRange:m,selectedOffice:C,isAdmin:B,SelectedOfficeName:tt,setSelectedOffice:$,setIsAdmin:E,setCompanies:Z,setWholesales:ee,setRetails:te,originallist:F,setOfficeIdLocal:D,officeIdLocal:oe,setOptionvalue:A})=>{const[p,ae]=c.useState([]),[z,k]=c.useState(!1),I=c.useRef(null),P=c.useRef(null),[G,g]=c.useState(!0),[w,M]=c.useState(!1),[V,ne]=c.useState([]),[_,W]=c.useState([]),[Y,U]=c.useState([]),[se,H]=c.useState(!1),[re,J]=c.useState(!1),[ie,N]=c.useState(!0),{t:r}=we(),le=[{name:"officeName",label:r("Office")},{name:"sales",label:`${r("Sales")}(₹)`}],ce={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:r("Rows")}}};c.useEffect(()=>{const e=a=>{I.current&&!I.current.contains(a.target)&&P.current&&!P.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&k(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const X=e=>{g(!0);const a=x(m[0]),d=x(m[1]);R.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${a}/${d}/${C}/${B}`).then(i=>{const{data:o}=i;if(o.graph1){let h=[],f=[];for(let s=0;s<o.graph1.length;s++)h.push({officeId:o.graph1[s].officeId,officeName:o.graph1[s].officeName,officeType:o.graph1[s].officeType,sales:o.graph1[s].totalIncome.toFixed(2),color:o.graph1[s].officeTypeColor}),f.push({officeName:o.graph1[s].officeName,sales:o.graph1[s].totalIncome.toFixed(2)});f.push({officeName:"Total",sales:h.reduce((s,y)=>s+parseFloat(y.sales),0).toFixed(2)}),ae(h),e===1&&(Z(h.filter(s=>s.officeType==="Company")),ee(h.filter(s=>s.officeType==="Wholesale Pumps")),te(h.filter(s=>s.officeType==="Retail Pumps")),setTimeout(()=>{N(!0)},2e3)),ne(f)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{g(!1)})};c.useEffect(()=>{m&&C&&X(ie?0:1)},[m,C,B]);const de={title:{textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${r("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:p.map(e=>e.officeName),axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?r("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:l==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:p.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:p.length<=5,position:"right",color:l==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},q=e=>{let a="";const d=new Uint8Array(e),i=d.byteLength;for(let o=0;o<i;o++)a+=String.fromCharCode(d[o]);return window.btoa(a)},fe=async()=>{const e=x(m[0]),a=x(m[1]),d=await K(()=>import("./exceljs.min-a898dc82.js").then(u=>u.e),["assets/exceljs.min-a898dc82.js","assets/vendor-1b7ca1de.js"]),i=new d.Workbook,o=i.addWorksheet("Total Sales by Office"),h=await R.get(Q,{responseType:"arraybuffer"}),f=q(h.data),s=i.addImage({base64:f,extension:"png"});o.addImage(s,{tl:{col:0,row:0},ext:{width:100,height:60}});const y=o.getCell("A1");y.value=r("Total Sales by Business Entity"),y.font={bold:!0,color:{argb:"000000"},size:14},y.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:B1");const b=o.getCell("A2");b.value=`${r("Period")}: ${e} ${r("to")} ${a}`,b.font={bold:!0,color:{argb:"000000"},size:12},b.alignment={horizontal:"center"},o.mergeCells("A2:B2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const L=o.addRow([r("Office Name"),r("Sales")]);L.font={bold:!0},p.forEach(u=>{o.addRow([u.officeName,u.sales])});const j=o.addRow([r("Total"),""]);j.font={bold:!0,color:{argb:"000000"},size:12};const O=p.reduce((u,v)=>u+parseFloat(v.sales),0),S=o.getCell(`B${j.number}`);S.value=`₹${O}`,S.numFmt="0.00",S.alignment={horizontal:"right"},i.xlsx.writeBuffer().then(u=>{const v=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Be.saveAs(v,"total_sales_by_office.xlsx")})},pe=async()=>{const e=x(m[0]),a=x(m[1]),d=await R.get(Q,{responseType:"arraybuffer"}),i=q(d.data);K(()=>import("./index-cbecf326.js").then(o=>o.j),["assets/index-cbecf326.js","assets/vendor-1b7ca1de.js","assets/index-4665ef4c.js","assets/index-4da97eed.css"]).then(o=>{let h=o.default;const f=new h,s=i,y=35,b=20;f.addImage(s,"PNG",15,9,y,b);const L=[["Total Sales by Business Entity"]];f.autoTable({startY:27,head:L,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const j=[[`"Period": ${e} "to" ${a}`]];f.autoTable({startY:36,head:j,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const O=p.map(T=>[T.officeName,T.sales]),S=p.reduce((T,ge)=>T+parseFloat(ge.sales),0);O.push(["Total",`${S.toFixed(2)}`]);const u=["Office Name","Sales"],v={1:{halign:"right"},2:{halign:"right"}},xe={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};f.autoTable(u,O,{startY:45,headStyles:xe,columnStyles:v}),f.save("total_sales_by_office.pdf")})},he=e=>{if(e&&e.data&&e.dataIndex>=0&&p[e.dataIndex]){const a=p[e.dataIndex].officeId;p[e.dataIndex].officeType==="Company"&&(N(!1),g(!0),W(i=>[...i,{selectedOffice:C,isAdmin:B}]),U(i=>[...i,oe]),$(a),E(6),D(a),J(!0),H(!0))}},ue=()=>{if(_.length>0){N(!1);const e=_.pop(),a=Y.pop();g(!0),A({state:!0,Ovalue:a}),$(e.selectedOffice),D(a),E(e.isAdmin),W([..._]),U([...Y]),_.length===0&&H(!1)}},me=()=>{N(!1),g(!0),$(F.officeId),A({state:!0,Ovalue:F.officeId}),E(F.adminStatus),D(F.officeId),W([]),J(!1),H(!1)},ye=()=>{k(!z)},x=e=>{if(!e)return"";const a=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${a}-${d}-${i}`};return t.jsxs("div",{className:`${n.chartContainer} ${l==="dark"?n.darkMode:n.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${l==="dark"?n.darkMode:n.lightMode}`,children:r("Total Sales by Business Entity")}),re?t.jsx("div",{title:"Reset",className:n.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:me,children:t.jsx(_e,{style:{fontSize:"1rem"}})})}):null,se&&_.length>0?t.jsx("div",{title:"Previous",className:n.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ue,children:t.jsx(be,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:I,children:t.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${n.icon} ${l==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:ye,children:z?t.jsx(Se,{style:{fontSize:"1.1rem"}}):t.jsx(ve,{style:{fontSize:"1.1rem"}})}),z&&t.jsxs("div",{className:`${n.exportOptions} ${l==="dark"?n.darkMode:n.lightMode}`,ref:P,children:[w?t.jsxs("div",{className:n.exportOption,onClick:()=>{M(!w),k(!1)},children:[t.jsx(Fe,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:r("View Graph")})]}):t.jsxs("div",{className:n.exportOption,onClick:()=>{M(!w),k(!1)},children:[t.jsx(Ce,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:r("View Table")})]}),t.jsxs("div",{className:n.exportOption,onClick:fe,children:[t.jsx(ke,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:r("Export to Excel")})]}),t.jsxs("div",{className:n.exportOption,onClick:pe,children:[t.jsx(Ne,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:r("Export to PDF")})]})]})]})})]})}),G&&t.jsx("div",{className:n.NoDataOverlay,children:t.jsx("img",{src:je,alt:"Loading...",width:50,height:50})}),V.length==1&&!w&&!G?t.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:r("No Data Found")}):"",w?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(Te,{data:V,columns:le,options:ce})}):t.jsx(Oe,{option:de,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:he},className:l==="dark"?n.darkMode:n.lightMode})]})};export{st as default};
