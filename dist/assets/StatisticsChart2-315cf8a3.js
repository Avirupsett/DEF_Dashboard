import{_ as B}from"./index-713e4dab.js";import{r as m,j as e,g as q,w as K,x as Q,B as Z,z as tt,A as et,C as ot,l as T}from"./vendor-770ffdd0.js";import{E as at,M as st,l as P,F as nt}from"./index-6738cf0c.js";const lt="_chartContainer_c41sl_1",rt="_lightMode_c41sl_47",it="_dateFilter_c41sl_51",ct="_officefilter_c41sl_207",dt="_topContainer_c41sl_299",ft="_darkMode_c41sl_319",pt="_iconsContainer_c41sl_487",ht="_icon_c41sl_487",mt="_exportOptions_c41sl_571",xt="_exportOption_c41sl_571",gt="_tableContainer_c41sl_831",_t="_table_c41sl_831",bt="_summaryHeader_c41sl_867",ut="_periodHeader_c41sl_875",yt="_closeButton_c41sl_907",wt="_tableWrapper_c41sl_937",St="_loadingOverlay_c41sl_945",Ct="_loadingSpinner_c41sl_971",Ft="_boldOption_c41sl_983",kt="_optionGroup_c41sl_993",a={chartContainer:lt,lightMode:rt,"label-text":"_label-text_c41sl_47",dateFilter:it,officefilter:ct,topContainer:dt,darkMode:ft,"theme-container":"_theme-container_c41sl_329",iconsContainer:pt,icon:ht,exportOptions:mt,exportOption:xt,tableContainer:gt,table:_t,summaryHeader:bt,periodHeader:ut,closeButton:yt,tableWrapper:wt,loadingOverlay:St,loadingSpinner:Ct,boldOption:Ft,optionGroup:kt},Et=({themeMode:i,selectedRange:x,selectedOffice:j,isAdmin:D,SelectedOfficeName:O})=>{const[g,L]=m.useState([]),[v,w]=m.useState(!1),E=m.useRef(null),N=m.useRef(null),[I,$]=m.useState(!0),[S,z]=m.useState(!1),[A,H]=m.useState([]),R=[{name:"officeName",label:"Office"},{name:"sales",label:"Sales(₹)"}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:"Rows"}}};m.useEffect(()=>{const t=n=>{E.current&&!E.current.contains(n.target)&&N.current&&!N.current.contains(n.target)&&n.target.tagName!=="svg"&&n.target.tagName!=="path"&&w(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),m.useEffect(()=>{x&&j&&(()=>{$(!0);const n=b(x[0]),f=b(x[1]);T.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${n}/${f}/${j}/${D}`).then(c=>{const{data:o}=c;let l={};if(o.graph1.forEach(s=>{const{lstOffice:p}=s;p.forEach(r=>{let{officeName:d,totalIncome:_}=r;_!==0&&(l[d]?l[d]+=_:l[d]=_)}),s.totalIncome>0&&p.length==0&&(l[O]?l[O]+=s.totalIncome:l[O]=s.totalIncome)}),l){let s=[],p=[];for(let r in l)s.push({officeName:r,sales:l[r].toFixed(0)}),p.push({officeName:r,sales:l[r].toFixed(2)});p.push({officeName:"Total",sales:s.reduce((r,d)=>r+parseFloat(d.sales),0).toFixed(2)}),H(p),L(s)}}).catch(c=>{console.log("Error fetching data:",c)}).finally(()=>{$(!1)})})()},[x,j,D]);const M={color:["#66BA69"],title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:"<b>Office:</b> {b} <br> <b>Sales:</b> {c} ",textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:g.map(t=>t.officeName),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",fontSize:12,formatter:t=>window.innerWidth<=768?t.length>10?t.substring(0,10)+"...":t:t.length>0?t.substring(0,10)+"...":t}},grid:{left:window.innerWidth<=768?85:100,right:15,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?"Sales":"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:t=>t>=1e3?t/1e3+"k":t,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:g.map(t=>t.sales),label:{show:g.length<=5&&window.innerWidth>768,position:"inside",color:"#fff"}}]},W=t=>{let n="";const f=new Uint8Array(t),c=f.byteLength;for(let o=0;o<c;o++)n+=String.fromCharCode(f[o]);return window.btoa(n)},Y=async()=>{const t=b(x[0]),n=b(x[1]),f=await B(()=>import("./exceljs.min-d8450118.js").then(h=>h.e),["assets/exceljs.min-d8450118.js","assets/vendor-770ffdd0.js"]),c=new f.Workbook,o=c.addWorksheet("Total Sales by Office"),l=await T.get(P,{responseType:"arraybuffer"}),s=W(l.data),p=c.addImage({base64:s,extension:"png"});o.addImage(p,{tl:{col:0,row:0},ext:{width:40,height:40}});const r=o.getCell("A1");r.value="Total Sales by Office",r.font={bold:!0,color:{argb:"000000"},size:14},r.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:C1");const d=o.getCell("A2");d.value=`Period: ${t} to ${n}`,d.font={bold:!0,color:{argb:"000000"},size:12},d.alignment={horizontal:"center"},o.mergeCells("A2:C2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const _=o.addRow(["Office Name","Sales"]);_.font={bold:!0},g.forEach(h=>{o.addRow([h.officeName,h.sales])});const C=o.addRow(["Total",""]);C.font={bold:!0,color:{argb:"000000"},size:12};const F=g.reduce((h,y)=>h+parseFloat(y.sales),0),u=o.getCell(`B${C.number}`);u.value=`₹${F}`,u.numFmt="0.00",u.alignment={horizontal:"right"},c.xlsx.writeBuffer().then(h=>{const y=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});nt.saveAs(y,"total_sales_by_office.xlsx")})},U=async()=>{const t=b(x[0]),n=b(x[1]),f=await T.get(P,{responseType:"arraybuffer"}),c=W(f.data);B(()=>import("./index-6738cf0c.js").then(o=>o.j),["assets/index-6738cf0c.js","assets/vendor-770ffdd0.js","assets/index-713e4dab.js","assets/index-7b634162.css"]).then(o=>{let l=o.default;const s=new l,p=c,r=35,d=20;s.addImage(p,"PNG",15,9,r,d);const _=[["Total Sales by Office"]];s.autoTable({startY:27,head:_,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const C=[[`Period: ${t} to ${n}`]];s.autoTable({startY:36,head:C,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const F=g.map(k=>[k.officeName,parseFloat(k.sales.toFixed(2))]),u=g.reduce((k,X)=>k+parseFloat(X.sales),0);F.push(["Total",`${u.toFixed(2)}`]);const h=["Office Name","Sales"],y={1:{halign:"right"},2:{halign:"right"}},J={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};s.autoTable(h,F,{startY:45,headStyles:J,columnStyles:y}),s.save("total_sales_by_office.pdf")})},V=()=>{w(!v)},b=t=>{if(!t)return"";const n=t.getFullYear(),f=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return`${n}-${f}-${c}`};return e.jsxs("div",{className:`${a.chartContainer} ${i==="dark"?a.darkMode:a.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsx("div",{className:`fw-bold fs-5 ${i==="dark"?a.darkMode:a.lightMode}`,children:"Total Sales by Office"}),e.jsx("div",{className:"d-flex g-0",ref:E,children:e.jsxs("div",{className:`${a.iconsContainer} d-flex justify-content-center align-items-center`,children:[e.jsx("div",{className:`${a.icon} ${i==="dark"?a.darkMode:a.lightMode} px-2 py-1`,onClick:V,children:v?e.jsx(q,{style:{fontSize:"1.1rem"}}):e.jsx(K,{style:{fontSize:"1.1rem"}})}),v&&e.jsxs("div",{className:`${a.exportOptions} ${i==="dark"?a.darkMode:a.lightMode}`,ref:N,children:[S?e.jsxs("div",{className:a.exportOption,onClick:()=>{z(!S),w(!1)},children:[e.jsx(Z,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),e.jsx("span",{children:"Export to Graph"})]}):e.jsxs("div",{className:a.exportOption,onClick:()=>{z(!S),w(!1)},children:[e.jsx(Q,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:"Export to Table"})]}),e.jsxs("div",{className:a.exportOption,onClick:Y,children:[e.jsx(tt,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:"Export to Excel"})]}),e.jsxs("div",{className:a.exportOption,onClick:U,children:[e.jsx(et,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:"Export to PDF"})]})]})]})})]})}),I&&e.jsx("div",{className:a.loadingOverlay,children:e.jsx(ot,{disableShrink:!0})}),S?e.jsx("div",{className:"container-fluid mt-2",children:e.jsx(st,{data:A,columns:R,options:G})}):e.jsx(at,{option:M,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:i==="dark"?a.darkMode:a.lightMode})]})};export{Et as default};
