import{_ as he}from"./index-fa8b92ad.js";import{H as z,r as m,u as $e,j as t,I as Le,J as Re,i as Pe,A as We,B as Ae,K as Ie,E as ze,G as He,a as T}from"./vendor-ff86a3b6.js";import{k as Ue,l as Ge,E as Me,Q as D,a as we,f as Ve,b as qe}from"./NotoSansDevanagari-VariableFont_wdth_wght-133c39b0.js";const Ye="_chartContainer_ew0vy_1",Xe="_lightMode_ew0vy_47",Je="_dateFilter_ew0vy_51",Ke="_officefilter_ew0vy_207",Qe="_topContainer_ew0vy_299",Ze="_darkMode_ew0vy_319",et="_iconsContainer_ew0vy_487",tt="_icon_ew0vy_487",ot="_exportOptions_ew0vy_571",at="_exportOption_ew0vy_571",nt="_NoDataOverlay_ew0vy_659",st="_tableContainer_ew0vy_849",rt="_table_ew0vy_849",it="_summaryHeader_ew0vy_885",lt="_periodHeader_ew0vy_893",ct="_closeButton_ew0vy_925",dt="_tableWrapper_ew0vy_955",ft="_loadingOverlay_ew0vy_963",pt="_loadingSpinner_ew0vy_989",ut="_boldOption_ew0vy_1001",ht="_optionGroup_ew0vy_1011",wt="_resetButtonContainer_ew0vy_1039",yt="_resetButton_ew0vy_1039",l={chartContainer:Ye,lightMode:Xe,"label-text":"_label-text_ew0vy_47",dateFilter:Je,officefilter:Ke,topContainer:Qe,darkMode:Ze,"theme-container":"_theme-container_ew0vy_329",iconsContainer:et,icon:tt,exportOptions:ot,exportOption:at,NoDataOverlay:nt,tableContainer:st,table:rt,summaryHeader:it,periodHeader:lt,closeButton:ct,tableWrapper:dt,loadingOverlay:ft,loadingSpinner:pt,boldOption:ut,optionGroup:ht,resetButtonContainer:wt,resetButton:yt};var mt={exports:{}};(function(c,N){(function(E,_){_()})(z,function(){function E(o,n){return typeof n>"u"?n={autoBom:!1}:typeof n!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function _(o,n,u){var s=new XMLHttpRequest;s.open("GET",o),s.responseType="blob",s.onload=function(){C(s.response,n,u)},s.onerror=function(){console.error("could not download file")},s.send()}function O(o){var n=new XMLHttpRequest;n.open("HEAD",o,!1);try{n.send()}catch{}return 200<=n.status&&299>=n.status}function S(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(n)}}var g=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof z=="object"&&z.global===z?z:void 0,B=g.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),C=g.saveAs||(typeof window!="object"||window!==g?function(){}:"download"in HTMLAnchorElement.prototype&&!B?function(o,n,u){var s=g.URL||g.webkitURL,p=document.createElement("a");n=n||o.name||"download",p.download=n,p.rel="noopener",typeof o=="string"?(p.href=o,p.origin===location.origin?S(p):O(p.href)?_(o,n,u):S(p,p.target="_blank")):(p.href=s.createObjectURL(o),setTimeout(function(){s.revokeObjectURL(p.href)},4e4),setTimeout(function(){S(p)},0))}:"msSaveOrOpenBlob"in navigator?function(o,n,u){if(n=n||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(E(o,u),n);else if(O(o))_(o,n,u);else{var s=document.createElement("a");s.href=o,s.target="_blank",setTimeout(function(){S(s)})}}:function(o,n,u,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof o=="string")return _(o,n,u);var p=o.type==="application/octet-stream",X=/constructor/i.test(g.HTMLElement)||g.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||p&&X||B)&&typeof FileReader<"u"){var F=new FileReader;F.onloadend=function(){var f=F.result;f=b?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=f:location=f,s=null},F.readAsDataURL(o)}else{var H=g.URL||g.webkitURL,j=H.createObjectURL(o);s?s.location=j:location.href=j,s=null,setTimeout(function(){H.revokeObjectURL(j)},4e4)}});g.saveAs=C.saveAs=C,c.exports=C})})(mt);const vt=({themeMode:c,selectedRange:N,selectedOffice:E,isAdmin:_,alldata:O,isLoading:S,SelectedOfficeName:g,setSelectedOfficeName:B,selectedOfficeNameLocal:C,setSelectedOfficeNameLocal:o,setSelectedOffice:n,setIsAdmin:u,setCompanies:s,setWholesales:p,setRetails:X,originallist:b,setOfficeIdLocal:F,officeIdLocal:H,setOptionvalue:j})=>{const[f,ye]=m.useState([]),[J,U]=m.useState(!1),K=m.useRef(null),Q=m.useRef(null),[$,le]=m.useState(!1),[Z,me]=m.useState([]),[L,ee]=m.useState([]),[ce,de]=m.useState([]),[ge,te]=m.useState(!1),[xe,fe]=m.useState(!1),[be,G]=m.useState(!0),{t:r}=$e();r("Office"),`${r("Sales")}`,r("Rows"),m.useEffect(()=>{const e=a=>{K.current&&!K.current.contains(a.target)&&Q.current&&!Q.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&U(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const pe=e=>{let a=[],h=[];O.graph3&&(O.graph3.map(i=>{a.push({officeId:i.officeId,officeName:i.officeName,officeType:i.officeType,sales:i.totalIncome.toFixed(2),color:i.officeTypeColor}),h.push({officeName:i.officeName,sales:i.totalIncome.toFixed(2)})}),h.push({officeName:"Total",sales:a.reduce((i,d)=>i+parseFloat(d.sales),0).toFixed(2)}),e===1&&(s(a.filter(i=>i.officeType==="Company")),p(a.filter(i=>i.officeType==="Wholesale Pumps")),X(a.filter(i=>i.officeType==="Retail Pumps")),G(!0)),ye(a),me(h))};m.useEffect(()=>{N&&E&&pe(be?0:1)},[O]);const ve={title:{textStyle:{color:c==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${r("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?r("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:c==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:f.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:!0,position:"right",color:c==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},M=e=>{let a="";const h=new Uint8Array(e),i=h.byteLength;for(let d=0;d<i;d++)a+=String.fromCharCode(h[d]);return window.btoa(a)},_e=async()=>{const e=D.loading("Please wait..."),a=V(N[0]),h=V(N[1]),i=await he(()=>import("./exceljs.min-e7dcf029.js").then(x=>x.e),["assets/exceljs.min-e7dcf029.js","assets/vendor-ff86a3b6.js"]),d=new i.Workbook,w=d.addWorksheet("Total Sales by Office"),oe=await T.get(we,{responseType:"arraybuffer"}),ae=M(oe.data),ne=d.addImage({base64:ae,extension:"png"});w.addImage(ne,{tl:{col:0,row:0},ext:{width:100,height:60}});const R=w.getCell("A1");R.value=r("Total Sales by Business Entity"),R.font={bold:!0,color:{argb:"000000"},size:14},R.alignment={vertical:"middle",horizontal:"center"},w.mergeCells("A1:C1");const P=w.getCell("A2");P.value=`${r("Period")}: ${a} ${r("to")} ${h}`,P.font={bold:!0,color:{argb:"000000"},size:12},P.alignment={horizontal:"center"},w.mergeCells("A2:B2"),w.getColumn(1).width=50,w.getColumn(2).width=15,w.getColumn(3).width=15;const W=w.addRow([r("Office Name"),r("Sales")]);W.font={bold:!0},f.forEach(x=>{w.addRow([x.officeName,x.sales])});const q=w.addRow([r("Total"),""]);q.font={bold:!0,color:{argb:"000000"},size:12};const y=f.reduce((x,I)=>x+parseFloat(I.sales),0),A=w.getCell(`B${q.number}`);A.value=`â‚¹${y}`,A.numFmt="0.00",A.alignment={horizontal:"right"};const se=Date.now();d.xlsx.writeBuffer().then(async x=>{const I=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Y=new FormData;Y.append("file",I,`${se}_sales_by_office.xlsx`);try{const k=await T.post("https://def-dash-route-api.inspirigenceworks.co.in/api/uploader",Y,{headers:{"Content-Type":"multipart/form-data"}});k.status==200?D.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):D.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const re=k.data.url;window.location.href=`https://def-dash-route-api.inspirigenceworks.co.in/static/downloads/${re}`}catch(k){console.error("Error saving Excel file:",k)}})},Se=async()=>{const e=D.loading("Please wait..."),a=V(N[0]),h=V(N[1]),d=new URLSearchParams(window.location.search).get("lang"),w=await T.get(we,{responseType:"arraybuffer"}),oe=await T.get(Ve,{responseType:"arraybuffer"}),ae=M(oe.data),ne=await T.get(qe,{responseType:"arraybuffer"}),R=M(ne.data),P=M(w.data);he(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-133c39b0.js").then(W=>W.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-133c39b0.js","assets/vendor-ff86a3b6.js","assets/index-fa8b92ad.js","assets/index-4da97eed.css","assets/NotoSansDevanagari-VariableFont_wdth_wght-55fec1ff.css"]).then(async W=>{let q=W.default;const y=new q,A=P,se=35,x=20;y.addImage(A,"PNG",15,9,se,x),y.addFileToVFS("NotoSansBengali.ttf",ae),y.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),y.setFont("NotoSansBengali"),y.addFileToVFS("NotoSansDevanagari.ttf",R),y.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),y.setFont("NotoSansDevanagari");const I=[[r("Total Sales by Business Entity")]];y.autoTable({startY:27,head:I,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const Y=[[`${r("Period")}: ${a} ${r("to")} ${h}`]];y.autoTable({startY:36,head:Y,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const k=f.map(v=>[v.officeName,v.sales]),re=f.reduce((v,ie)=>v+parseFloat(ie.sales),0);k.push([r("Total"),`${re.toFixed(2)}`]);const Oe=[r("Office Name"),r("Sales")],Be={1:{halign:"right"},2:{halign:"right"}},Te={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};y.autoTable(Oe,k,{startY:45,headStyles:Te,columnStyles:Be,styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const De=Date.now(),Ee=y.output("blob"),ue=new FormData;ue.append("file",Ee,`${De}_total_sales_by_office.pdf`);try{const v=await T.post("https://def-dash-route-api.inspirigenceworks.co.in/api/uploader",ue,{headers:{"Content-Type":"multipart/form-data"}});v.status==200?D.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):D.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const ie=await v.data.url;window.location.href=`https://def-dash-route-api.inspirigenceworks.co.in/static/downloads/${ie}`}catch(v){console.error("Error saving PDF file:",v)}})},Ce=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const a=f[e.dataIndex].officeId,h=f[e.dataIndex].officeType,i=f[e.dataIndex].officeName;h==="Company"&&(G(!1),ee(d=>[...d,{selectedOffice:E,isAdmin:_,selectedOfficeNameLocal:C}]),de(d=>[...d,H]),j({state:!0,Ovalue:a}),B(i),o(i),n(a),u(6),F(a),fe(!0),te(!0))}},Fe=()=>{if(L.length>0){G(!1);const e=L.pop(),a=ce.pop();j({state:!0,Ovalue:a}),B(e.selectedOfficeNameLocal),o(e.selectedOfficeNameLocal),n(e.selectedOffice),F(a),u(e.isAdmin),ee([...L]),de([...ce]),L.length===0&&te(!1)}},je=()=>{G(!1),n(b.officeId),j({state:!0,Ovalue:b.officeId}),u(b.adminStatus),F(b.officeId),B(b.userOfficeName),o(b.userOfficeName),ee([]),fe(!1),te(!1)},ke=()=>{U(!J)},V=e=>{if(!e)return"";const a=e.getFullYear(),h=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${a}-${h}-${i}`},Ne=(e,a)=>window.innerWidth>500||e.length<=a?e:e.substring(0,a)+"...";return t.jsxs("div",{className:`${l.chartContainer} ${c==="dark"?l.darkMode:l.lightMode}`,children:[t.jsx(Ue,{position:"top-center",theme:c}),t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsxs("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${c==="dark"?l.darkMode:l.lightMode}`,children:[r("Sales")," ",r("of")," ",Ne(C,10)]}),xe?t.jsx("div",{title:"Reset",className:l.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:je,children:t.jsx(Le,{style:{fontSize:"1rem"}})})}):null,ge&&L.length>0?t.jsx("div",{title:"Previous",className:l.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:Fe,children:t.jsx(Re,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:K,children:t.jsxs("div",{className:`${l.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${l.icon} ${c==="dark"?l.darkMode:l.lightMode} px-2 py-1`,onClick:ke,children:J?t.jsx(Pe,{style:{fontSize:"1.1rem"}}):t.jsx(We,{style:{fontSize:"1.1rem"}})}),J&&t.jsxs("div",{className:`${l.exportOptions} ${c==="dark"?l.darkMode:l.lightMode}`,ref:Q,children:[$?t.jsxs("div",{className:l.exportOption,onClick:()=>{le(!$),U(!1)},children:[t.jsx(Ie,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:r("View Graph")})]}):t.jsxs("div",{className:l.exportOption,onClick:()=>{le(!$),U(!1)},children:[t.jsx(Ae,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:r("View Table")})]}),t.jsxs("div",{className:l.exportOption,onClick:_e,children:[t.jsx(ze,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:r("Export to Excel")})]}),t.jsxs("div",{className:l.exportOption,onClick:Se,children:[t.jsx(He,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:r("Export to PDF")})]})]})]})})]})}),S&&t.jsx("div",{className:l.NoDataOverlay,children:t.jsx("img",{src:Ge,alt:"Loading...",width:50,height:50})}),Z.length==1&&!$&&!S?t.jsx("div",{className:`${l.NoDataOverlay} fs-5`,children:r("No Data Found")}):"",$?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"291px"},children:t.jsxs("table",{className:`table ${c=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:r("Office")}),t.jsxs("th",{scope:"col",children:[r("Sales"),"(â‚¹)"]})]})}),t.jsx("tbody",{children:Z.map((e,a)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:Z.length-1===a?"":a+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx(Me,{option:ve,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:Ce},className:c==="dark"?l.darkMode:l.lightMode})]})};export{vt as default};
