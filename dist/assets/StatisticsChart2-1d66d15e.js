import{_ as K}from"./index-0c958aca.js";import{r as c,u as ve,j as t,G as Ce,H as Ne,h as Fe,z as je,A as ke,I as Be,C as Oe,E as Te,a as k}from"./vendor-257ea584.js";import{l as De,E as $e,a as Q,F as Ee,f as Pe,b as ze}from"./NotoSansDevanagari-VariableFont_wdth_wght-a4894ae6.js";const We="_chartContainer_ew0vy_1",Ie="_lightMode_ew0vy_47",Re="_dateFilter_ew0vy_51",He="_officefilter_ew0vy_207",Le="_topContainer_ew0vy_299",Ae="_darkMode_ew0vy_319",Ge="_iconsContainer_ew0vy_487",Ve="_icon_ew0vy_487",Ye="_exportOptions_ew0vy_571",Me="_exportOption_ew0vy_571",Ue="_NoDataOverlay_ew0vy_659",Je="_tableContainer_ew0vy_849",Xe="_table_ew0vy_849",qe="_summaryHeader_ew0vy_885",Ke="_periodHeader_ew0vy_893",Qe="_closeButton_ew0vy_925",Ze="_tableWrapper_ew0vy_955",et="_loadingOverlay_ew0vy_963",tt="_loadingSpinner_ew0vy_989",ot="_boldOption_ew0vy_1001",at="_optionGroup_ew0vy_1011",nt="_resetButtonContainer_ew0vy_1039",st="_resetButton_ew0vy_1039",s={chartContainer:We,lightMode:Ie,"label-text":"_label-text_ew0vy_47",dateFilter:Re,officefilter:He,topContainer:Le,darkMode:Ae,"theme-container":"_theme-container_ew0vy_329",iconsContainer:Ge,icon:Ve,exportOptions:Ye,exportOption:Me,NoDataOverlay:Ue,tableContainer:Je,table:Xe,summaryHeader:qe,periodHeader:Ke,closeButton:Qe,tableWrapper:Ze,loadingOverlay:et,loadingSpinner:tt,boldOption:ot,optionGroup:at,resetButtonContainer:nt,resetButton:st},dt=({themeMode:i,selectedRange:p,selectedOffice:L,isAdmin:Z,alldata:B,isLoading:A,SelectedOfficeName:rt,setSelectedOffice:O,setIsAdmin:T,setCompanies:ee,setWholesales:te,setRetails:oe,originallist:_,setOfficeIdLocal:D,officeIdLocal:ae,setOptionvalue:G})=>{const[f,ne]=c.useState([]),[$,S]=c.useState(!1),E=c.useRef(null),P=c.useRef(null),[y,V]=c.useState(!1),[Y,se]=c.useState([]),[u,z]=c.useState([]),[M,U]=c.useState([]),[re,W]=c.useState(!1),[ie,J]=c.useState(!1),[le,v]=c.useState(!0),{t:n}=ve();n("Office"),`${n("Sales")}`,n("Rows"),c.useEffect(()=>{const e=a=>{E.current&&!E.current.contains(a.target)&&P.current&&!P.current.contains(a.target)&&a.target.tagName!=="svg"&&a.target.tagName!=="path"&&S(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const X=e=>{let a=[],d=[];B.graph3&&(B.graph3.map(o=>{a.push({officeId:o.officeId,officeName:o.officeName,officeType:o.officeType,sales:o.totalIncome.toFixed(2),color:o.officeTypeColor}),d.push({officeName:o.officeName,sales:o.totalIncome.toFixed(2)})}),d.push({officeName:"Total",sales:a.reduce((o,r)=>o+parseFloat(r.sales),0).toFixed(2)}),e===1&&(ee(a.filter(o=>o.officeType==="Company")),te(a.filter(o=>o.officeType==="Wholesale Pumps")),oe(a.filter(o=>o.officeType==="Retail Pumps")),v(!0)),ne(a),se(d))};c.useEffect(()=>{p&&L&&X(le?0:1)},[B]);const ce={title:{textStyle:{color:i==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${n("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?n("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:i==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:i==="dark"?"#ffffff":"#000000"}},axisLabel:{color:i==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:i==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:f.map((e,a)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:f.length<=5,position:"right",color:i==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},C=e=>{let a="";const d=new Uint8Array(e),o=d.byteLength;for(let r=0;r<o;r++)a+=String.fromCharCode(d[r]);return window.btoa(a)},de=async()=>{const e=N(p[0]),a=N(p[1]),d=await K(()=>import("./exceljs.min-d3f5f5bd.js").then(h=>h.e),["assets/exceljs.min-d3f5f5bd.js","assets/vendor-257ea584.js"]),o=new d.Workbook,r=o.addWorksheet("Total Sales by Office"),I=await k.get(Q,{responseType:"arraybuffer"}),R=C(I.data),H=o.addImage({base64:R,extension:"png"});r.addImage(H,{tl:{col:0,row:0},ext:{width:100,height:60}});const x=r.getCell("A1");x.value=n("Total Sales by Business Entity"),x.font={bold:!0,color:{argb:"000000"},size:14},x.alignment={vertical:"middle",horizontal:"center"},r.mergeCells("A1:B1");const m=r.getCell("A2");m.value=`${n("Period")}: ${e} ${n("to")} ${a}`,m.font={bold:!0,color:{argb:"000000"},size:12},m.alignment={horizontal:"center"},r.mergeCells("A2:B2"),r.getColumn(1).width=50,r.getColumn(2).width=15,r.getColumn(3).width=15;const g=r.addRow([n("Office Name"),n("Sales")]);g.font={bold:!0},f.forEach(h=>{r.addRow([h.officeName,h.sales])});const F=r.addRow([n("Total"),""]);F.font={bold:!0,color:{argb:"000000"},size:12};const l=f.reduce((h,b)=>h+parseFloat(b.sales),0),w=r.getCell(`B${F.number}`);w.value=`â‚¹${l}`,w.numFmt="0.00",w.alignment={horizontal:"right"},o.xlsx.writeBuffer().then(h=>{const b=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Ee.saveAs(b,"total_sales_by_office.xlsx")})},fe=async()=>{const e=N(p[0]),a=N(p[1]),o=new URLSearchParams(window.location.search).get("lang"),r=await k.get(Q,{responseType:"arraybuffer"}),I=await k.get(Pe,{responseType:"arraybuffer"}),R=C(I.data),H=await k.get(ze,{responseType:"arraybuffer"}),x=C(H.data),m=C(r.data);K(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-a4894ae6.js").then(g=>g.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-a4894ae6.js","assets/vendor-257ea584.js","assets/index-0c958aca.js","assets/index-4da97eed.css"]).then(g=>{let F=g.default;const l=new F,w=m,h=35,b=20;l.addImage(w,"PNG",15,9,h,b),l.addFileToVFS("NotoSansBengali.ttf",R),l.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),l.setFont("NotoSansBengali"),l.addFileToVFS("NotoSansDevanagari.ttf",x),l.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),l.setFont("NotoSansDevanagari");const xe=[[n("Total Sales by Business Entity")]];l.autoTable({startY:27,head:xe,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const me=[[`${n("Period")}: ${e} ${n("to")} ${a}`]];l.autoTable({startY:36,head:me,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const q=f.map(j=>[j.officeName,j.sales]),ge=f.reduce((j,Se)=>j+parseFloat(Se.sales),0);q.push([n("Total"),`${ge.toFixed(2)}`]);const we=[n("Office Name"),n("Sales")],be={1:{halign:"right"},2:{halign:"right"}},_e={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};l.autoTable(we,q,{startY:45,headStyles:_e,columnStyles:be,styles:{font:o==="hi"?"NotoSansDevanagari":"NotoSansBengali"}}),l.save("total_sales_by_office.pdf")})},he=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const a=f[e.dataIndex].officeId;f[e.dataIndex].officeType==="Company"&&(v(!1),z(o=>[...o,{selectedOffice:L,isAdmin:Z}]),U(o=>[...o,ae]),O(a),T(6),D(a),J(!0),W(!0))}},pe=()=>{if(u.length>0){v(!1);const e=u.pop(),a=M.pop();G({state:!0,Ovalue:a}),O(e.selectedOffice),D(a),T(e.isAdmin),z([...u]),U([...M]),u.length===0&&W(!1)}},ye=()=>{v(!1),O(_.officeId),G({state:!0,Ovalue:_.officeId}),T(_.adminStatus),D(_.officeId),z([]),J(!1),W(!1)},ue=()=>{S(!$)},N=e=>{if(!e)return"";const a=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${a}-${d}-${o}`};return t.jsxs("div",{className:`${s.chartContainer} ${i==="dark"?s.darkMode:s.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${i==="dark"?s.darkMode:s.lightMode}`,children:n("Total Sales by Business Entity")}),ie?t.jsx("div",{title:"Reset",className:s.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ye,children:t.jsx(Ce,{style:{fontSize:"1rem"}})})}):null,re&&u.length>0?t.jsx("div",{title:"Previous",className:s.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:pe,children:t.jsx(Ne,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:E,children:t.jsxs("div",{className:`${s.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${s.icon} ${i==="dark"?s.darkMode:s.lightMode} px-2 py-1`,onClick:ue,children:$?t.jsx(Fe,{style:{fontSize:"1.1rem"}}):t.jsx(je,{style:{fontSize:"1.1rem"}})}),$&&t.jsxs("div",{className:`${s.exportOptions} ${i==="dark"?s.darkMode:s.lightMode}`,ref:P,children:[y?t.jsxs("div",{className:s.exportOption,onClick:()=>{V(!y),S(!1)},children:[t.jsx(Be,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:n("View Graph")})]}):t.jsxs("div",{className:s.exportOption,onClick:()=>{V(!y),S(!1)},children:[t.jsx(ke,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:n("View Table")})]}),t.jsxs("div",{className:s.exportOption,onClick:de,children:[t.jsx(Oe,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:n("Export to Excel")})]}),t.jsxs("div",{className:s.exportOption,onClick:fe,children:[t.jsx(Te,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),A&&t.jsx("div",{className:s.NoDataOverlay,children:t.jsx("img",{src:De,alt:"Loading...",width:50,height:50})}),Y.length==1&&!y&&!A?t.jsx("div",{className:`${s.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",y?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"291px"},children:t.jsxs("table",{className:`table ${i=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:n("Office")}),t.jsxs("th",{scope:"col",children:[n("Sales"),"(â‚¹)"]})]})}),t.jsx("tbody",{children:Y.map((e,a)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:a+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx($e,{option:ce,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:he},className:i==="dark"?s.darkMode:s.lightMode})]})};export{dt as default};
