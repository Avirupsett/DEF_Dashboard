import{_ as we}from"./index-68700c46.js";import{H as U,r as g,u as Re,j as t,I as Le,J as Pe,i as We,A as ze,B as Ae,K as Ie,E as He,G as Ue,a as E}from"./vendor-5be16ce1.js";import{k as Ge,l as Me,E as Ve,Q as R,a as me,f as qe,b as Ye}from"./NotoSansDevanagari-VariableFont_wdth_wght-68d595be.js";const Xe="_chartContainer_ew0vy_1",Je="_lightMode_ew0vy_47",Ke="_dateFilter_ew0vy_51",Qe="_officefilter_ew0vy_207",Ze="_topContainer_ew0vy_299",et="_darkMode_ew0vy_319",tt="_iconsContainer_ew0vy_487",ot="_icon_ew0vy_487",nt="_exportOptions_ew0vy_571",at="_exportOption_ew0vy_571",st="_NoDataOverlay_ew0vy_659",rt="_tableContainer_ew0vy_849",it="_table_ew0vy_849",lt="_summaryHeader_ew0vy_885",ct="_periodHeader_ew0vy_893",dt="_closeButton_ew0vy_925",ft="_tableWrapper_ew0vy_955",pt="_loadingOverlay_ew0vy_963",ut="_loadingSpinner_ew0vy_989",ht="_boldOption_ew0vy_1001",wt="_optionGroup_ew0vy_1011",mt="_resetButtonContainer_ew0vy_1039",yt="_resetButton_ew0vy_1039",l={chartContainer:Xe,lightMode:Je,"label-text":"_label-text_ew0vy_47",dateFilter:Ke,officefilter:Qe,topContainer:Ze,darkMode:et,"theme-container":"_theme-container_ew0vy_329",iconsContainer:tt,icon:ot,exportOptions:nt,exportOption:at,NoDataOverlay:st,tableContainer:rt,table:it,summaryHeader:lt,periodHeader:ct,closeButton:dt,tableWrapper:ft,loadingOverlay:pt,loadingSpinner:ut,boldOption:ht,optionGroup:wt,resetButtonContainer:mt,resetButton:yt};var gt={exports:{}};(function(c,$){(function(L,C){C()})(U,function(){function L(n,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function C(n,a,h){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){b(r.response,a,h)},r.onerror=function(){console.error("could not download file")},r.send()}function B(n){var a=new XMLHttpRequest;a.open("HEAD",n,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function F(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}}var x=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof U=="object"&&U.global===U?U:void 0,D=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),b=x.saveAs||(typeof window!="object"||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!D?function(n,a,h){var r=x.URL||x.webkitURL,u=document.createElement("a");a=a||n.name||"download",u.download=a,u.rel="noopener",typeof n=="string"?(u.href=n,u.origin===location.origin?F(u):B(u.href)?C(n,a,h):F(u,u.target="_blank")):(u.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(u.href)},4e4),setTimeout(function(){F(u)},0))}:"msSaveOrOpenBlob"in navigator?function(n,a,h){if(a=a||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(L(n,h),a);else if(B(n))C(n,a,h);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){F(r)})}}:function(n,a,h,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return C(n,a,h);var u=n.type==="application/octet-stream",J=/constructor/i.test(x.HTMLElement)||x.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||u&&J||D)&&typeof FileReader<"u"){var j=new FileReader;j.onloadend=function(){var f=j.result;f=v?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=f:location=f,r=null},j.readAsDataURL(n)}else{var G=x.URL||x.webkitURL,k=G.createObjectURL(n);r?r.location=k:location.href=k,r=null,setTimeout(function(){G.revokeObjectURL(k)},4e4)}});x.saveAs=b.saveAs=b,c.exports=b})})(gt);const _t=({themeMode:c,selectedRange:$,selectedOffice:L,isAdmin:C,alldata:B,isLoading:F,SelectedOfficeName:x,setSelectedOfficeName:D,selectedOfficeNameLocal:b,setSelectedOfficeNameLocal:n,setSelectedOffice:a,setIsAdmin:h,setCompanies:r,setWholesales:u,setRetails:J,originallist:v,setOfficeIdLocal:j,officeIdLocal:G,setOptionvalue:k})=>{const[f,ye]=g.useState([]),[K,M]=g.useState(!1),Q=g.useRef(null),Z=g.useRef(null),[P,ce]=g.useState(!1),[ee,ge]=g.useState([]),[W,te]=g.useState([]),[de,fe]=g.useState([]),[xe,oe]=g.useState(!1),[be,pe]=g.useState(!1),[ve,V]=g.useState(!0),{t:s}=Re();s("Office"),`${s("Sales")}`,s("Rows"),g.useEffect(()=>{const e=o=>{Q.current&&!Q.current.contains(o.target)&&Z.current&&!Z.current.contains(o.target)&&o.target.tagName!=="svg"&&o.target.tagName!=="path"&&M(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const ue=e=>{let o=[],p=[];B.graph3&&(B.graph3.map(i=>{o.push({officeId:i.officeId,officeName:i.officeName,officeType:i.officeType,sales:i.totalIncome.toFixed(2),color:i.officeTypeColor}),p.push({officeName:i.officeName,sales:i.totalIncome.toFixed(2)})}),p.push({officeName:"Total",sales:o.reduce((i,d)=>i+parseFloat(d.sales),0).toFixed(2)}),e===1&&(r(o.filter(i=>i.officeType==="Company")),u(o.filter(i=>i.officeType==="Wholesale Pumps")),J(o.filter(i=>i.officeType==="Retail Pumps")),V(!0)),ye(o),ge(p))};g.useEffect(()=>{$&&L&&ue(ve?0:1)},[B]);const _e={title:{textStyle:{color:c==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${s("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:f.map(e=>e.officeName),axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:105,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?s("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:c==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:c==="dark"?"#ffffff":"#000000"}},axisLabel:{color:c==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:c==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",itemStyle:{normal:{barBorderRadius:[0,5,5,0]}},data:f.map((e,o)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:!0,position:"right",color:c==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},q=e=>{let o="";const p=new Uint8Array(e),i=p.byteLength;for(let d=0;d<i;d++)o+=String.fromCharCode(p[d]);return window.btoa(o)},Se=async()=>{const e=R.loading("Please wait..."),o=Y($[0]),p=Y($[1]),i=await we(()=>import("./exceljs.min-fd769190.js").then(y=>y.e),["assets/exceljs.min-fd769190.js","assets/vendor-5be16ce1.js"]),d=new i.Workbook,w=d.addWorksheet("Total Sales by Office"),ae=await E.get(me,{responseType:"arraybuffer"}),se=q(ae.data),re=d.addImage({base64:se,extension:"png"});w.addImage(re,{tl:{col:0,row:0},ext:{width:100,height:60}});const z=w.getCell("A1");z.value=`${s("Sales")} ${s("of")} ${ne(b,10)}`,z.font={bold:!0,color:{argb:"000000"},size:14},z.alignment={vertical:"middle",horizontal:"center"},w.mergeCells("A1:C1");const A=w.getCell("A2");A.value=`${s("Period")}: ${o} ${s("to")} ${p}`,A.font={bold:!0,color:{argb:"000000"},size:12},A.alignment={horizontal:"center"},w.mergeCells("A2:C2"),w.getColumn(1).width=15,w.getColumn(2).width=50,w.getColumn(3).width=15;const T=w.addRow([s("#"),s("Office Name"),s("Sales")]);T.font={bold:!0},T.eachCell(y=>{y.font={bold:!0,color:{argb:"000000"},size:12},y.border={bottom:{style:"thin",color:{argb:"000000"}}}}),f.forEach((y,N)=>{const S=w.addRow([N+1,y.officeName,y.sales]);S.getCell(1).alignment={horizontal:"left"},S.getCell(2).alignment={horizontal:"left"},S.getCell(3).alignment={horizontal:"right"}});const X=w.addRow(["",s("Total"),""]);X.font={bold:!0,color:{argb:"000000"},size:12};const m=f.reduce((y,N)=>y+parseFloat(N.sales),0),I=w.getCell(`C${X.number}`);I.value=`₹ ${m}`,I.numFmt="0.00",I.alignment={horizontal:"right"};const ie=Date.now();d.xlsx.writeBuffer().then(async y=>{const N=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),S=new FormData;S.append("file",N,`${ie}sales_of_${b}_${o}_${p}.xlsx`);try{const O=await E.post("https://def-dash-route-api.inspirigenceworks.co.in/api/uploader",S,{headers:{"Content-Type":"multipart/form-data"}});O.status==200?R.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):R.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const le=O.data.url;window.location.href=`https://def-dash-route-api.inspirigenceworks.co.in/static/downloads/${le}`}catch(O){console.error("Error saving Excel file:",O)}})},Ce=async()=>{const e=R.loading("Please wait..."),o=Y($[0]),p=Y($[1]),d=new URLSearchParams(window.location.search).get("lang"),w=await E.get(me,{responseType:"arraybuffer"}),ae=await E.get(qe,{responseType:"arraybuffer"}),se=q(ae.data),re=await E.get(Ye,{responseType:"arraybuffer"}),z=q(re.data),A=q(w.data);we(()=>import("./NotoSansDevanagari-VariableFont_wdth_wght-68d595be.js").then(T=>T.j),["assets/NotoSansDevanagari-VariableFont_wdth_wght-68d595be.js","assets/vendor-5be16ce1.js","assets/index-68700c46.js","assets/index-a647bc22.css","assets/NotoSansDevanagari-VariableFont_wdth_wght-55fec1ff.css"]).then(async T=>{let X=T.default;const m=new X,I=A,ie=35,y=20;m.addImage(I,"PNG",15,9,ie,y),m.addFileToVFS("NotoSansBengali.ttf",se),m.addFont("NotoSansBengali.ttf","NotoSansBengali","normal"),m.setFont("NotoSansBengali"),m.addFileToVFS("NotoSansDevanagari.ttf",z),m.addFont("NotoSansDevanagari.ttf","NotoSansDevanagari","normal"),m.setFont("NotoSansDevanagari");const N=[[`${s("Sales")} ${s("of")} ${ne(b,10)}`]];m.autoTable({startY:27,head:N,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali",fontStyle:"bold"}});const S=[[`${s("Period")}: ${o} ${s("to")} ${p}`]];m.autoTable({startY:36,head:S,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30},styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali"}});const O=f.map((_,H)=>[H+1,_.officeName,`₹ ${_.sales}`]),le=f.reduce((_,H)=>_+parseFloat(H.sales),0);O.push(["",s("Total"),`₹ ${le.toFixed(2)}`]);const Oe=[s("#"),s("Office Name"),s("Sales")],$e={0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}},Be={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"},De={0:5,1:25,2:25,3:25};m.autoTable(Oe,O,{startY:45,headStyles:Be,columnStyles:$e,styles:{font:d==="hi"?"NotoSansDevanagari":"NotoSansBengali"},columnWidth:"wrap",columnWidths:De});const Te=Date.now(),Ee=m.output("blob"),he=new FormData;he.append("file",Ee,`${Te}sales_of_${b}_${o}_${p}.pdf`);try{const _=await E.post("https://def-dash-route-api.inspirigenceworks.co.in/api/uploader",he,{headers:{"Content-Type":"multipart/form-data"}});_.status==200?R.update(e,{render:"Download Starting...",type:"success",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1}):R.update(e,{render:"Download Failed !",type:"error",isLoading:!1,autoClose:5e3,closeOnClick:!0,pauseOnFocusLoss:!1});const H=await _.data.url;window.location.href=`https://def-dash-route-api.inspirigenceworks.co.in/static/downloads/${H}`}catch(_){console.error("Error saving PDF file:",_)}})},Fe=e=>{if(e&&e.data&&e.dataIndex>=0&&f[e.dataIndex]){const o=f[e.dataIndex].officeId,p=f[e.dataIndex].officeType,i=f[e.dataIndex].officeName;p==="Company"&&(V(!1),te(d=>[...d,{selectedOffice:L,isAdmin:C,selectedOfficeNameLocal:b}]),fe(d=>[...d,G]),k({state:!0,Ovalue:o}),D(i),n(i),a(o),h(6),j(o),pe(!0),oe(!0))}},je=()=>{if(W.length>0){V(!1);const e=W.pop(),o=de.pop();k({state:!0,Ovalue:o}),D(e.selectedOfficeNameLocal),n(e.selectedOfficeNameLocal),a(e.selectedOffice),j(o),h(e.isAdmin),te([...W]),fe([...de]),W.length===0&&oe(!1)}},ke=()=>{V(!1),a(v.officeId),k({state:!0,Ovalue:v.officeId}),h(v.adminStatus),j(v.officeId),D(v.userOfficeName),n(v.userOfficeName),te([]),pe(!1),oe(!1)},Ne=()=>{M(!K)},Y=e=>{if(!e)return"";const o=e.getFullYear(),p=String(e.getMonth()+1).padStart(2,"0");return`${String(e.getDate()).padStart(2,"0")}-${p}-${o}`},ne=(e,o)=>window.innerWidth>500||e.length<=o?e:e.substring(0,o)+"...";return t.jsxs("div",{className:`${l.chartContainer} ${c==="dark"?l.darkMode:l.lightMode}`,children:[t.jsx(Ge,{position:"top-center",theme:c}),t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsxs("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${c==="dark"?l.darkMode:l.lightMode}`,children:[s("Sales")," ",s("of")," ",ne(b,10)]}),be?t.jsx("div",{title:"Reset",className:l.resetButtonContainer,children:t.jsx("button",{title:"Reset",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:ke,children:t.jsx(Le,{style:{fontSize:"1rem"}})})}):null,xe&&W.length>0?t.jsx("div",{title:"Previous",className:l.resetButtonContainer,children:t.jsx("button",{title:"Previous",className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""} shadow border-2 border-white`,onClick:je,children:t.jsx(Pe,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{title:"Export Options",className:"d-flex g-0",ref:Q,children:t.jsxs("div",{className:`${l.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${l.icon} ${c==="dark"?l.darkMode:l.lightMode} px-2 py-1`,onClick:Ne,children:K?t.jsx(We,{style:{fontSize:"1.1rem"}}):t.jsx(ze,{style:{fontSize:"1.1rem"}})}),K&&t.jsxs("div",{className:`${l.exportOptions} ${c==="dark"?l.darkMode:l.lightMode}`,ref:Z,children:[P?t.jsxs("div",{className:l.exportOption,onClick:()=>{ce(!P),M(!1)},children:[t.jsx(Ie,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:s("View Graph")})]}):t.jsxs("div",{className:l.exportOption,onClick:()=>{ce(!P),M(!1)},children:[t.jsx(Ae,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:s("View Table")})]}),t.jsxs("div",{className:l.exportOption,onClick:Se,children:[t.jsx(He,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:s("Export to Excel")})]}),t.jsxs("div",{className:l.exportOption,onClick:Ce,children:[t.jsx(Ue,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:s("Export to PDF")})]})]})]})})]})}),F&&t.jsx("div",{className:l.NoDataOverlay,children:t.jsx("img",{src:Me,alt:"Loading...",width:50,height:50})}),ee.length==1&&!P&&!F?t.jsx("div",{className:`${l.NoDataOverlay} fs-5`,children:s("No Data Found")}):"",P?t.jsx("div",{className:"container-fluid mt-2 table-responsive",style:{height:"342px"},children:t.jsxs("table",{className:`table ${c=="dark"?"table-dark":""}`,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{scope:"col",children:"#"}),t.jsx("th",{scope:"col",children:s("Office")}),t.jsxs("th",{scope:"col",children:[s("Sales"),"(₹)"]})]})}),t.jsx("tbody",{children:ee.map((e,o)=>t.jsxs("tr",{children:[t.jsx("th",{scope:"row",children:ee.length-1===o?"":o+1}),t.jsx("td",{children:e.officeName}),t.jsx("td",{children:parseFloat(e.sales).toFixed(2)})]},e.officeName))})]})}):t.jsx(Ve,{option:_e,style:{height:"350px",width:"100%",maxWidth:"2300px"},onEvents:{click:Fe},className:c==="dark"?l.darkMode:l.lightMode})]})};export{_t as default};
