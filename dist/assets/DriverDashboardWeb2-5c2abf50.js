import{r as s,u as $,j as e}from"./vendor-d1a31163.js";import{D as A,T as S,a as k,b as p,c as x,M as L,C as E,P as R}from"./MetricsCard-367b38be.js";import{M as U,B as v}from"./Box-f65f2bf3.js";import O from"./MapComponent-b5b03906.js";import{B as f,I as P}from"./index.esm-7adca8f5.js";import{a as I}from"./axios-d9b95618.js";import{T as g}from"./Tab-e259bd25.js";import"./installSVGRenderer-7788c1a1.js";import"./extendSxProp-4fc022a8.js";import"./react-is.production.min-ec3da07b.js";import"./useTheme-55d19bd2.js";import"./createSvgIcon-a8b447bb.js";function ee(){const[a,u]=s.useState({distanceCovered:0,drivingTime:0,idleTime:0,averageSpeed:0,profile:{driverName:"",driverLicenceNo:"",driverContactNo:""},graph1:{totalTankFuel:0,fuelUnloaded:0},graph2:{totalJob:0,jobCompleted:0},prevJourney:[],myTrip:[],alltime:{distanceCovered:0,drivingTime:0,idleTime:0,averageSpeed:0},currentDeliveredPlanId:0}),[r,h]=s.useState(!0),[n,D]=s.useState(!1),[c,J]=s.useState(!0),[j,y]=s.useState("1"),[N,T]=s.useState([]),b=new URLSearchParams(window.location.search),{t,i18n:M}=$(),w=async()=>{try{M.changeLanguage(b.get("lang")||"en");let l="";const i=b.get("jwtToken");i&&(l=JSON.parse(atob(i.split(".")[1])));const C=b.get("driverId");if(C){let d=await I.get(`https://dev-def-dash-route-api.inspirigenceworks.co.in/api/v1/dashboard/driver/metrics/${C}`);const{data:m}=d;d.data&&h(!1),u(m)}else if(l){const d=l.sub;if(d){let m=await I.get(`https://dev-def-dash-route-api.inspirigenceworks.co.in/api/v1/dashboard/driver/metrics/${d}`);const{data:F}=m;m.data&&h(!1),u(F)}}}catch(l){console.log(l),h(!1)}};s.useEffect(()=>{w();const l=setInterval(w,3e5);return()=>clearInterval(l)},[]);const[o,B]=s.useState(window.innerWidth);return s.useEffect(()=>{const l=()=>{B(window.innerWidth)};return window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),e.jsxs("div",{className:"d-flex align-items-start justify-content-between",style:{height:"100vh"},children:[e.jsxs("div",{className:" mx-0 align-items-start ",style:{width:o>950?"60%":"100%",overflowY:"scroll",height:"99vh"},children:[e.jsxs("div",{className:"fs-4 mt-3 fw-bolder px-xl-5 px-lg-4 px-md-3 px-2",style:{color:"#626d77"},children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[a.profile.driverName,e.jsx("div",{className:"px-2 py-1 rounded-2 fs-6 mx-2",style:{backgroundColor:"rgb(37, 99, 235,0.1)",color:"rgb(37, 99, 235)",letterSpacing:"1px"},children:"Driver"}),e.jsx("div",{className:"spinner-border text-primary ",role:"status",style:{display:r?"block":"none"}})]}),e.jsx("a",{href:`tel:${a.profile.driverContactNo}`,style:{cursor:"pointer"},children:e.jsx(U,{className:"fs-3",style:{color:"rgb(37, 99, 235)",cursor:"pointer"}})})]}),e.jsx("hr",{style:{borderColor:"rgb(37, 99, 235)",borderWidth:"2px",marginBottom:"5px",marginTop:"10px"}}),e.jsxs("div",{className:`fs-3 fw-bold px-1 mb-1 mt-2 ${o>950?"ms-0":"ms-1"}`,style:{color:"#626d77"},children:[e.jsx(f,{className:"fs-2",style:{marginLeft:"2px",marginBottom:"4px",display:"inline-block",verticalAlign:"bottom",marginRight:"10px",color:"rgb(37, 99, 235)"}}),t("Overall Metrics")]})]}),e.jsx(A,{distanceCovered:a.alltime.distanceCovered,drivingTime:a.alltime.drivingTime,idleTime:a.alltime.idleTime,averageSpeed:a.alltime.averageSpeed}),e.jsx("div",{style:{display:o<=950?"block":"none"},children:e.jsx(v,{sx:{width:"100%"},children:e.jsxs(S,{value:j,children:[e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(k,{centered:!0,onChange:(l,i)=>y(i),"aria-label":"lab API tabs example",children:[e.jsx(g,{disabled:!!r,className:"fw-bold fs-5",label:"Stats",value:"1"}),e.jsx(g,{disabled:!!r,className:"fw-bold fs-5",label:"Map",value:"2"})]})}),e.jsxs(p,{value:"1",className:"px-0",children:[e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-2 ms-1",style:{color:"#626d77"},children:[e.jsx(P,{className:"fs-2",style:{marginBottom:"4px",verticalAlign:"bottom",marginRight:"8px",color:"rgb(37, 99, 235)"}}),t("Stats For Ongoing Trip")]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-around",children:[e.jsx(x,{title:"Tanker Fuel Level",filllevel:a.graph1.totalTankFuel-a.graph1.fuelUnloaded,emptylevel:a.graph1.fuelUnloaded,fillTitle:"Fuel Left",emptyTitle:"Fuel Unloaded"}),e.jsx(x,{title:"Jobs Completed",emptylevel:a.graph2.totalJob-a.graph2.jobCompleted,filllevel:a.graph2.jobCompleted,fillTitle:"Job Done",emptyTitle:"Job Left"})]}),e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1 mt-4 ms-1",style:{color:"#626d77"},children:[e.jsx(f,{className:"fs-2",style:{marginLeft:"2px",marginBottom:"4px",display:"inline-block",verticalAlign:"bottom",marginRight:"10px",color:"rgb(37, 99, 235)"}}),t("Current Metrics")]}),e.jsx(L,{distanceCovered:a.distanceCovered,drivingTime:a.drivingTime,idleTime:a.idleTime,averageSpeed:a.averageSpeed})]}),e.jsx(p,{value:"2",className:"p-0",children:e.jsx("div",{className:"",style:{height:o>950?"88vh":"50vh"},children:e.jsx(O,{deliveryPlanId:a.currentDeliveredPlanId,mapComponentData:N,setMapComponentData:T})})})]})})}),e.jsx("div",{className:"accordion px-xl-5 px-lg-4 px-md-3 px-2 mt-3",children:e.jsxs("div",{className:"accordion-item ",children:[e.jsx("h2",{className:"accordion-header",id:"headingOne",children:e.jsx("button",{onClick:()=>D(!n),className:`accordion-button ${n?"collapsed":""} fs-4`,type:"button",style:{color:n?"#626d77":"rgb(37, 99, 235)"},"data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne",children:t("Ongoing Trip")})}),e.jsx("div",{id:"collapseOne",className:`accordion-collapse collapse ${n?"":"show"}`,"aria-labelledby":"headingOne","data-bs-parent":"#accordionExample",children:e.jsx("div",{className:"accordion-body p-1 py-2",children:e.jsx("div",{className:"",children:e.jsx(E,{currentTrip:a.myTrip})})})})]})}),e.jsx("div",{className:"accordion px-xl-5 px-lg-4 px-md-3 px-2 mt-3 mb-3",children:e.jsxs("div",{className:"accordion-item ",children:[e.jsx("h2",{className:"accordion-header",id:"headingOne",children:e.jsx("button",{onClick:()=>J(!c),className:`accordion-button ${c?"collapsed":""} fs-4`,type:"button",style:{color:c?"#626d77":"rgb(37, 99, 235)"},"data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne",children:t("Previous Trip")})}),e.jsx("div",{id:"collapseOne",className:`accordion-collapse collapse ${c?"":"show"}`,"aria-labelledby":"headingOne","data-bs-parent":"#accordionExample",children:e.jsx("div",{className:"accordion-body p-1 py-2",children:e.jsx("div",{className:"",children:e.jsx(R,{prevJourney:a.prevJourney})})})})]})})]}),e.jsx("div",{style:{width:"40%",display:o>950?"block":"none"},children:e.jsx("div",{className:"p-2 pt-2 mx-1 my-1  rounded-3",style:{boxShadow:"rgba(0, 0, 0, 0.075) 0.1rem 0.1rem 1rem 2px",backgroundColor:"white",position:"relative",marginTop:"0px"},children:e.jsx(v,{sx:{width:"100%"},children:e.jsxs(S,{value:j,children:[e.jsx(v,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(k,{centered:!0,onChange:(l,i)=>y(i),"aria-label":"lab API tabs example",children:[e.jsx(g,{disabled:!!r,className:"fw-bold fs-5",label:"Stats",value:"1"}),e.jsx(g,{disabled:!!r,className:"fw-bold fs-5",label:"Map",value:"2"})]})}),e.jsxs(p,{value:"1",className:"px-0",children:[e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1",style:{color:"#626d77"},children:[e.jsx(P,{className:"fs-2",style:{marginBottom:"4px",verticalAlign:"bottom",marginRight:"8px",color:"rgb(37, 99, 235)"}}),t("Stats For Ongoing Trip")]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-around",children:[e.jsx(x,{title:"Tanker Fuel Level",filllevel:a.graph1.totalTankFuel-a.graph1.fuelUnloaded,emptylevel:a.graph1.fuelUnloaded,fillTitle:"Fuel Left",emptyTitle:"Fuel Unloaded"}),e.jsx(x,{title:"Jobs Completed",emptylevel:a.graph2.totalJob-a.graph2.jobCompleted,filllevel:a.graph2.jobCompleted,fillTitle:"Job Done",emptyTitle:"Job Left"})]}),e.jsxs("div",{className:"fs-3 fw-bold px-2 mb-1 mt-3",style:{color:"#626d77"},children:[e.jsx(f,{className:"fs-2",style:{marginLeft:"2px",marginBottom:"4px",display:"inline-block",verticalAlign:"bottom",marginRight:"10px",color:"rgb(37, 99, 235)"}}),t("Current Metrics")]}),e.jsx(L,{distanceCovered:a.distanceCovered,drivingTime:a.drivingTime,idleTime:a.idleTime,averageSpeed:a.averageSpeed})]}),e.jsx(p,{value:"2",className:"p-0",children:e.jsx("div",{className:"",style:{height:"88vh"},children:e.jsx(O,{deliveryPlanId:a.currentDeliveredPlanId,mapComponentData:N,setMapComponentData:T})})})]})})})})]})}export{ee as default};
