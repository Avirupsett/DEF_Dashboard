import{_ as L}from"./index-203bbd60.js";import{r as x,u as q,j as e,g as K,z as Q,A as Z,H as tt,C as et,E as at,G as ot,l as D}from"./vendor-0ae1ff03.js";import{E as nt,M as st,F as rt}from"./index-a05dbcdb.js";import{l as A}from"./logo-604665f9.js";const it="_chartContainer_1xxyh_1",lt="_lightMode_1xxyh_47",ct="_dateFilter_1xxyh_51",dt="_officefilter_1xxyh_207",ft="_topContainer_1xxyh_299",xt="_darkMode_1xxyh_319",ht="_iconsContainer_1xxyh_487",pt="_icon_1xxyh_487",mt="_exportOptions_1xxyh_571",gt="_exportOption_1xxyh_571",yt="_NoDataOverlay_1xxyh_659",_t="_tableContainer_1xxyh_849",ut="_table_1xxyh_849",bt="_summaryHeader_1xxyh_885",St="_periodHeader_1xxyh_893",wt="_closeButton_1xxyh_925",Ct="_tableWrapper_1xxyh_955",Ft="_loadingOverlay_1xxyh_963",kt="_loadingSpinner_1xxyh_989",Nt="_boldOption_1xxyh_1001",jt="_optionGroup_1xxyh_1011",n={chartContainer:it,lightMode:lt,"label-text":"_label-text_1xxyh_47",dateFilter:ct,officefilter:dt,topContainer:ft,darkMode:xt,"theme-container":"_theme-container_1xxyh_329",iconsContainer:ht,icon:pt,exportOptions:mt,exportOption:gt,NoDataOverlay:yt,tableContainer:_t,table:ut,summaryHeader:bt,periodHeader:St,closeButton:wt,tableWrapper:Ct,loadingOverlay:Ft,loadingSpinner:kt,boldOption:Nt,optionGroup:jt},Tt=({themeMode:r,selectedRange:h,selectedOffice:w,isAdmin:E,SelectedOfficeName:vt})=>{const[p,H]=x.useState([]),[j,C]=x.useState(!1),v=x.useRef(null),O=x.useRef(null),[T,z]=x.useState(!0),[_,B]=x.useState(!1),[W,I]=x.useState([]),{t:o}=q(),R=[{name:"officeName",label:o("Office")},{name:"sales",label:`${o("Sales")}(₹)`}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:o("Rows")}}};x.useEffect(()=>{const t=s=>{v.current&&!v.current.contains(s.target)&&O.current&&!O.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&C(!1)};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}},[]),x.useEffect(()=>{const t=y(h[0]),s=y(h[1]);t&&s&&w&&(()=>{z(!0),h&&w&&D.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${t}/${s}/${w}/${E}`).then(i=>{const{data:a}=i;if(a.graph1){let m=[],c=[];for(let l=0;l<a.graph1.length;l++)m.push({officeName:a.graph1[l].officeName,sales:a.graph1[l].totalIncome.toFixed(0)}),c.push({officeName:a.graph1[l].officeName,sales:a.graph1[l].totalIncome.toFixed(2)});c.push({officeName:o("Total"),sales:m.reduce((l,g)=>l+parseFloat(g.sales),0).toFixed(2)}),I(c),H(m)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{z(!1)})})()},[h,w,E]);const M={color:["#66BA69"],title:{textStyle:{color:r==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`<b>${o("Office")}:</b> {b} <br> <b>${o("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:r==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:p.map(t=>t.officeName),axisLine:{lineStyle:{color:r==="dark"?"#ffffff":"#000000"}},axisLabel:{color:r==="dark"?"#ffffff":"#000000",fontSize:12,formatter:t=>window.innerWidth<=768?t.length>10?t.substring(0,10)+"...":t:t.length>0?t.substring(0,10)+"...":t}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?o("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:r==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:r==="dark"?"#ffffff":"#000000"}},axisLabel:{color:r==="dark"?"#ffffff":"#000000",formatter:t=>t>=1e3?t/1e3+"k":t,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:r==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:p.map(t=>t.sales),label:{show:p.length<=5,position:"right",color:r==="dark"?"#ffffff":"#000000"}}]},P=t=>{let s="";const f=new Uint8Array(t),i=f.byteLength;for(let a=0;a<i;a++)s+=String.fromCharCode(f[a]);return window.btoa(s)},V=async()=>{const t=y(h[0]),s=y(h[1]),f=await L(()=>import("./exceljs.min-c5829cea.js").then(d=>d.e),["assets/exceljs.min-c5829cea.js","assets/vendor-0ae1ff03.js"]),i=new f.Workbook,a=i.addWorksheet("Total Sales by Office"),m=await D.get(A,{responseType:"arraybuffer"}),c=P(m.data),l=i.addImage({base64:c,extension:"png"});a.addImage(l,{tl:{col:0,row:0},ext:{width:40,height:40}});const g=a.getCell("A1");g.value=o("Total Sales by Business Entity"),g.font={bold:!0,color:{argb:"000000"},size:14},g.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A1:C1");const u=a.getCell("A2");u.value=`${o("Period")}: ${t} ${o("to")} ${s}`,u.font={bold:!0,color:{argb:"000000"},size:12},u.alignment={horizontal:"center"},a.mergeCells("A2:C2"),a.getColumn(1).width=50,a.getColumn(2).width=15,a.getColumn(3).width=15;const $=a.addRow([o("Office Name"),o("Sales")]);$.font={bold:!0},p.forEach(d=>{a.addRow([d.officeName,d.sales])});const F=a.addRow([o("Total"),""]);F.font={bold:!0,color:{argb:"000000"},size:12};const k=p.reduce((d,S)=>d+parseFloat(S.sales),0),b=a.getCell(`B${F.number}`);b.value=`₹${k}`,b.numFmt="0.00",b.alignment={horizontal:"right"},i.xlsx.writeBuffer().then(d=>{const S=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});rt.saveAs(S,"total_sales_by_office.xlsx")})},Y=async()=>{const t=y(h[0]),s=y(h[1]),f=await D.get(A,{responseType:"arraybuffer"}),i=P(f.data);L(()=>import("./index-a05dbcdb.js").then(a=>a.j),["assets/index-a05dbcdb.js","assets/vendor-0ae1ff03.js","assets/index-203bbd60.js","assets/index-4da97eed.css"]).then(a=>{let m=a.default;const c=new m,l=i,g=35,u=20;c.addImage(l,"PNG",15,9,g,u);const $=[[o("Total Sales by Business Entity")]];c.autoTable({startY:27,head:$,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const F=[[`${o(Period)}: ${t} ${o(to)} ${s}`]];c.autoTable({startY:36,head:F,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const k=p.map(N=>[N.officeName,parseFloat(N.sales.toFixed(2))]),b=p.reduce((N,X)=>N+parseFloat(X.sales),0);k.push([o("Total"),`${b.toFixed(2)}`]);const d=[o("Office Name"),o("Sales")],S={1:{halign:"right"},2:{halign:"right"}},J={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};c.autoTable(d,k,{startY:45,headStyles:J,columnStyles:S}),c.save("total_sales_by_office.pdf")})},U=()=>{C(!j)},y=t=>{if(!t)return"";const s=t.getFullYear(),f=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${s}-${f}-${i}`};return e.jsxs("div",{className:`${n.chartContainer} ${r==="dark"?n.darkMode:n.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[e.jsx("div",{className:`fw-bold fs-5 ${r==="dark"?n.darkMode:n.lightMode}`,children:o("Total Sales by Business Entity")}),e.jsx("div",{className:"d-flex g-0",ref:v,children:e.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[e.jsx("div",{className:`${n.icon} ${r==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:U,children:j?e.jsx(K,{style:{fontSize:"1.1rem"}}):e.jsx(Q,{style:{fontSize:"1.1rem"}})}),j&&e.jsxs("div",{className:`${n.exportOptions} ${r==="dark"?n.darkMode:n.lightMode}`,ref:O,children:[_?e.jsxs("div",{className:n.exportOption,onClick:()=>{B(!_),C(!1)},children:[e.jsx(tt,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),e.jsx("span",{children:o("View Graph")})]}):e.jsxs("div",{className:n.exportOption,onClick:()=>{B(!_),C(!1)},children:[e.jsx(Z,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:o("View Table")})]}),e.jsxs("div",{className:n.exportOption,onClick:V,children:[e.jsx(et,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:o("Export to Excel")})]}),e.jsxs("div",{className:n.exportOption,onClick:Y,children:[e.jsx(at,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:o("Export to PDF")})]})]})]})})]})}),T&&e.jsx("div",{className:n.loadingOverlay,children:e.jsx(ot,{disableShrink:!0})}),W.length==1&&!_&&!T?e.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:o("No Data Found")}):"",_?e.jsx("div",{className:"container-fluid mt-2",children:e.jsx(st,{data:W,columns:R,options:G})}):e.jsx(nt,{option:M,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:r==="dark"?n.darkMode:n.lightMode})]})};export{Tt as default};
