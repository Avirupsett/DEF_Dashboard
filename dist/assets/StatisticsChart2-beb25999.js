import{_ as q}from"./index-7883a9ce.js";import{r as c,u as ge,j as t,G as we,H as _e,h as be,z as Se,A as ve,I as Ce,C as Fe,E as ke,a as R}from"./vendor-1b7ca1de.js";import{l as Ne,E as je,M as Te,a as K,F as Oe}from"./index-0f4cac82.js";const $e="_chartContainer_ew0vy_1",Be="_lightMode_ew0vy_47",Ee="_dateFilter_ew0vy_51",De="_officefilter_ew0vy_207",ze="_topContainer_ew0vy_299",Ie="_darkMode_ew0vy_319",We="_iconsContainer_ew0vy_487",Pe="_icon_ew0vy_487",He="_exportOptions_ew0vy_571",Le="_exportOption_ew0vy_571",Re="_NoDataOverlay_ew0vy_659",Ae="_tableContainer_ew0vy_849",Ge="_table_ew0vy_849",Me="_summaryHeader_ew0vy_885",Ve="_periodHeader_ew0vy_893",Ye="_closeButton_ew0vy_925",Ue="_tableWrapper_ew0vy_955",Je="_loadingOverlay_ew0vy_963",Xe="_loadingSpinner_ew0vy_989",qe="_boldOption_ew0vy_1001",Ke="_optionGroup_ew0vy_1011",Qe="_resetButtonContainer_ew0vy_1039",Ze="_resetButton_ew0vy_1039",n={chartContainer:$e,lightMode:Be,"label-text":"_label-text_ew0vy_47",dateFilter:Ee,officefilter:De,topContainer:ze,darkMode:Ie,"theme-container":"_theme-container_ew0vy_329",iconsContainer:We,icon:Pe,exportOptions:He,exportOption:Le,NoDataOverlay:Re,tableContainer:Ae,table:Ge,summaryHeader:Me,periodHeader:Ve,closeButton:Ye,tableWrapper:Ue,loadingOverlay:Je,loadingSpinner:Xe,boldOption:qe,optionGroup:Ke,resetButtonContainer:Qe,resetButton:Ze},nt=({themeMode:l,selectedRange:m,selectedOffice:g,isAdmin:$,SelectedOfficeName:et,setSelectedOffice:B,setIsAdmin:E,setCompanies:Q,setWholesales:Z,setRetails:ee,originallist:F,setOfficeIdLocal:D,officeIdLocal:te})=>{const[p,oe]=c.useState([]),[z,k]=c.useState(!1),I=c.useRef(null),W=c.useRef(null),[A,w]=c.useState(!0),[_,G]=c.useState(!1),[M,ae]=c.useState([]),[b,P]=c.useState([]),[V,Y]=c.useState([]),[ne,H]=c.useState(!1),[se,U]=c.useState(!1),[re,N]=c.useState(!0),{t:a}=ge(),ie=[{name:"officeName",label:a("Office")},{name:"sales",label:`${a("Sales")}(₹)`}],le={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"228px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:a("Rows")}}};c.useEffect(()=>{const e=s=>{I.current&&!I.current.contains(s.target)&&W.current&&!W.current.contains(s.target)&&s.target.tagName!=="svg"&&s.target.tagName!=="path"&&k(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);const J=e=>{w(!0);const s=x(m[0]),d=x(m[1]);R.get(`http://115.124.120.251:5064/api/v1/dashboard/total_sales/${s}/${d}/${g}/${$}`).then(i=>{const{data:o}=i;if(o.graph1){let h=[],f=[];for(let r=0;r<o.graph1.length;r++)h.push({officeId:o.graph1[r].officeId,officeName:o.graph1[r].officeName,officeType:o.graph1[r].officeType,sales:o.graph1[r].totalIncome.toFixed(0),color:o.graph1[r].officeTypeColor}),f.push({officeName:o.graph1[r].officeName,sales:o.graph1[r].totalIncome.toFixed(2)});f.push({officeName:"Total",sales:h.reduce((r,y)=>r+parseFloat(y.sales),0).toFixed(2)}),oe(h),e===1&&(Q(h.filter(r=>r.officeType==="Company")),Z(h.filter(r=>r.officeType==="Wholesale Pumps")),ee(h.filter(r=>r.officeType==="Retail Pumps")),N(!0)),ae(f)}}).catch(i=>{console.log("Error fetching data:",i)}).finally(()=>{w(!1)})};c.useEffect(()=>{m&&g&&J(re?0:1)},[m,g,$]);const ce={title:{textStyle:{color:l==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=768?18:25}},tooltip:{trigger:"axis",formatter:`{b} <br> <b>${a("Sales")}:</b> {c} `,textStyle:{fontSize:window.innerWidth<=768?10:14}},yAxis:{type:"category",name:(window.innerWidth>550,""),nameLocation:"middle",nameGap:80,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},data:p.map(e=>e.officeName),axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",fontSize:12,formatter:e=>window.innerWidth<=768?e.length>10?e.substring(0,10)+"...":e:e.length>0?e.substring(0,10)+"...":e}},grid:{left:window.innerWidth<=768?85:100,right:50,bottom:50,top:15},xAxis:{type:"value",name:window.innerWidth>550?a("Sales"):"",nameLocation:"middle",nameGap:30,nameTextStyle:{color:l==="dark"?"#ffffff":"#000000",fontWeight:"bold",fontSize:window.innerWidth<=768?14:16},axisLine:{lineStyle:{color:l==="dark"?"#ffffff":"#000000"}},axisLabel:{color:l==="dark"?"#ffffff":"#000000",formatter:e=>e>=1e3?e/1e3+"k":e,rotate:window.innerWidth<=768?45:0},splitLine:{show:!0,lineStyle:{color:l==="dark"?"grey":"silver",type:"line"}}},series:[{type:"bar",barWidth:"30%",data:p.map((e,s)=>({value:e.sales,name:e.officeName,itemStyle:{color:e.color}})),label:{show:p.length<=5,position:"right",color:l==="dark"?"#ffffff":"#000000"},emphasis:{focus:"series"}}]},X=e=>{let s="";const d=new Uint8Array(e),i=d.byteLength;for(let o=0;o<i;o++)s+=String.fromCharCode(d[o]);return window.btoa(s)},de=async()=>{const e=x(m[0]),s=x(m[1]),d=await q(()=>import("./exceljs.min-a898dc82.js").then(u=>u.e),["assets/exceljs.min-a898dc82.js","assets/vendor-1b7ca1de.js"]),i=new d.Workbook,o=i.addWorksheet("Total Sales by Office"),h=await R.get(K,{responseType:"arraybuffer"}),f=X(h.data),r=i.addImage({base64:f,extension:"png"});o.addImage(r,{tl:{col:0,row:0},ext:{width:40,height:40}});const y=o.getCell("A1");y.value=a("Total Sales by Business Entity"),y.font={bold:!0,color:{argb:"000000"},size:14},y.alignment={vertical:"middle",horizontal:"center"},o.mergeCells("A1:C1");const S=o.getCell("A2");S.value=`${a("Period")}: ${e} ${a("to")} ${s}`,S.font={bold:!0,color:{argb:"000000"},size:12},S.alignment={horizontal:"center"},o.mergeCells("A2:C2"),o.getColumn(1).width=50,o.getColumn(2).width=15,o.getColumn(3).width=15;const L=o.addRow([a("Office Name"),a("Sales")]);L.font={bold:!0},p.forEach(u=>{o.addRow([u.officeName,u.sales])});const j=o.addRow([a("Total"),""]);j.font={bold:!0,color:{argb:"000000"},size:12};const T=p.reduce((u,C)=>u+parseFloat(C.sales),0),v=o.getCell(`B${j.number}`);v.value=`₹${T}`,v.numFmt="0.00",v.alignment={horizontal:"right"},i.xlsx.writeBuffer().then(u=>{const C=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Oe.saveAs(C,"total_sales_by_office.xlsx")})},fe=async()=>{const e=x(m[0]),s=x(m[1]),d=await R.get(K,{responseType:"arraybuffer"}),i=X(d.data);q(()=>import("./index-0f4cac82.js").then(o=>o.j),["assets/index-0f4cac82.js","assets/vendor-1b7ca1de.js","assets/index-7883a9ce.js","assets/index-4da97eed.css"]).then(o=>{let h=o.default;const f=new h,r=i,y=35,S=20;f.addImage(r,"PNG",15,9,y,S);const L=[[a("Total Sales by Business Entity")]];f.autoTable({startY:27,head:L,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:20,bottom:0}});const j=[[`${a(Period)}: ${e} ${a(to)} ${s}`]];f.autoTable({startY:36,head:j,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const T=p.map(O=>[O.officeName,parseFloat(O.sales.toFixed(2))]),v=p.reduce((O,xe)=>O+parseFloat(xe.sales),0);T.push([a("Total"),`${v.toFixed(2)}`]);const u=[a("Office Name"),a("Sales")],C={1:{halign:"right"},2:{halign:"right"}},ye={fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#75AAF0",textColor:"#FFFFFF"};f.autoTable(u,T,{startY:45,headStyles:ye,columnStyles:C}),f.save("total_sales_by_office.pdf")})},pe=e=>{if(e&&e.data&&e.dataIndex>=0&&p[e.dataIndex]){const s=p[e.dataIndex].officeId;p[e.dataIndex].officeType==="Company"&&(N(!1),w(!0),P(i=>[...i,{selectedOffice:g,isAdmin:$}]),Y(i=>[...i,te]),B(s),E(6),D(s),U(!0),H(!0))}},he=()=>{if(b.length>0){N(!1);const e=b.pop(),s=V.pop();w(!0),B(e.selectedOffice),D(s),E(e.isAdmin),P([...b]),Y([...V]),b.length===0&&H(!1)}},ue=()=>{N(!1),w(!0),B(F.officeId),E(F.adminStatus),D(F.officeId),P([]),U(!1),H(!1)},me=()=>{k(!z)},x=e=>{if(!e)return"";const s=e.getFullYear(),d=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${s}-${d}-${i}`};return t.jsxs("div",{className:`${n.chartContainer} ${l==="dark"?n.darkMode:n.lightMode}`,children:[t.jsx("div",{className:"container-fluid",children:t.jsxs("div",{className:"d-flex w-100 g-0 align-items-start justify-content-between",children:[t.jsx("div",{className:`fw-bold fs-${window.innerWidth<=768?7:5} ${l==="dark"?n.darkMode:n.lightMode}`,children:a("Total Sales by Business Entity")}),se&&g!==F.officeId?t.jsx("div",{className:n.resetButtonContainer,children:t.jsx("button",{className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""}`,onClick:ue,children:t.jsx(we,{style:{fontSize:"1rem"}})})}):null,ne&&b.length>0?t.jsx("div",{className:n.resetButtonContainer,children:t.jsx("button",{className:`btn btn-primary mx-1 ${window.innerWidth<500?"btn-sm":""}`,onClick:he,children:t.jsx(_e,{style:{fontSize:"1rem"}})})}):null,t.jsx("div",{className:"d-flex g-0",ref:I,children:t.jsxs("div",{className:`${n.iconsContainer} d-flex justify-content-center align-items-center`,children:[t.jsx("div",{className:`${n.icon} ${l==="dark"?n.darkMode:n.lightMode} px-2 py-1`,onClick:me,children:z?t.jsx(be,{style:{fontSize:"1.1rem"}}):t.jsx(Se,{style:{fontSize:"1.1rem"}})}),z&&t.jsxs("div",{className:`${n.exportOptions} ${l==="dark"?n.darkMode:n.lightMode}`,ref:W,children:[_?t.jsxs("div",{className:n.exportOption,onClick:()=>{G(!_),k(!1)},children:[t.jsx(Ce,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),t.jsx("span",{children:a("View Graph")})]}):t.jsxs("div",{className:n.exportOption,onClick:()=>{G(!_),k(!1)},children:[t.jsx(ve,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),t.jsx("span",{children:a("View Table")})]}),t.jsxs("div",{className:n.exportOption,onClick:de,children:[t.jsx(Fe,{style:{fontSize:"1.1rem",color:"green"}}),t.jsx("span",{children:a("Export to Excel")})]}),t.jsxs("div",{className:n.exportOption,onClick:fe,children:[t.jsx(ke,{style:{fontSize:"1.1rem",color:"red"}}),t.jsx("span",{children:a("Export to PDF")})]})]})]})})]})}),A&&t.jsx("div",{className:n.NoDataOverlay,children:t.jsx("img",{src:Ne,alt:"Loading...",width:50,height:50})}),M.length==1&&!_&&!A?t.jsx("div",{className:`${n.NoDataOverlay} fs-5`,children:a("No Data Found")}):"",_?t.jsx("div",{className:"container-fluid mt-2",children:t.jsx(Te,{data:M,columns:ie,options:le})}):t.jsx(je,{option:ce,style:{height:"300px",width:"100%",maxWidth:"2300px"},onEvents:{click:pe},className:l==="dark"?n.darkMode:n.lightMode})]})};export{nt as default};
