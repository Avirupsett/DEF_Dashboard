import{_ as R}from"./index-dbef6bfd.js";import{r as d,u as K,l as X,j as e,g as Z,z as ee,A as te,K as oe,C as ae,E as ne,G as se}from"./vendor-5afa12e1.js";import{E as re,M as le,F as ie}from"./index-8b623e31.js";import{l as L}from"./logo-604665f9.js";const ce="_piechart_1ah4s_11",de="_chartContainer_1ah4s_23",he="_legendButtonContainer_1ah4s_49",fe="_legendButton_1ah4s_49",pe="_codeBlockIcon_1ah4s_133",ue="_lightMode_1ah4s_191",ge="_dateFilter_1ah4s_195",_e="_officefilter_1ah4s_351",me="_topContainer_1ah4s_443",xe="_darkMode_1ah4s_463",be="_iconsContainer_1ah4s_631",ye="_icon_1ah4s_631",Ce="_exportOptions_1ah4s_715",Se="_exportOption_1ah4s_715",we="_NoDataOverlay_1ah4s_861",ke="_tableContainer_1ah4s_993",ve="_table_1ah4s_993",Fe="_summaryHeader_1ah4s_1029",Ne="_periodHeader_1ah4s_1037",je="_closeButton_1ah4s_1069",$e="_tableWrapper_1ah4s_1099",De="_loadingOverlay_1ah4s_1107",Oe="_loadingSpinner_1ah4s_1133",Pe="_boldOption_1ah4s_1145",Ee="_optionGroup_1ah4s_1155",t={piechart:ce,chartContainer:de,"legend-text":"_legend-text_1ah4s_31",legendButtonContainer:he,legendButton:fe,codeBlockIcon:pe,lightMode:ue,"label-text":"_label-text_1ah4s_191",dateFilter:ge,officefilter:_e,topContainer:me,darkMode:xe,"theme-container":"_theme-container_1ah4s_473",iconsContainer:be,icon:ye,exportOptions:Ce,exportOption:Se,NoDataOverlay:we,tableContainer:ke,table:ve,summaryHeader:Fe,periodHeader:Ne,closeButton:je,tableWrapper:$e,loadingOverlay:De,loadingSpinner:Oe,boldOption:Pe,optionGroup:Ee},We=({themeMode:g,selectedRange:y,selectedOffice:F,isAdmin:T})=>{const[_,M]=d.useState([]),[N,S]=d.useState(!1),j=d.useRef(null),$=d.useRef(null),D=d.useRef(null),{t:n}=K(),[O,P]=d.useState(!1),[H,A]=d.useState([]),[w,E]=d.useState(!1),[W,I]=d.useState(!1),Q=[{name:"Product Name",label:n("Product")},{name:"Quantity",label:n("Quantity")},{name:"Sales",label:`${n("Sales")}(₹)`}],G={selectableRowsHeader:!1,filter:!1,download:!1,print:!1,viewColumns:!1,search:!1,responsive:"standard",selectableRows:"none",rowsPerPage:10,rowsPerPageOptions:[10,25,50],tableBodyHeight:"229px",elevation:0,fixedHeader:!1,textLabels:{pagination:{rowsPerPage:n("Rows")}}};d.useEffect(()=>{I(!0);const o=C(y[0]),r=C(y[1]);o&&r&&F&&X.get(`http://115.124.120.251:5064/api/v1/dashboard/sales_list/${o}/${r}/${F}/${T}`).then(h=>{const a=h.data.graph2;let l={},x={},u={},b={};if(a.forEach(f=>{const{lstproduct:p}=f;p.forEach(s=>{let{productName:c,totalSales:i,color:B,qty:k,unitShortName:z}=s;i!==0&&(l[c]?(l[c]+=i,u[c]+=k):(l[c]=i,x[c]=B,u[c]=k,b[c]=z))})}),l){let f=[],p=[];for(let s in l)f.push({productName:s,totalSale:l[s],color:x[s],totalQty:u[s],unit:b[s]}),p.push({"Product Name":s,Sales:l[s],Quantity:`${u[s]} ${b[s]}`});A(p),M(f)}}).catch(h=>{}).finally(()=>{I(!1)})},[y,F,T]);const V=()=>{_.length>0&&(P(!O),S(!1),E(!1))},Y={tooltip:{trigger:"item",formatter:`<b>{b}</b><br><b>${n("Total Sales")}:</b> ₹{c}`,textStyle:{fontSize:window.innerWidth<=768?10:14}},legend:{orient:"vertical",backgroundColor:g==="dark"?"#111111df":"rgb(249 249 249 / 97%)",left:"8px",top:"0",borderRadius:7,padding:10,show:O,shadowColor:"#ececec",borderColor:"rgba(57, 50, 50, 0.7)",borderWidth:1,itemGap:10,textStyle:{color:g==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?12:14,padding:4},type:"scroll",scroll:{show:!0,orient:"horizontal"}},graphic:{type:"text",left:"center",top:"2%",style:{fill:g==="dark"?"#ffffff":"#000000",fontSize:window.innerWidth<=1496?16:18,fontWeight:"bold"}},series:[{name:"Product Sales",type:"pie",radius:["40%","65%"],center:["50%","50%"],selectedMode:"single",avoidLabelOverlap:!0,label:{show:_.length<=5,color:g==="dark"?"#ffffff":"#111111"},emphasis:{label:{show:!0,fontSize:9,fontWeight:"bold"}},data:_.length>0?_.map((o,r)=>({value:o.totalSale,name:o.productName,itemStyle:{color:o.color}})):[],itemStyle:{borderWidth:2,borderColor:"#ffffff00",borderRadius:4}}]},U=async()=>{const o=C(y[0]),r=C(y[1]),h=await R(()=>import("./exceljs.min-d3a887be.js").then(l=>l.e),["assets/exceljs.min-d3a887be.js","assets/vendor-5afa12e1.js"]),m=new h.Workbook,a=m.addWorksheet("Data");fetch(L).then(l=>l.blob()).then(l=>{const x=new FileReader;x.onload=function(){const u=x.result,b=m.addImage({base64:u,extension:"png"});a.addImage(b,{tl:{col:0,row:0},ext:{width:100,height:70}});const f=a.getCell("A2");f.value=n("Product Wise Summary Data"),f.font={bold:!0,color:{argb:"000000"},size:14},f.alignment={vertical:"middle",horizontal:"center"},a.mergeCells("A2:C2");const p=a.getCell("A3");p.value=`${n("Period")}: ${o} ${n("to")} ${r}`,p.font={bold:!0,color:{argb:"000000"},size:12},p.alignment={horizontal:"center"},a.mergeCells("A3:C3"),a.getColumn(1).width=50,a.getColumn(2).width=15;const s=a.addRow([n("Product Name"),n("Quantity"),n("Total Sales")]);s.font={bold:!0,color:{argb:"000000"},size:12},s.eachCell(i=>{i.font={bold:!0,color:{argb:"000000"},size:12},i.border={bottom:{style:"thin",color:{argb:"000000"}}}}),_.forEach(i=>{a.addRow([i.productName,`${i.totalQty} ${i.unit}`,`₹${i.totalSale}`])});const c=`product_wise_summary_data_${Date.now()}.xlsx`;m.xlsx.writeBuffer().then(i=>{ie.saveAs(new Blob([i]),c)})},x.readAsDataURL(l)})},C=o=>{if(!o)return"";const r=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),m=String(o.getDate()).padStart(2,"0");return`${r}-${h}-${m}`},q=async()=>{const o=C(y[0]),r=C(y[1]);R(()=>import("./index-8b623e31.js").then(h=>h.j),["assets/index-8b623e31.js","assets/vendor-5afa12e1.js","assets/index-dbef6bfd.js","assets/index-4da97eed.css"]).then(h=>{let m=h.default;const a=new m,l=[["Product Name","Quantity","Total Sale"]],x={1:{halign:"right"},2:{halign:"right"}},u={fontSize:12,fontStyle:"bold",halign:"center"},b={summaryHeader:"#3CB043",secondHeader:"#75AAF0"},f=L,p=35,s=20;a.addImage(f,"PNG",15,12,p,s);const c=[["Product Wise Summary Data"]];a.autoTable({head:c,body:[],headStyles:{...u,fillColor:b.summaryHeader,textColor:"#FFFFFF"},margin:{top:30}});const i=[[`Period: ${o} to ${r}`]];a.autoTable({startY:39.5,head:i,body:[],headStyles:{fontSize:12,fontStyle:"bold",halign:"center",fillColor:"#3CB043",textColor:"#FFFFFF"},margin:{top:30}});const B=_.map(v=>[v.productName,`${v.totalQty} ${v.unit}`,v.totalSale.toFixed(2)]),k={startY:a.autoTable.previous.finalY+1,head:l,body:B,headStyles:{...u,fillColor:b.secondHeader,textColor:"#FFFFFF"},columnStyles:x};a.autoTable(k);const z=`product_wise_summary_data_${Date.now()}.pdf`;a.save(z)})};d.useEffect(()=>{const o=r=>{j.current&&!j.current.contains(r.target)&&$.current&&!$.current.contains(r.target)&&r.target.tagName!=="svg"&&r.target.tagName!=="path"&&S(!1),D.current&&!D.current.contains(r.target)&&P(!1)};return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[]);const J=()=>{P(!1),S(!N)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`${t.chartContainer} ${g==="dark"?t.darkMode:t.lightMode}`,children:[e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"d-flex w-100 g-0 align-items-center justify-content-between",children:[e.jsxs("button",{className:t.legendButton,onClick:V,ref:D,children:[e.jsx("img",{src:"http://115.124.120.251:5007/images/code-block.png",alt:"Code Block Icon",className:t.codeBlockIcon,title:"Legends",style:{filter:O||_.length===0?"opacity(0.4)":"opacity(1)",transition:"all .25s ease-in-out"}})," "]}),e.jsx("div",{className:`fw-bold fs-5 ${g==="dark"?t.darkMode:t.lightMode}`,children:n("Product Volume")}),e.jsx("div",{className:"d-flex g-0",ref:j,children:e.jsxs("div",{className:`${t.iconsContainer} d-flex justify-content-center align-items-center`,children:[e.jsx("div",{className:`${t.icon} ${g==="dark"?t.darkMode:t.lightMode} px-2 py-1`,onClick:J,children:N?e.jsx(Z,{style:{fontSize:"1.1rem"}}):e.jsx(ee,{style:{fontSize:"1.1rem"}})}),N&&e.jsxs("div",{className:`${t.exportOptions} ${g==="dark"?t.darkMode:t.lightMode}`,ref:$,children:[w?e.jsxs("div",{className:t.exportOption,onClick:()=>{E(!w),S(!1)},children:[e.jsx(oe,{style:{fontSize:"1.1rem",color:"#6c3fb5"}}),e.jsx("span",{children:n("View Graph")})]}):e.jsxs("div",{className:t.exportOption,onClick:()=>{E(!w),S(!1)},children:[e.jsx(te,{style:{fontSize:"1.1rem",color:"#0d6efd"}}),e.jsx("span",{children:n("View Table")})]}),e.jsxs("div",{className:t.exportOption,onClick:U,children:[e.jsx(ae,{style:{fontSize:"1.1rem",color:"green"}}),e.jsx("span",{children:n("Export to Excel")})]}),e.jsxs("div",{className:t.exportOption,onClick:q,children:[e.jsx(ne,{style:{fontSize:"1.1rem",color:"red"}}),e.jsx("span",{children:n("Export to PDF")})]})]})]})})]})}),W&&e.jsx("div",{className:t.loadingOverlay,children:e.jsx(se,{disableShrink:!0})}),H.length==0&&!w&&!W?e.jsx("div",{className:`${t.NoDataOverlay} fs-5`,children:n("No Data Found")}):"",w?e.jsx("div",{className:"container-fluid pt-2",children:e.jsx(le,{data:H,columns:Q,options:G})}):e.jsx(re,{option:Y,style:{height:"300px",width:"100%",maxWidth:"2300px"},className:t.piechart},_.length)]})})};export{We as default};
